!function(){"use strict";angular.module("afrmApp",["ngMaterial","ngAnimate","ngRoute","angular.filter","md.data.table"]).config(["$mdThemingProvider","$mdDateLocaleProvider",function(e,n){n.formatDate=function(e){return moment(e).format("YYYY-MM-DD")},e.theme("forest").primaryPalette("blue").accentPalette("teal").warnPalette("red").backgroundPalette("grey")}])}(),function(){"use strict";function e(e,n,t){n.serverUrl="https://dev-sistemas-server.herokuapp.com/",e.menu=function(e){t.path(e)},e.logout=function(){window.localStorage.removeItem("CREDENTIAL"),t.path("/login")},n.$on("$routeChangeSuccess",function(){e.credential=JSON.parse(window.localStorage.getItem("CREDENTIAL")),"/empresas"===t.path()?e.currentMenuIndex=0:"/solicitacoes"===t.path()?e.currentMenuIndex=1:e.currentMenuIndex=-1,n.isLogin="/login"===t.path()})}e.$inject=["$scope","$rootScope","$location"],angular.module("afrmApp").controller("MainController",e)}(),function(){"use strict";function e(e,n){e.when("/login",{templateUrl:"app/components/login/login.html",controller:"LoginController"}).when("/empresas",{templateUrl:"app/components/companies/companies.html",controller:"CompaniesController"}).when("/solicitacoes",{templateUrl:"app/components/internships/internships.html",controller:"InternshipsController"}).when("/registro",{templateUrl:"app/components/login/register.html",controller:"RegisterController"}).otherwise({redirectTo:"/login"}),n.html5Mode(!0)}angular.module("afrmApp").config(["$routeProvider","$locationProvider",e])}(),function(){"use strict";function e(e,n,t){function o(n){t.get(n).success(function(n){e.companies=n}).error(function(e){console.log(e)})}e.showDialog=function(e){"Aguardando aprovação"===e.status&&n.show({controller:"ManageCompanyController",templateUrl:"app/shared/templates/modals/company-dialog.html",parent:angular.element(document.body),locals:{company:e},clickOutsideToClose:!0})},e.search=function(e){o(e)},function(){e.companySelected=[],o()}()}angular.module("afrmApp").controller("CompaniesController",e),e.$inject=["$scope","$mdDialog","companiesService"]}(),function(){"use strict";function e(e){e.approveSolicitation=function(){},e.insertSolicitation=function(){}}angular.module("afrmApp").controller("HomeController",e),e.$inject=["$scope"]}(),function(){"use strict";function e(e,n,t){e.approveInternshipDialog=function(t,o,r){"Aguardando aprovação"!==t.status||"coordinator"!==e.credential.role&&"student"!==e.credential.role||n.show({controller:"ApproveInternshipDialogController",templateUrl:"app/shared/templates/modals/approve-internship-dialog.html",locals:{internship:t||{},credential:o},parent:angular.element(document.body),targetEvent:r,clickOutsideToClose:!0})},e.internshipDialog=function(e,t){n.show({controller:"InternshipDialogController",templateUrl:"app/shared/templates/modals/internship-dialog.html",locals:{internship:e||{}},parent:angular.element(document.body),targetEvent:t,clickOutsideToClose:!0})},e.search=function(n){var o={credentialId:e.credential._id};n.name&&(o.name=n.name.trim()),n.status&&"Todos"!==n.status.trim()&&(o.status=n.status.trim()),t.get(o).success(function(n){e.internships=n}).error(function(e){console.log(e)})},function(){var n={};e.query={},e.status=["Todos","Em andamento","Reprovado","Cancelado","Aguardando aprovação","Finalizado"],e.credential=JSON.parse(window.localStorage.getItem("CREDENTIAL"))||{},e.isStudent="student"===e.credential.role,n={credentialId:e.credential._id},t.get(n).success(function(n){e.internships=n}).error(function(e){console.log(e)})}()}angular.module("afrmApp").controller("InternshipsController",e),e.$inject=["$scope","$mdDialog","internshipsService"]}(),function(){"use strict";function e(e,n,t,o){e.login=function(r,i){var a={email:r,password:i};e.isLoading=!0,n.login(a).success(function(n){e.isLoading=!1,n?(window.localStorage.setItem("CREDENTIAL",JSON.stringify(n)),o.credential=n,t.path("/solicitacoes")):e.isWrongLogin=!0}).error(function(n){e.isLoading=!1,console.log(n)})}}angular.module("afrmApp").controller("LoginController",e),e.$inject=["$scope","credentialsService","$location","$rootScope"]}(),function(){"use strict";function e(e,n,t,o,r){e.createAccount=function(e){n.create(e).success(function(e){e&&(o.show(o.simple().textContent("Usuário criado com sucesso").position("bottom").hideDelay(3e3)),r(function(){t("/login")},3e3))}).error(function(e){console.log(e)})}}angular.module("afrmApp").controller("RegisterController",e),e.$inject=["$scope","credentialsService","$location","$mdToast","$timeout"]}(),function(){"use strict";function e(e){e.approveSolicitation=function(){},e.insertSolicitation=function(){}}angular.module("afrmApp").controller("SolicitationController",e),e.$inject=["$scope"]}(),function(){"use strict";function e(e,n){var t="companies";this.create=function(o){return e.post(n.serverUrl+t,o)},this.update=function(o){return e.put(n.serverUrl+t,o)},this.get=function(o){var r=n.serverUrl+t;return o&&(r=r+"/"+o),e.get(r)}}e.$inject=["$http","$rootScope"],angular.module("afrmApp").service("companiesService",e)}(),function(){"use strict";function e(e,n){var t="credentials";this.login=function(o){var r="?email="+o.email+"&password="+o.password;return e.get(n.serverUrl+t+"/"+r)},this.create=function(o){return e.post(n.serverUrl+t,o)},this.logout=function(o){return e.get(n.serverUrl+t+"/"+o)}}e.$inject=["$http","$rootScope"],angular.module("afrmApp").service("credentialsService",e)}(),function(){"use strict";function e(e,n){var t="internships";this.get=function(o){var r=n.serverUrl+t+"/?";return o.credentialId&&(r+="credentialId="+o.credentialId),o.status&&(r+="&status="+o.status),o.name&&(r+="&name="+o.name),e.get(r)},this.update=function(o){return e.put(n.serverUrl+t,o)}}e.$inject=["$http","$rootScope"],angular.module("afrmApp").service("internshipsService",e)}(),function(){"use strict";function e(e,n,t,o){function r(){e.isSaving=!0,t.update(e.internship).success(function(){e.isSaving=!1,n.hide(e.internship)}).error(function(t){console.log(t),e.isSaving=!1,n.hide()})}e.save=function(n){n&&"coordinator"===e.credential.role?(e.internship.status="Em andamento",e.internship.begin=moment().format("DD/MM/YYYY"),e.internship.end=moment(moment()).add(6,"months").format("DD/MM/YYYY")):n||"coordinator"!==e.credential.role?n||"student"!==e.credential.role||(e.internship.status="Cancelado"):e.internship.status="Reprovado",r()},e.closeDialog=function(){n.cancel()},function(){e.internship=o.internship||{},e.credential=o.credential||{}}()}e.$inject=["$scope","$mdDialog","internshipsService","locals"],angular.module("afrmApp").controller("ApproveInternshipDialogController",e)}(),function(){"use strict";function e(e,n,t,o){e.save=function(o,r){e.isLoadingCompany=!0,r===!0?o.status="Aprovado":o.status="Reprovado",t.update(o).success(function(){e.isLoadingCompany=!1,n.hide(o)}).error(function(n){e.isLoadingCompany=!1,console.log(n)})},e.closeDialog=function(){n.cancel()},function(){e.company=o.company||{}}()}e.$inject=["$scope","$mdDialog","companiesService","locals"],angular.module("afrmApp").controller("ManageCompanyController",e)}(),function(){"use strict";function e(e,n,t,o){e.closeDialog=function(){n.cancel()},function(){e.internship=o.internship||{}}()}e.$inject=["$scope","$mdDialog","internshipsService","locals"],angular.module("afrmApp").controller("InternshipDialogController",e)}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC1tb2R1bGUuanMiLCJhcHAtY29udHJvbGxlci5qcyIsImFwcC1yb3V0ZXMuanMiLCJjb21wb25lbnRzL2NvbXBhbmllcy9jb21wYW5pZXMuY29udHJvbGxlci5qcyIsImNvbXBvbmVudHMvaG9tZS9ob21lLmNvbnRyb2xsZXIuanMiLCJjb21wb25lbnRzL2ludGVybnNoaXBzL2ludGVybnNoaXBzLmNvbnRyb2xsZXIuanMiLCJjb21wb25lbnRzL2xvZ2luL2xvZ2luLmNvbnRyb2xsZXIuanMiLCJjb21wb25lbnRzL2xvZ2luL3JlZ2lzdGVyLmNvbnRyb2xsZXIuanMiLCJjb21wb25lbnRzL3NvbGljaXRhdGlvbi9zb2xpY2l0YXRpb24uY29udHJvbGxlci5qcyIsInNoYXJlZC9zZXJ2aWNlcy9jb21wYW5pZXMuc2VydmljZS5qcyIsInNoYXJlZC9zZXJ2aWNlcy9jcmVkZW50aWFscy5zZXJ2aWNlLmpzIiwic2hhcmVkL3NlcnZpY2VzL2ludGVybnNoaXBzLnNlcnZpY2UuanMiLCJzaGFyZWQvdGVtcGxhdGVzL21vZGFscy9hcHByb3ZlLmludGVybnNoaXAuZGlhbG9nLmNvbnRyb2xsZXIuanMiLCJzaGFyZWQvdGVtcGxhdGVzL21vZGFscy9jb21wYW55LmRpYWxvZy5jb250cm9sbGVyLmpzIiwic2hhcmVkL3RlbXBsYXRlcy9tb2RhbHMvaW50ZXJuc2hpcC5kaWFsb2cuY29udHJvbGxlci5qcyJdLCJuYW1lcyI6WyJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlnIiwiJG1kVGhlbWluZ1Byb3ZpZGVyIiwiJG1kRGF0ZUxvY2FsZVByb3ZpZGVyIiwiZm9ybWF0RGF0ZSIsImRhdGUiLCJtb21lbnQiLCJmb3JtYXQiLCJ0aGVtZSIsInByaW1hcnlQYWxldHRlIiwiYWNjZW50UGFsZXR0ZSIsIndhcm5QYWxldHRlIiwiYmFja2dyb3VuZFBhbGV0dGUiLCJNYWluQ29udHJvbGxlciIsIiRzY29wZSIsIiRyb290U2NvcGUiLCIkbG9jYXRpb24iLCJzZXJ2ZXJVcmwiLCJtZW51IiwicGF0aCIsImxvZ291dCIsIndpbmRvdyIsImxvY2FsU3RvcmFnZSIsInJlbW92ZUl0ZW0iLCIkb24iLCJjcmVkZW50aWFsIiwiSlNPTiIsInBhcnNlIiwiZ2V0SXRlbSIsImN1cnJlbnRNZW51SW5kZXgiLCJpc0xvZ2luIiwiJGluamVjdCIsImNvbnRyb2xsZXIiLCJBcHBsaWNhdGlvbkNvbmZpZyIsIiRyb3V0ZVByb3ZpZGVyIiwiJGxvY2F0aW9uUHJvdmlkZXIiLCJ3aGVuIiwidGVtcGxhdGVVcmwiLCJvdGhlcndpc2UiLCJyZWRpcmVjdFRvIiwiaHRtbDVNb2RlIiwiQ29tcGFuaWVzQ29udHJvbGxlciIsIiRtZERpYWxvZyIsImNvbXBhbmllc1NlcnZpY2UiLCJnZXRDb21wYW5pZXMiLCJuYW1lIiwiZ2V0Iiwic3VjY2VzcyIsImNvbXBhbmllcyIsImVycm9yIiwicmVhc29uIiwiY29uc29sZSIsImxvZyIsInNob3dEaWFsb2ciLCJjb21wYW55Iiwic3RhdHVzIiwic2hvdyIsInBhcmVudCIsImVsZW1lbnQiLCJkb2N1bWVudCIsImJvZHkiLCJsb2NhbHMiLCJjbGlja091dHNpZGVUb0Nsb3NlIiwic2VhcmNoIiwiY29tcGFueVNlbGVjdGVkIiwiSG9tZUNvbnRyb2xsZXIiLCJhcHByb3ZlU29saWNpdGF0aW9uIiwiaW5zZXJ0U29saWNpdGF0aW9uIiwiSW50ZXJuc2hpcHNDb250cm9sbGVyIiwiaW50ZXJuc2hpcHNTZXJ2aWNlIiwiYXBwcm92ZUludGVybnNoaXBEaWFsb2ciLCJpbnRlcm5zaGlwIiwiZXYiLCJyb2xlIiwidGFyZ2V0RXZlbnQiLCJpbnRlcm5zaGlwRGlhbG9nIiwicXVlcnkiLCJxIiwiY3JlZGVudGlhbElkIiwiX2lkIiwidHJpbSIsImludGVybnNoaXBzIiwiaXNTdHVkZW50IiwiTG9naW5Db250cm9sbGVyIiwiY3JlZGVudGlhbHNTZXJ2aWNlIiwibG9naW4iLCJlbWFpbCIsInBhc3MiLCJwYXNzd29yZCIsImlzTG9hZGluZyIsInNldEl0ZW0iLCJzdHJpbmdpZnkiLCJpc1dyb25nTG9naW4iLCJSZWdpc3RlckNvbnRyb2xsZXIiLCIkbWRUb2FzdCIsIiR0aW1lb3V0IiwiY3JlYXRlQWNjb3VudCIsInVzciIsImNyZWF0ZSIsInJlc3VsdCIsInNpbXBsZSIsInRleHRDb250ZW50IiwicG9zaXRpb24iLCJoaWRlRGVsYXkiLCJTb2xpY2l0YXRpb25Db250cm9sbGVyIiwiQ29tcGFuaWVzU2VydmljZSIsIiRodHRwIiwidGhpcyIsInBvc3QiLCJ1cGRhdGUiLCJwdXQiLCJ1cmwiLCJzZXJ2aWNlIiwiQ3JlZGVudGlhbHNTZXJ2aWNlIiwicXVlcnlzdHJpbmciLCJ0b2tlbiIsIkludGVybnNoaXBzU2VydmljZSIsIkFwcHJvdmVJbnRlcm5zaGlwRGlhbG9nQ29udHJvbGxlciIsInVwZGF0ZUludGVybnNoaXAiLCJpc1NhdmluZyIsImhpZGUiLCJzYXZlIiwiaXNBcHByb3ZlIiwiYmVnaW4iLCJlbmQiLCJhZGQiLCJjbG9zZURpYWxvZyIsImNhbmNlbCIsIk1hbmFnZUNvbXBhbnlDb250cm9sbGVyIiwiaXNMb2FkaW5nQ29tcGFueSIsIkludGVybnNoaXBEaWFsb2dDb250cm9sbGVyIl0sIm1hcHBpbmdzIjoiQ0FBQSxXQUNBLFlBR0FBLFNBQUFDLE9BQUEsV0FDQSxhQUNBLFlBQ0EsVUFDQSxpQkFDQSxrQkFHQUMsUUFBQSxxQkFBQSx3QkFBQSxTQUFBQyxFQUFBQyxHQUdBQSxFQUFBQyxXQUFBLFNBQUFDLEdBQ0EsTUFBQUMsUUFBQUQsR0FBQUUsT0FBQSxlQUlBTCxFQUNBTSxNQUFBLFVBQ0FDLGVBQUEsUUFDQUMsY0FBQSxRQUNBQyxZQUFBLE9BQ0FDLGtCQUFBLGNDekJBLFdBQ0EsWUFXQSxTQUFBQyxHQUFBQyxFQUFBQyxFQUFBQyxHQUdBRCxFQUFBRSxVQUFBLDZDQUVBSCxFQUFBSSxLQUFBLFNBQUFDLEdBQ0FILEVBQUFHLEtBQUFBLElBR0FMLEVBQUFNLE9BQUEsV0FDQUMsT0FBQUMsYUFBQUMsV0FBQSxjQUNBUCxFQUFBRyxLQUFBLFdBR0FKLEVBQUFTLElBQUEsc0JBQUEsV0FFQVYsRUFBQVcsV0FBQUMsS0FBQUMsTUFBQU4sT0FBQUMsYUFBQU0sUUFBQSxlQUVBLGNBQUFaLEVBQUFHLE9BQ0FMLEVBQUFlLGlCQUFBLEVBRUEsa0JBQUFiLEVBQUFHLE9BQ0FMLEVBQUFlLGlCQUFBLEVBR0FmLEVBQUFlLG9CQUVBZCxFQUFBZSxRQUFBLFdBQUFkLEVBQUFHLFNBbkNBTixFQUFBa0IsU0FDQSxTQUFBLGFBQUEsYUFJQWhDLFFBQUFDLE9BQUEsV0FBQWdDLFdBQUEsaUJBQUFuQixNQ1RBLFdBQ0EsWUFJQSxTQUFBb0IsR0FBQUMsRUFBQUMsR0FDQUQsRUFFQUUsS0FBQSxVQUNBQyxZQUFBLGtDQUNBTCxXQUFBLG9CQUdBSSxLQUFBLGFBQ0FDLFlBQUEsMENBQ0FMLFdBQUEsd0JBR0FJLEtBQUEsaUJBQ0FDLFlBQUEsOENBQ0FMLFdBQUEsMEJBR0FJLEtBQUEsYUFDQUMsWUFBQSxxQ0FDQUwsV0FBQSx1QkFHQU0sV0FDQUMsV0FBQSxXQUdBSixFQUFBSyxXQUFBLEdBN0JBekMsUUFBQUMsT0FBQSxXQUFBQyxRQUFBLGlCQUFBLG9CQUFBZ0MsT0NIQSxXQUVBLFlBTUEsU0FBQVEsR0FBQTNCLEVBQUE0QixFQUFBQyxHQUVBLFFBQUFDLEdBQUFDLEdBRUFGLEVBQUFHLElBQUFELEdBQ0FFLFFBQUEsU0FBQUMsR0FDQWxDLEVBQUFrQyxVQUFBQSxJQUVBQyxNQUFBLFNBQUFDLEdBQ0FDLFFBQUFDLElBQUFGLEtBSUFwQyxFQUFBdUMsV0FBQSxTQUFBQyxHQUVBLHlCQUFBQSxFQUFBQyxRQUNBYixFQUFBYyxNQUNBeEIsV0FBQSwwQkFDQUssWUFBQSxrREFDQW9CLE9BQUExRCxRQUFBMkQsUUFBQUMsU0FBQUMsTUFDQUMsUUFBQVAsUUFBQUEsR0FDQVEscUJBQUEsS0FJQWhELEVBQUFpRCxPQUFBLFNBQUFsQixHQUNBRCxFQUFBQyxJQUdBLFdBRUEvQixFQUFBa0QsbUJBQ0FwQixPQXBDQTdDLFFBQUFDLE9BQUEsV0FBQWdDLFdBQUEsc0JBQUFTLEdBRUFBLEVBQUFWLFNBQUEsU0FBQSxZQUFBLHVCQ05BLFdBRUEsWUFNQSxTQUFBa0MsR0FBQW5ELEdBRUFBLEVBQUFvRCxvQkFBQSxhQUlBcEQsRUFBQXFELG1CQUFBLGFBVkFwRSxRQUFBQyxPQUFBLFdBQUFnQyxXQUFBLGlCQUFBaUMsR0FFQUEsRUFBQWxDLFNBQUEsYUNOQSxXQUVBLFlBTUEsU0FBQXFDLEdBQUF0RCxFQUFBNEIsRUFBQTJCLEdBRUF2RCxFQUFBd0Qsd0JBQUEsU0FBQUMsRUFBQTlDLEVBQUErQyxHQUNBLHlCQUFBRCxFQUFBaEIsUUFBQSxnQkFBQXpDLEVBQUFXLFdBQUFnRCxNQUFBLFlBQUEzRCxFQUFBVyxXQUFBZ0QsTUFDQS9CLEVBQUFjLE1BQ0F4QixXQUFBLG9DQUNBSyxZQUFBLDZEQUNBd0IsUUFBQVUsV0FBQUEsTUFBQTlDLFdBQUFBLEdBQ0FnQyxPQUFBMUQsUUFBQTJELFFBQUFDLFNBQUFDLE1BQ0FjLFlBQUFGLEVBQ0FWLHFCQUFBLEtBSUFoRCxFQUFBNkQsaUJBQUEsU0FBQUosRUFBQUMsR0FDQTlCLEVBQUFjLE1BQ0F4QixXQUFBLDZCQUNBSyxZQUFBLHFEQUNBd0IsUUFBQVUsV0FBQUEsT0FDQWQsT0FBQTFELFFBQUEyRCxRQUFBQyxTQUFBQyxNQUNBYyxZQUFBRixFQUNBVixxQkFBQSxLQUlBaEQsRUFBQWlELE9BQUEsU0FBQWEsR0FDQSxHQUFBQyxJQUFBQyxhQUFBaEUsRUFBQVcsV0FBQXNELElBRUFILEdBQUEvQixPQUNBZ0MsRUFBQWhDLEtBQUErQixFQUFBL0IsS0FBQW1DLFFBRUFKLEVBQUFyQixRQUFBLFVBQUFxQixFQUFBckIsT0FBQXlCLFNBQ0FILEVBQUF0QixPQUFBcUIsRUFBQXJCLE9BQUF5QixRQUVBWCxFQUFBdkIsSUFBQStCLEdBQ0E5QixRQUFBLFNBQUFrQyxHQUNBbkUsRUFBQW1FLFlBQUFBLElBRUFoQyxNQUFBLFNBQUFDLEdBQ0FDLFFBQUFDLElBQUFGLE1BSUEsV0FDQSxHQUFBMEIsS0FFQTlELEdBQUE4RCxTQUVBOUQsRUFBQXlDLFFBQUEsUUFBQSxlQUFBLFlBQUEsWUFBQSx1QkFBQSxjQUVBekMsRUFBQVcsV0FBQUMsS0FBQUMsTUFBQU4sT0FBQUMsYUFBQU0sUUFBQSxtQkFFQWQsRUFBQW9FLFVBQUEsWUFBQXBFLEVBQUFXLFdBQUFnRCxLQUVBRyxHQUFBRSxhQUFBaEUsRUFBQVcsV0FBQXNELEtBRUFWLEVBQUF2QixJQUFBOEIsR0FDQTdCLFFBQUEsU0FBQWtDLEdBQ0FuRSxFQUFBbUUsWUFBQUEsSUFFQWhDLE1BQUEsU0FBQUMsR0FDQUMsUUFBQUMsSUFBQUYsUUFqRUFuRCxRQUFBQyxPQUFBLFdBQUFnQyxXQUFBLHdCQUFBb0MsR0FFQUEsRUFBQXJDLFNBQUEsU0FBQSxZQUFBLHlCQ05BLFdBRUEsWUFNQSxTQUFBb0QsR0FBQXJFLEVBQUFzRSxFQUFBcEUsRUFBQUQsR0FFQUQsRUFBQXVFLE1BQUEsU0FBQUMsRUFBQUMsR0FDQSxHQUFBOUQsSUFDQTZELE1BQUFBLEVBQ0FFLFNBQUFELEVBR0F6RSxHQUFBMkUsV0FBQSxFQUVBTCxFQUFBQyxNQUFBNUQsR0FDQXNCLFFBQUEsU0FBQXRCLEdBRUFYLEVBQUEyRSxXQUFBLEVBRUFoRSxHQUNBSixPQUFBQyxhQUFBb0UsUUFBQSxhQUFBaEUsS0FBQWlFLFVBQUFsRSxJQUNBVixFQUFBVSxXQUFBQSxFQUNBVCxFQUFBRyxLQUFBLGtCQUdBTCxFQUFBOEUsY0FBQSxJQUVBM0MsTUFBQSxTQUFBQyxHQUNBcEMsRUFBQTJFLFdBQUEsRUFDQXRDLFFBQUFDLElBQUFGLE1BN0JBbkQsUUFBQUMsT0FBQSxXQUFBZ0MsV0FBQSxrQkFBQW1ELEdBRUFBLEVBQUFwRCxTQUFBLFNBQUEscUJBQUEsWUFBQSxpQkNOQSxXQUVBLFlBTUEsU0FBQThELEdBQUEvRSxFQUFBc0UsRUFBQXBFLEVBQUE4RSxFQUFBQyxHQUVBakYsRUFBQWtGLGNBQUEsU0FBQUMsR0FDQWIsRUFBQWMsT0FBQUQsR0FDQWxELFFBQUEsU0FBQW9ELEdBQ0FBLElBQ0FMLEVBQUF0QyxLQUNBc0MsRUFBQU0sU0FDQUMsWUFBQSw4QkFDQUMsU0FBQSxVQUNBQyxVQUFBLE1BRUFSLEVBQUEsV0FDQS9FLEVBQUEsV0FDQSxRQUlBaUMsTUFBQSxTQUFBQyxHQUNBQyxRQUFBQyxJQUFBRixNQXZCQW5ELFFBQUFDLE9BQUEsV0FBQWdDLFdBQUEscUJBQUE2RCxHQUVBQSxFQUFBOUQsU0FBQSxTQUFBLHFCQUFBLFlBQUEsV0FBQSxlQ05BLFdBRUEsWUFNQSxTQUFBeUUsR0FBQTFGLEdBRUFBLEVBQUFvRCxvQkFBQSxhQUlBcEQsRUFBQXFELG1CQUFBLGFBVkFwRSxRQUFBQyxPQUFBLFdBQUFnQyxXQUFBLHlCQUFBd0UsR0FFQUEsRUFBQXpFLFNBQUEsYUNOQSxXQUVBLFlBRUEsU0FBQTBFLEdBQUFDLEVBQUEzRixHQUVBLEdBQUFmLEdBQUEsV0FFQTJHLE1BQUFULE9BQUEsU0FBQTVDLEdBQ0EsTUFBQW9ELEdBQUFFLEtBQUE3RixFQUFBRSxVQUFBakIsRUFBQXNELElBR0FxRCxLQUFBRSxPQUFBLFNBQUF2RCxHQUNBLE1BQUFvRCxHQUFBSSxJQUFBL0YsRUFBQUUsVUFBQWpCLEVBQUFzRCxJQUdBcUQsS0FBQTdELElBQUEsU0FBQUQsR0FDQSxHQUFBa0UsR0FBQWhHLEVBQUFFLFVBQUFqQixDQUtBLE9BSEE2QyxLQUNBa0UsRUFBQUEsRUFBQSxJQUFBbEUsR0FFQTZELEVBQUE1RCxJQUFBaUUsSUFJQU4sRUFBQTFFLFNBQUEsUUFBQSxjQUVBaEMsUUFBQUMsT0FBQSxXQUFBZ0gsUUFBQSxtQkFBQVAsTUM1QkEsV0FFQSxZQUVBLFNBQUFRLEdBQUFQLEVBQUEzRixHQUVBLEdBQUFmLEdBQUEsYUFFQTJHLE1BQUF0QixNQUFBLFNBQUE1RCxHQUNBLEdBQUF5RixHQUFBLFVBQUF6RixFQUFBNkQsTUFBQSxhQUFBN0QsRUFBQStELFFBRUEsT0FBQWtCLEdBQUE1RCxJQUFBL0IsRUFBQUUsVUFBQWpCLEVBQUEsSUFBQWtILElBR0FQLEtBQUFULE9BQUEsU0FBQUQsR0FDQSxNQUFBUyxHQUFBRSxLQUFBN0YsRUFBQUUsVUFBQWpCLEVBQUFpRyxJQUdBVSxLQUFBdkYsT0FBQSxTQUFBK0YsR0FDQSxNQUFBVCxHQUFBNUQsSUFBQS9CLEVBQUFFLFVBQUFqQixFQUFBLElBQUFtSCxJQUlBRixFQUFBbEYsU0FBQSxRQUFBLGNBRUFoQyxRQUFBQyxPQUFBLFdBQUFnSCxRQUFBLHFCQUFBQyxNQ3pCQSxXQUVBLFlBRUEsU0FBQUcsR0FBQVYsRUFBQTNGLEdBRUEsR0FBQWYsR0FBQSxhQUVBMkcsTUFBQTdELElBQUEsU0FBQThCLEdBQ0EsR0FBQW1DLEdBQUFoRyxFQUFBRSxVQUFBakIsRUFBQSxJQVdBLE9BVEE0RSxHQUFBRSxlQUNBaUMsR0FBQSxnQkFBQW5DLEVBQUFFLGNBRUFGLEVBQUFyQixTQUNBd0QsR0FBQSxXQUFBbkMsRUFBQXJCLFFBRUFxQixFQUFBL0IsT0FDQWtFLEdBQUEsU0FBQW5DLEVBQUEvQixNQUVBNkQsRUFBQTVELElBQUFpRSxJQUdBSixLQUFBRSxPQUFBLFNBQUF0QyxHQUNBLE1BQUFtQyxHQUFBSSxJQUFBL0YsRUFBQUUsVUFBQWpCLEVBQUF1RSxJQUtBNkMsRUFBQXJGLFNBQUEsUUFBQSxjQUVBaEMsUUFBQUMsT0FBQSxXQUFBZ0gsUUFBQSxxQkFBQUksTUMvQkEsV0FFQSxZQUVBLFNBQUFDLEdBQUF2RyxFQUFBNEIsRUFBQTJCLEVBQUFSLEdBRUEsUUFBQXlELEtBQ0F4RyxFQUFBeUcsVUFBQSxFQUVBbEQsRUFBQXdDLE9BQUEvRixFQUFBeUQsWUFDQXhCLFFBQUEsV0FDQWpDLEVBQUF5RyxVQUFBLEVBQ0E3RSxFQUFBOEUsS0FBQTFHLEVBQUF5RCxjQUVBdEIsTUFBQSxTQUFBQyxHQUNBQyxRQUFBQyxJQUFBRixHQUNBcEMsRUFBQXlHLFVBQUEsRUFDQTdFLEVBQUE4RSxTQUlBMUcsRUFBQTJHLEtBQUEsU0FBQUMsR0FFQUEsR0FBQSxnQkFBQTVHLEVBQUFXLFdBQUFnRCxNQUNBM0QsRUFBQXlELFdBQUFoQixPQUFBLGVBQ0F6QyxFQUFBeUQsV0FBQW9ELE1BQUFySCxTQUFBQyxPQUFBLGNBQ0FPLEVBQUF5RCxXQUFBcUQsSUFBQXRILE9BQUFBLFVBQUF1SCxJQUFBLEVBQUEsVUFBQXRILE9BQUEsZUFFQW1ILEdBQUEsZ0JBQUE1RyxFQUFBVyxXQUFBZ0QsS0FHQWlELEdBQUEsWUFBQTVHLEVBQUFXLFdBQUFnRCxPQUNBM0QsRUFBQXlELFdBQUFoQixPQUFBLGFBSEF6QyxFQUFBeUQsV0FBQWhCLE9BQUEsWUFLQStELEtBR0F4RyxFQUFBZ0gsWUFBQSxXQUNBcEYsRUFBQXFGLFVBR0EsV0FDQWpILEVBQUF5RCxXQUFBVixFQUFBVSxlQUNBekQsRUFBQVcsV0FBQW9DLEVBQUFwQyxrQkFJQTRGLEVBQUF0RixTQUFBLFNBQUEsWUFBQSxxQkFBQSxVQUVBaEMsUUFBQUMsT0FBQSxXQUFBZ0MsV0FBQSxvQ0FBQXFGLE1DakRBLFdBRUEsWUFFQSxTQUFBVyxHQUFBbEgsRUFBQTRCLEVBQUFDLEVBQUFrQixHQUVBL0MsRUFBQTJHLEtBQUEsU0FBQW5FLEVBQUFDLEdBRUF6QyxFQUFBbUgsa0JBQUEsRUFFQTFFLEtBQUEsRUFDQUQsRUFBQUMsT0FBQSxXQUVBRCxFQUFBQyxPQUFBLFlBR0FaLEVBQUFrRSxPQUFBdkQsR0FDQVAsUUFBQSxXQUNBakMsRUFBQW1ILGtCQUFBLEVBQ0F2RixFQUFBOEUsS0FBQWxFLEtBRUFMLE1BQUEsU0FBQUMsR0FDQXBDLEVBQUFtSCxrQkFBQSxFQUNBOUUsUUFBQUMsSUFBQUYsTUFLQXBDLEVBQUFnSCxZQUFBLFdBQ0FwRixFQUFBcUYsVUFHQSxXQUNBakgsRUFBQXdDLFFBQUFPLEVBQUFQLGVBSUEwRSxFQUFBakcsU0FBQSxTQUFBLFlBQUEsbUJBQUEsVUFFQWhDLFFBQUFDLE9BQUEsV0FBQWdDLFdBQUEsMEJBQUFnRyxNQ3ZDQSxXQUVBLFlBRUEsU0FBQUUsR0FBQXBILEVBQUE0QixFQUFBMkIsRUFBQVIsR0FFQS9DLEVBQUFnSCxZQUFBLFdBQ0FwRixFQUFBcUYsVUFHQSxXQUNBakgsRUFBQXlELFdBQUFWLEVBQUFVLGtCQUlBMkQsRUFBQW5HLFNBQUEsU0FBQSxZQUFBLHFCQUFBLFVBRUFoQyxRQUFBQyxPQUFBLFdBQUFnQyxXQUFBLDZCQUFBa0ciLCJmaWxlIjoiYWZybS5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIC8vIE1vZHVsZSBkZXBlbmRlbmNpZXMgaW5qZWN0aW9uXG4gICAgYW5ndWxhci5tb2R1bGUoJ2Fmcm1BcHAnLCBbXG4gICAgICAgICduZ01hdGVyaWFsJyxcbiAgICAgICAgJ25nQW5pbWF0ZScsXG4gICAgICAgICduZ1JvdXRlJyxcbiAgICAgICAgJ2FuZ3VsYXIuZmlsdGVyJyxcbiAgICAgICAgJ21kLmRhdGEudGFibGUnXG4gICAgXSlcblxuICAgICAgICAuY29uZmlnKGZ1bmN0aW9uICgkbWRUaGVtaW5nUHJvdmlkZXIsICRtZERhdGVMb2NhbGVQcm92aWRlcikge1xuXG4gICAgICAgICAgICAvLyBEYXRlIGZvcm1hdCBjb25maWd1cmF0aW9uXG4gICAgICAgICAgICAkbWREYXRlTG9jYWxlUHJvdmlkZXIuZm9ybWF0RGF0ZSA9IGZ1bmN0aW9uKGRhdGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbW9tZW50KGRhdGUpLmZvcm1hdCgnWVlZWS1NTS1ERCcpO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgLy8gVGhlbWUgY29uZmlndXJhdGlvblxuICAgICAgICAgICAgJG1kVGhlbWluZ1Byb3ZpZGVyXG4gICAgICAgICAgICAgICAgLnRoZW1lKCdmb3Jlc3QnKVxuICAgICAgICAgICAgICAgIC5wcmltYXJ5UGFsZXR0ZSgnYmx1ZScpXG4gICAgICAgICAgICAgICAgLmFjY2VudFBhbGV0dGUoJ3RlYWwnKVxuICAgICAgICAgICAgICAgIC53YXJuUGFsZXR0ZSgncmVkJylcbiAgICAgICAgICAgICAgICAuYmFja2dyb3VuZFBhbGV0dGUoJ2dyZXknKTtcbiAgICAgICAgfSk7XG5cbn0oKSk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIC8vIGluamVjdGluZyBkZXBlbmRlbmNpZXNcbiAgICBNYWluQ29udHJvbGxlci4kaW5qZWN0ID0gW1xuICAgICAgICAnJHNjb3BlJywgJyRyb290U2NvcGUnLCAnJGxvY2F0aW9uJ1xuICAgIF07XG5cbiAgICAvLyByZWdpc3RlcmluZyBvbiBhbmd1bGFyXG4gICAgYW5ndWxhci5tb2R1bGUoJ2Fmcm1BcHAnKS5jb250cm9sbGVyKCdNYWluQ29udHJvbGxlcicsIE1haW5Db250cm9sbGVyKTtcblxuICAgIC8vIE1haW4gQ29udHJvbGxlclxuICAgIGZ1bmN0aW9uIE1haW5Db250cm9sbGVyKCRzY29wZSwgJHJvb3RTY29wZSwgJGxvY2F0aW9uKSB7XG5cbiAgICAgICAgLy8gJHJvb3RTY29wZS5zZXJ2ZXJVcmwgPSAnaHR0cDovL2xvY2FsaG9zdDozMDAwLyc7XG4gICAgICAgICRyb290U2NvcGUuc2VydmVyVXJsID0gJ2h0dHBzOi8vZGV2LXNpc3RlbWFzLXNlcnZlci5oZXJva3VhcHAuY29tLyc7XG5cbiAgICAgICAgJHNjb3BlLm1lbnUgPSBmdW5jdGlvbihwYXRoKSB7XG4gICAgICAgICAgICAkbG9jYXRpb24ucGF0aChwYXRoKTtcbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUubG9nb3V0ID0gIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgnQ1JFREVOVElBTCcpO1xuICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy9sb2dpbicpO1xuICAgICAgICB9O1xuXG4gICAgICAgICRyb290U2NvcGUuJG9uKCckcm91dGVDaGFuZ2VTdWNjZXNzJywgZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAkc2NvcGUuY3JlZGVudGlhbCA9IEpTT04ucGFyc2Uod2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKCdDUkVERU5USUFMJykpO1xuXG4gICAgICAgICAgICBpZiAoJGxvY2F0aW9uLnBhdGgoKSA9PT0gJy9lbXByZXNhcycpXG4gICAgICAgICAgICAgICAgJHNjb3BlLmN1cnJlbnRNZW51SW5kZXggPSAwO1xuXG4gICAgICAgICAgICBlbHNlIGlmICgkbG9jYXRpb24ucGF0aCgpID09PSAnL3NvbGljaXRhY29lcycpXG4gICAgICAgICAgICAgICAgJHNjb3BlLmN1cnJlbnRNZW51SW5kZXggPSAxO1xuXG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgJHNjb3BlLmN1cnJlbnRNZW51SW5kZXggPSAtMTtcblxuICAgICAgICAgICAgJHJvb3RTY29wZS5pc0xvZ2luID0gJGxvY2F0aW9uLnBhdGgoKSA9PT0gJy9sb2dpbicgPyB0cnVlIDogZmFsc2U7XG5cbiAgICAgICAgfSk7XG5cbiAgICB9XG59KCkpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnYWZybUFwcCcpLmNvbmZpZyhbJyRyb3V0ZVByb3ZpZGVyJywgJyRsb2NhdGlvblByb3ZpZGVyJywgQXBwbGljYXRpb25Db25maWddKTtcblxuICAgIGZ1bmN0aW9uIEFwcGxpY2F0aW9uQ29uZmlnKCRyb3V0ZVByb3ZpZGVyLCAkbG9jYXRpb25Qcm92aWRlcikge1xuICAgICAgICAkcm91dGVQcm92aWRlclxuXG4gICAgICAgICAgICAud2hlbignL2xvZ2luJywge1xuICAgICAgICAgICAgICAgICd0ZW1wbGF0ZVVybCcgOiAnYXBwL2NvbXBvbmVudHMvbG9naW4vbG9naW4uaHRtbCcsXG4gICAgICAgICAgICAgICAgJ2NvbnRyb2xsZXInICA6ICdMb2dpbkNvbnRyb2xsZXInXG4gICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICAud2hlbignL2VtcHJlc2FzJywge1xuICAgICAgICAgICAgICAgICd0ZW1wbGF0ZVVybCcgOiAnYXBwL2NvbXBvbmVudHMvY29tcGFuaWVzL2NvbXBhbmllcy5odG1sJyxcbiAgICAgICAgICAgICAgICAnY29udHJvbGxlcicgIDogJ0NvbXBhbmllc0NvbnRyb2xsZXInXG4gICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICAud2hlbignL3NvbGljaXRhY29lcycsIHtcbiAgICAgICAgICAgICAgICAndGVtcGxhdGVVcmwnIDogJ2FwcC9jb21wb25lbnRzL2ludGVybnNoaXBzL2ludGVybnNoaXBzLmh0bWwnLFxuICAgICAgICAgICAgICAgICdjb250cm9sbGVyJyAgOiAnSW50ZXJuc2hpcHNDb250cm9sbGVyJ1xuICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgLndoZW4oJy9yZWdpc3RybycsIHtcbiAgICAgICAgICAgICAgICAndGVtcGxhdGVVcmwnIDogJ2FwcC9jb21wb25lbnRzL2xvZ2luL3JlZ2lzdGVyLmh0bWwnLFxuICAgICAgICAgICAgICAgICdjb250cm9sbGVyJyAgOiAnUmVnaXN0ZXJDb250cm9sbGVyJ1xuICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgLm90aGVyd2lzZSh7XG4gICAgICAgICAgICAgICAgJ3JlZGlyZWN0VG8nOiAnL2xvZ2luJ1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgJGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKHRydWUpO1xuICAgIH1cbn0oKSk7IiwiKGZ1bmN0aW9uKCkge1xuXG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ2Fmcm1BcHAnKS5jb250cm9sbGVyKCdDb21wYW5pZXNDb250cm9sbGVyJywgQ29tcGFuaWVzQ29udHJvbGxlcik7XG5cbiAgICBDb21wYW5pZXNDb250cm9sbGVyLiRpbmplY3QgPSBbICckc2NvcGUnLCAnJG1kRGlhbG9nJywgJ2NvbXBhbmllc1NlcnZpY2UnIF07XG5cbiAgICBmdW5jdGlvbiBDb21wYW5pZXNDb250cm9sbGVyKCRzY29wZSwgJG1kRGlhbG9nLCBjb21wYW5pZXNTZXJ2aWNlKSB7XG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0Q29tcGFuaWVzKG5hbWUpIHtcblxuICAgICAgICAgICAgY29tcGFuaWVzU2VydmljZS5nZXQobmFtZSlcbiAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbihjb21wYW5pZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNvbXBhbmllcyA9IGNvbXBhbmllcztcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbihyZWFzb24pIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVhc29uKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1jb25zb2xlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAkc2NvcGUuc2hvd0RpYWxvZyA9IGZ1bmN0aW9uKGNvbXBhbnkpIHtcblxuICAgICAgICAgICAgaWYgKGNvbXBhbnkuc3RhdHVzID09PSAnQWd1YXJkYW5kbyBhcHJvdmHDp8OjbycpXG4gICAgICAgICAgICAgICAgJG1kRGlhbG9nLnNob3coe1xuICAgICAgICAgICAgICAgICAgICAnY29udHJvbGxlcicgICAgICAgICAgOiAnTWFuYWdlQ29tcGFueUNvbnRyb2xsZXInLFxuICAgICAgICAgICAgICAgICAgICAndGVtcGxhdGVVcmwnICAgICAgICAgOiAnYXBwL3NoYXJlZC90ZW1wbGF0ZXMvbW9kYWxzL2NvbXBhbnktZGlhbG9nLmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICAncGFyZW50JyAgICAgICAgICAgICAgOiBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQuYm9keSksXG4gICAgICAgICAgICAgICAgICAgICdsb2NhbHMnICAgICAgICAgICAgICA6IHsgJ2NvbXBhbnknOiBjb21wYW55IH0sXG4gICAgICAgICAgICAgICAgICAgICdjbGlja091dHNpZGVUb0Nsb3NlJyA6IHRydWVcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUuc2VhcmNoID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgICAgIGdldENvbXBhbmllcyhuYW1lKTtcbiAgICAgICAgfTtcblxuICAgICAgICAoZnVuY3Rpb24gaW5pdCgpIHtcblxuICAgICAgICAgICAgJHNjb3BlLmNvbXBhbnlTZWxlY3RlZCA9IFtdO1xuICAgICAgICAgICAgZ2V0Q29tcGFuaWVzKCk7XG4gICAgICAgIH0oKSk7XG4gICAgfVxufSgpKTtcbiIsIihmdW5jdGlvbigpIHtcblxuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdhZnJtQXBwJykuY29udHJvbGxlcignSG9tZUNvbnRyb2xsZXInLCBIb21lQ29udHJvbGxlcik7XG5cbiAgICBIb21lQ29udHJvbGxlci4kaW5qZWN0ID0gWyAnJHNjb3BlJyBdO1xuXG4gICAgZnVuY3Rpb24gSG9tZUNvbnRyb2xsZXIoJHNjb3BlKSB7XG5cbiAgICAgICAgJHNjb3BlLmFwcHJvdmVTb2xpY2l0YXRpb24gPSAgZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUuaW5zZXJ0U29saWNpdGF0aW9uID0gZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgfTtcbiAgICB9XG59KCkpO1xuIiwiKGZ1bmN0aW9uKCkge1xuXG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ2Fmcm1BcHAnKS5jb250cm9sbGVyKCdJbnRlcm5zaGlwc0NvbnRyb2xsZXInLCBJbnRlcm5zaGlwc0NvbnRyb2xsZXIpO1xuXG4gICAgSW50ZXJuc2hpcHNDb250cm9sbGVyLiRpbmplY3QgPSBbICckc2NvcGUnLCAnJG1kRGlhbG9nJywgJ2ludGVybnNoaXBzU2VydmljZScgXTtcblxuICAgIGZ1bmN0aW9uIEludGVybnNoaXBzQ29udHJvbGxlcigkc2NvcGUsICRtZERpYWxvZywgaW50ZXJuc2hpcHNTZXJ2aWNlKSB7XG5cbiAgICAgICAgJHNjb3BlLmFwcHJvdmVJbnRlcm5zaGlwRGlhbG9nID0gZnVuY3Rpb24oaW50ZXJuc2hpcCwgY3JlZGVudGlhbCwgZXYpIHtcbiAgICAgICAgICAgIGlmIChpbnRlcm5zaGlwLnN0YXR1cyA9PT0gJ0FndWFyZGFuZG8gYXByb3Zhw6fDo28nICYmICgkc2NvcGUuY3JlZGVudGlhbC5yb2xlID09PSAnY29vcmRpbmF0b3InIHx8ICRzY29wZS5jcmVkZW50aWFsLnJvbGUgPT09ICdzdHVkZW50JykpXG4gICAgICAgICAgICAgICAgJG1kRGlhbG9nLnNob3coe1xuICAgICAgICAgICAgICAgICAgICAnY29udHJvbGxlcicgICAgICAgICAgOiAnQXBwcm92ZUludGVybnNoaXBEaWFsb2dDb250cm9sbGVyJyxcbiAgICAgICAgICAgICAgICAgICAgJ3RlbXBsYXRlVXJsJyAgICAgICAgIDogJ2FwcC9zaGFyZWQvdGVtcGxhdGVzL21vZGFscy9hcHByb3ZlLWludGVybnNoaXAtZGlhbG9nLmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICAnbG9jYWxzJyAgICAgICAgICAgICAgOiB7ICdpbnRlcm5zaGlwJzogaW50ZXJuc2hpcCB8fCB7fSwgJ2NyZWRlbnRpYWwnOiBjcmVkZW50aWFsIH0sXG4gICAgICAgICAgICAgICAgICAgICdwYXJlbnQnICAgICAgICAgICAgICA6IGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5ib2R5KSxcbiAgICAgICAgICAgICAgICAgICAgJ3RhcmdldEV2ZW50JyAgICAgICAgIDogZXYsXG4gICAgICAgICAgICAgICAgICAgICdjbGlja091dHNpZGVUb0Nsb3NlJyA6IHRydWVcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUuaW50ZXJuc2hpcERpYWxvZyA9IGZ1bmN0aW9uIChpbnRlcm5zaGlwLCBldikge1xuICAgICAgICAgICAgJG1kRGlhbG9nLnNob3coe1xuICAgICAgICAgICAgICAgICdjb250cm9sbGVyJyAgICAgICAgICA6ICdJbnRlcm5zaGlwRGlhbG9nQ29udHJvbGxlcicsXG4gICAgICAgICAgICAgICAgJ3RlbXBsYXRlVXJsJyAgICAgICAgIDogJ2FwcC9zaGFyZWQvdGVtcGxhdGVzL21vZGFscy9pbnRlcm5zaGlwLWRpYWxvZy5odG1sJyxcbiAgICAgICAgICAgICAgICAnbG9jYWxzJyAgICAgICAgICAgICAgOiB7ICdpbnRlcm5zaGlwJzogaW50ZXJuc2hpcCB8fCB7fSB9LFxuICAgICAgICAgICAgICAgICdwYXJlbnQnICAgICAgICAgICAgICA6IGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5ib2R5KSxcbiAgICAgICAgICAgICAgICAndGFyZ2V0RXZlbnQnICAgICAgICAgOiBldixcbiAgICAgICAgICAgICAgICAnY2xpY2tPdXRzaWRlVG9DbG9zZScgOiB0cnVlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUuc2VhcmNoID0gZnVuY3Rpb24ocXVlcnkpIHtcbiAgICAgICAgICAgIHZhciBxID0geydjcmVkZW50aWFsSWQnOiAkc2NvcGUuY3JlZGVudGlhbC5faWR9O1xuXG4gICAgICAgICAgICBpZiAocXVlcnkubmFtZSlcbiAgICAgICAgICAgICAgICBxLm5hbWUgPSBxdWVyeS5uYW1lLnRyaW0oKTtcblxuICAgICAgICAgICAgaWYgKHF1ZXJ5LnN0YXR1cyAmJiBxdWVyeS5zdGF0dXMudHJpbSgpICE9PSAnVG9kb3MnKVxuICAgICAgICAgICAgICAgIHEuc3RhdHVzID0gcXVlcnkuc3RhdHVzLnRyaW0oKTtcblxuICAgICAgICAgICAgaW50ZXJuc2hpcHNTZXJ2aWNlLmdldChxKVxuICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKGludGVybnNoaXBzKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5pbnRlcm5zaGlwcyA9IGludGVybnNoaXBzO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uKHJlYXNvbikge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZWFzb24pOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLWNvbnNvbGVcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICAoZnVuY3Rpb24gaW5pdCgpIHtcbiAgICAgICAgICAgIHZhciBxdWVyeSA9IHt9O1xuXG4gICAgICAgICAgICAkc2NvcGUucXVlcnkgPSB7fTtcblxuICAgICAgICAgICAgJHNjb3BlLnN0YXR1cyA9IFsnVG9kb3MnLCAnRW0gYW5kYW1lbnRvJywgJ1JlcHJvdmFkbycsICdDYW5jZWxhZG8nLCAnQWd1YXJkYW5kbyBhcHJvdmHDp8OjbycsICdGaW5hbGl6YWRvJ107XG5cbiAgICAgICAgICAgICRzY29wZS5jcmVkZW50aWFsID0gSlNPTi5wYXJzZSh3aW5kb3cubG9jYWxTdG9yYWdlLmdldEl0ZW0oJ0NSRURFTlRJQUwnKSkgfHwge307XG5cbiAgICAgICAgICAgICRzY29wZS5pc1N0dWRlbnQgPSAkc2NvcGUuY3JlZGVudGlhbC5yb2xlID09PSAnc3R1ZGVudCcgPyB0cnVlIDogZmFsc2U7XG5cbiAgICAgICAgICAgIHF1ZXJ5ID0geydjcmVkZW50aWFsSWQnOiAkc2NvcGUuY3JlZGVudGlhbC5faWR9O1xuXG4gICAgICAgICAgICBpbnRlcm5zaGlwc1NlcnZpY2UuZ2V0KHF1ZXJ5KVxuICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKGludGVybnNoaXBzKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5pbnRlcm5zaGlwcyA9IGludGVybnNoaXBzO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uKHJlYXNvbikge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZWFzb24pOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLWNvbnNvbGVcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICB9KCkpO1xuICAgIH1cbn0oKSk7XG4iLCIoZnVuY3Rpb24oKSB7XG5cbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnYWZybUFwcCcpLmNvbnRyb2xsZXIoJ0xvZ2luQ29udHJvbGxlcicsIExvZ2luQ29udHJvbGxlcik7XG5cbiAgICBMb2dpbkNvbnRyb2xsZXIuJGluamVjdCA9IFsgJyRzY29wZScsICdjcmVkZW50aWFsc1NlcnZpY2UnLCAnJGxvY2F0aW9uJywgJyRyb290U2NvcGUnIF07XG5cbiAgICBmdW5jdGlvbiBMb2dpbkNvbnRyb2xsZXIoJHNjb3BlLCBjcmVkZW50aWFsc1NlcnZpY2UsICRsb2NhdGlvbiwgJHJvb3RTY29wZSkge1xuXG4gICAgICAgICRzY29wZS5sb2dpbiA9IGZ1bmN0aW9uKGVtYWlsLCBwYXNzKSB7XG4gICAgICAgICAgICB2YXIgY3JlZGVudGlhbCA9IHtcbiAgICAgICAgICAgICAgICAnZW1haWwnOiBlbWFpbCxcbiAgICAgICAgICAgICAgICAncGFzc3dvcmQnOiBwYXNzXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAkc2NvcGUuaXNMb2FkaW5nID0gdHJ1ZTtcblxuICAgICAgICAgICAgY3JlZGVudGlhbHNTZXJ2aWNlLmxvZ2luKGNyZWRlbnRpYWwpXG4gICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGNyZWRlbnRpYWwpIHtcblxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaXNMb2FkaW5nID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGNyZWRlbnRpYWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnQ1JFREVOVElBTCcsIEpTT04uc3RyaW5naWZ5KGNyZWRlbnRpYWwpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuY3JlZGVudGlhbCA9IGNyZWRlbnRpYWw7XG4gICAgICAgICAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnL3NvbGljaXRhY29lcycpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5pc1dyb25nTG9naW4gPSB0cnVlO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uKHJlYXNvbikge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaXNMb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlYXNvbik7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tY29uc29sZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIChmdW5jdGlvbiBpbml0KCkge1xuXG4gICAgICAgIH0oKSk7XG4gICAgfVxufSgpKTtcbiIsIihmdW5jdGlvbigpIHtcblxuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdhZnJtQXBwJykuY29udHJvbGxlcignUmVnaXN0ZXJDb250cm9sbGVyJywgUmVnaXN0ZXJDb250cm9sbGVyKTtcblxuICAgIFJlZ2lzdGVyQ29udHJvbGxlci4kaW5qZWN0ID0gWyAnJHNjb3BlJywgJ2NyZWRlbnRpYWxzU2VydmljZScsICckbG9jYXRpb24nLCAnJG1kVG9hc3QnLCAnJHRpbWVvdXQnIF07XG5cbiAgICBmdW5jdGlvbiBSZWdpc3RlckNvbnRyb2xsZXIoJHNjb3BlLCBjcmVkZW50aWFsc1NlcnZpY2UsICRsb2NhdGlvbiwgJG1kVG9hc3QsICR0aW1lb3V0KSB7XG5cbiAgICAgICAgJHNjb3BlLmNyZWF0ZUFjY291bnQgPSBmdW5jdGlvbih1c3IpIHtcbiAgICAgICAgICAgIGNyZWRlbnRpYWxzU2VydmljZS5jcmVhdGUodXNyKVxuICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkbWRUb2FzdC5zaG93KFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRtZFRvYXN0LnNpbXBsZSgpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50ZXh0Q29udGVudCgnVXN1w6FyaW8gY3JpYWRvIGNvbSBzdWNlc3NvJylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnBvc2l0aW9uKCdib3R0b20nKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuaGlkZURlbGF5KDMwMDApXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJGxvY2F0aW9uKCcvbG9naW4nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIDMwMDApO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbihyZWFzb24pIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVhc29uKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1jb25zb2xlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICB9XG59KCkpO1xuIiwiKGZ1bmN0aW9uKCkge1xuXG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ2Fmcm1BcHAnKS5jb250cm9sbGVyKCdTb2xpY2l0YXRpb25Db250cm9sbGVyJywgU29saWNpdGF0aW9uQ29udHJvbGxlcik7XG5cbiAgICBTb2xpY2l0YXRpb25Db250cm9sbGVyLiRpbmplY3QgPSBbICckc2NvcGUnIF07XG5cbiAgICBmdW5jdGlvbiBTb2xpY2l0YXRpb25Db250cm9sbGVyKCRzY29wZSkge1xuXG4gICAgICAgICRzY29wZS5hcHByb3ZlU29saWNpdGF0aW9uID0gIGZ1bmN0aW9uKCkge1xuXG4gICAgICAgIH07XG5cbiAgICAgICAgJHNjb3BlLmluc2VydFNvbGljaXRhdGlvbiA9IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgIH07XG5cbiAgICAgICAgKGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICAgIH0oKSk7XG5cbiAgICB9XG59KCkpO1xuIiwiKGZ1bmN0aW9uICgpIHtcblxuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGZ1bmN0aW9uIENvbXBhbmllc1NlcnZpY2UoJGh0dHAsICRyb290U2NvcGUpIHtcblxuICAgICAgICB2YXIgbW9kdWxlID0gJ2NvbXBhbmllcyc7XG5cbiAgICAgICAgdGhpcy5jcmVhdGUgPSBmdW5jdGlvbiAoY29tcGFueSkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLnBvc3QoJHJvb3RTY29wZS5zZXJ2ZXJVcmwgKyBtb2R1bGUsIGNvbXBhbnkpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHRoaXMudXBkYXRlID0gZnVuY3Rpb24gKGNvbXBhbnkpIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5wdXQoJHJvb3RTY29wZS5zZXJ2ZXJVcmwgKyBtb2R1bGUsIGNvbXBhbnkpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHRoaXMuZ2V0ID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgICAgIHZhciB1cmwgPSAkcm9vdFNjb3BlLnNlcnZlclVybCArIG1vZHVsZTtcblxuICAgICAgICAgICAgaWYgKG5hbWUpXG4gICAgICAgICAgICAgICAgdXJsID0gdXJsICsgJy8nICsgbmFtZTtcblxuICAgICAgICAgICAgcmV0dXJuICRodHRwLmdldCh1cmwpO1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIENvbXBhbmllc1NlcnZpY2UuJGluamVjdCA9IFsgJyRodHRwJywgJyRyb290U2NvcGUnIF07XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnYWZybUFwcCcpLnNlcnZpY2UoJ2NvbXBhbmllc1NlcnZpY2UnLCBDb21wYW5pZXNTZXJ2aWNlKTtcblxufSgpKTsiLCIoZnVuY3Rpb24gKCkge1xuXG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgZnVuY3Rpb24gQ3JlZGVudGlhbHNTZXJ2aWNlKCRodHRwLCAkcm9vdFNjb3BlKSB7XG5cbiAgICAgICAgdmFyIG1vZHVsZSA9ICdjcmVkZW50aWFscyc7XG5cbiAgICAgICAgdGhpcy5sb2dpbiA9IGZ1bmN0aW9uIChjcmVkZW50aWFsKSB7XG4gICAgICAgICAgICB2YXIgcXVlcnlzdHJpbmcgPSAnP2VtYWlsPScgKyBjcmVkZW50aWFsLmVtYWlsICsgJyZwYXNzd29yZD0nICsgY3JlZGVudGlhbC5wYXNzd29yZDtcblxuICAgICAgICAgICAgcmV0dXJuICRodHRwLmdldCgkcm9vdFNjb3BlLnNlcnZlclVybCArIG1vZHVsZSArICcvJyArIHF1ZXJ5c3RyaW5nKTtcbiAgICAgICAgfTtcblxuICAgICAgICB0aGlzLmNyZWF0ZSA9ICBmdW5jdGlvbih1c3IpIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5wb3N0KCRyb290U2NvcGUuc2VydmVyVXJsICsgbW9kdWxlLCB1c3IpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHRoaXMubG9nb3V0ID0gZnVuY3Rpb24gKHRva2VuKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KCRyb290U2NvcGUuc2VydmVyVXJsICsgbW9kdWxlICsgJy8nICsgdG9rZW4pO1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIENyZWRlbnRpYWxzU2VydmljZS4kaW5qZWN0ID0gWyAnJGh0dHAnLCAnJHJvb3RTY29wZScgXTtcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdhZnJtQXBwJykuc2VydmljZSgnY3JlZGVudGlhbHNTZXJ2aWNlJywgQ3JlZGVudGlhbHNTZXJ2aWNlKTtcblxufSgpKTsiLCIoZnVuY3Rpb24gKCkge1xuXG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgZnVuY3Rpb24gSW50ZXJuc2hpcHNTZXJ2aWNlKCRodHRwLCAkcm9vdFNjb3BlKSB7XG5cbiAgICAgICAgdmFyIG1vZHVsZSA9ICdpbnRlcm5zaGlwcyc7XG5cbiAgICAgICAgdGhpcy5nZXQgPSBmdW5jdGlvbiAocXVlcnkpIHtcbiAgICAgICAgICAgIHZhciB1cmwgPSAkcm9vdFNjb3BlLnNlcnZlclVybCArIG1vZHVsZSArICcvPyc7XG5cbiAgICAgICAgICAgIGlmIChxdWVyeS5jcmVkZW50aWFsSWQpXG4gICAgICAgICAgICAgICAgdXJsICs9ICdjcmVkZW50aWFsSWQ9JyArIHF1ZXJ5LmNyZWRlbnRpYWxJZDtcblxuICAgICAgICAgICAgaWYgKHF1ZXJ5LnN0YXR1cylcbiAgICAgICAgICAgICAgICB1cmwgKz0gJyZzdGF0dXM9JyArIHF1ZXJ5LnN0YXR1cztcblxuICAgICAgICAgICAgaWYgKHF1ZXJ5Lm5hbWUpXG4gICAgICAgICAgICAgICAgdXJsICs9ICcmbmFtZT0nICsgcXVlcnkubmFtZTtcblxuICAgICAgICAgICAgcmV0dXJuICRodHRwLmdldCh1cmwpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHRoaXMudXBkYXRlID0gZnVuY3Rpb24gKGludGVybnNoaXApIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5wdXQoJHJvb3RTY29wZS5zZXJ2ZXJVcmwgKyBtb2R1bGUsIGludGVybnNoaXApO1xuICAgICAgICB9O1xuXG4gICAgfVxuXG4gICAgSW50ZXJuc2hpcHNTZXJ2aWNlLiRpbmplY3QgPSBbICckaHR0cCcsICckcm9vdFNjb3BlJyBdO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ2Fmcm1BcHAnKS5zZXJ2aWNlKCdpbnRlcm5zaGlwc1NlcnZpY2UnLCBJbnRlcm5zaGlwc1NlcnZpY2UpO1xuXG59KCkpOyIsIihmdW5jdGlvbiAoKSB7XG5cbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBmdW5jdGlvbiBBcHByb3ZlSW50ZXJuc2hpcERpYWxvZ0NvbnRyb2xsZXIoJHNjb3BlLCAkbWREaWFsb2csIGludGVybnNoaXBzU2VydmljZSwgbG9jYWxzKSB7XG5cbiAgICAgICAgZnVuY3Rpb24gdXBkYXRlSW50ZXJuc2hpcCgpIHtcbiAgICAgICAgICAgICRzY29wZS5pc1NhdmluZyA9IHRydWU7XG5cbiAgICAgICAgICAgIGludGVybnNoaXBzU2VydmljZS51cGRhdGUoJHNjb3BlLmludGVybnNoaXApXG4gICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5pc1NhdmluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAkbWREaWFsb2cuaGlkZSgkc2NvcGUuaW50ZXJuc2hpcCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24ocmVhc29uKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlYXNvbik7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tY29uc29sZVxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaXNTYXZpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgJG1kRGlhbG9nLmhpZGUoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgICRzY29wZS5zYXZlID0gZnVuY3Rpb24oaXNBcHByb3ZlKSB7XG5cbiAgICAgICAgICAgIGlmIChpc0FwcHJvdmUgJiYgJHNjb3BlLmNyZWRlbnRpYWwucm9sZSA9PT0gJ2Nvb3JkaW5hdG9yJykge1xuICAgICAgICAgICAgICAgICRzY29wZS5pbnRlcm5zaGlwLnN0YXR1cyA9ICdFbSBhbmRhbWVudG8nO1xuICAgICAgICAgICAgICAgICRzY29wZS5pbnRlcm5zaGlwLmJlZ2luICA9IG1vbWVudCgpLmZvcm1hdCgnREQvTU0vWVlZWScpO1xuICAgICAgICAgICAgICAgICRzY29wZS5pbnRlcm5zaGlwLmVuZCAgICA9IG1vbWVudChtb21lbnQoKSkuYWRkKDYsICdtb250aHMnKS5mb3JtYXQoJ0REL01NL1lZWVknKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKCFpc0FwcHJvdmUgJiYgJHNjb3BlLmNyZWRlbnRpYWwucm9sZSA9PT0gJ2Nvb3JkaW5hdG9yJylcbiAgICAgICAgICAgICAgICAkc2NvcGUuaW50ZXJuc2hpcC5zdGF0dXMgPSAnUmVwcm92YWRvJztcblxuICAgICAgICAgICAgZWxzZSBpZiAoIWlzQXBwcm92ZSAmJiAkc2NvcGUuY3JlZGVudGlhbC5yb2xlID09PSAnc3R1ZGVudCcpXG4gICAgICAgICAgICAgICAgJHNjb3BlLmludGVybnNoaXAuc3RhdHVzID0gJ0NhbmNlbGFkbyc7XG5cbiAgICAgICAgICAgIHVwZGF0ZUludGVybnNoaXAoKTtcbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUuY2xvc2VEaWFsb2cgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICRtZERpYWxvZy5jYW5jZWwoKTtcbiAgICAgICAgfTtcblxuICAgICAgICAoZnVuY3Rpb24gaW5pdCgpIHtcbiAgICAgICAgICAgICRzY29wZS5pbnRlcm5zaGlwID0gbG9jYWxzLmludGVybnNoaXAgfHwge307XG4gICAgICAgICAgICAkc2NvcGUuY3JlZGVudGlhbCA9IGxvY2Fscy5jcmVkZW50aWFsIHx8IHt9O1xuICAgICAgICB9KSgpO1xuICAgIH1cblxuICAgIEFwcHJvdmVJbnRlcm5zaGlwRGlhbG9nQ29udHJvbGxlci4kaW5qZWN0ID0gWyAnJHNjb3BlJywgJyRtZERpYWxvZycsICdpbnRlcm5zaGlwc1NlcnZpY2UnLCAnbG9jYWxzJyBdO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ2Fmcm1BcHAnKS5jb250cm9sbGVyKCdBcHByb3ZlSW50ZXJuc2hpcERpYWxvZ0NvbnRyb2xsZXInLCBBcHByb3ZlSW50ZXJuc2hpcERpYWxvZ0NvbnRyb2xsZXIpO1xuXG59KCkpOyIsIihmdW5jdGlvbiAoKSB7XG5cbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBmdW5jdGlvbiBNYW5hZ2VDb21wYW55Q29udHJvbGxlcigkc2NvcGUsICRtZERpYWxvZywgY29tcGFuaWVzU2VydmljZSwgbG9jYWxzKSB7XG5cbiAgICAgICAgJHNjb3BlLnNhdmUgPSBmdW5jdGlvbihjb21wYW55LCBzdGF0dXMpIHtcblxuICAgICAgICAgICAgJHNjb3BlLmlzTG9hZGluZ0NvbXBhbnkgPSB0cnVlO1xuXG4gICAgICAgICAgICBpZiAoc3RhdHVzID09PSB0cnVlKVxuICAgICAgICAgICAgICAgIGNvbXBhbnkuc3RhdHVzID0gJ0Fwcm92YWRvJztcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICBjb21wYW55LnN0YXR1cyA9ICdSZXByb3ZhZG8nO1xuXG5cbiAgICAgICAgICAgIGNvbXBhbmllc1NlcnZpY2UudXBkYXRlKGNvbXBhbnkpXG4gICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaXNMb2FkaW5nQ29tcGFueSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAkbWREaWFsb2cuaGlkZShjb21wYW55KTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAocmVhc29uKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5pc0xvYWRpbmdDb21wYW55ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlYXNvbik7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tY29uc29sZVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH07XG5cbiAgICAgICAgJHNjb3BlLmNsb3NlRGlhbG9nID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkbWREaWFsb2cuY2FuY2VsKCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgKGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICAgICAgICAkc2NvcGUuY29tcGFueSA9IGxvY2Fscy5jb21wYW55IHx8IHt9O1xuICAgICAgICB9KSgpO1xuICAgIH1cblxuICAgIE1hbmFnZUNvbXBhbnlDb250cm9sbGVyLiRpbmplY3QgPSBbICckc2NvcGUnLCAnJG1kRGlhbG9nJywgJ2NvbXBhbmllc1NlcnZpY2UnLCAnbG9jYWxzJyBdO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ2Fmcm1BcHAnKS5jb250cm9sbGVyKCdNYW5hZ2VDb21wYW55Q29udHJvbGxlcicsIE1hbmFnZUNvbXBhbnlDb250cm9sbGVyKTtcblxufSgpKTsiLCIoZnVuY3Rpb24gKCkge1xuXG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgZnVuY3Rpb24gSW50ZXJuc2hpcERpYWxvZ0NvbnRyb2xsZXIoJHNjb3BlLCAkbWREaWFsb2csIGludGVybnNoaXBzU2VydmljZSwgbG9jYWxzKSB7XG5cbiAgICAgICAgJHNjb3BlLmNsb3NlRGlhbG9nID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkbWREaWFsb2cuY2FuY2VsKCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgKGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICAgICAgICAkc2NvcGUuaW50ZXJuc2hpcCA9IGxvY2Fscy5pbnRlcm5zaGlwIHx8IHt9O1xuICAgICAgICB9KSgpO1xuICAgIH1cblxuICAgIEludGVybnNoaXBEaWFsb2dDb250cm9sbGVyLiRpbmplY3QgPSBbICckc2NvcGUnLCAnJG1kRGlhbG9nJywgJ2ludGVybnNoaXBzU2VydmljZScsICdsb2NhbHMnIF07XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnYWZybUFwcCcpLmNvbnRyb2xsZXIoJ0ludGVybnNoaXBEaWFsb2dDb250cm9sbGVyJywgSW50ZXJuc2hpcERpYWxvZ0NvbnRyb2xsZXIpO1xuXG59KCkpOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
