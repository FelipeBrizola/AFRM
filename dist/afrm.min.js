!function(){"use strict";angular.module("afrmApp",["ngMaterial","ngAnimate","ngRoute","angular.filter","md.data.table","ui.mask"]).config(["$mdThemingProvider","$mdDateLocaleProvider",function(e,n){n.formatDate=function(e){return moment(e).format("YYYY-MM-DD")},e.theme("forest").primaryPalette("blue").accentPalette("teal").warnPalette("red").backgroundPalette("grey")}])}(),function(){"use strict";function e(e,n,o){n.serverUrl="https://dev-sistemas-server.herokuapp.com/",e.menu=function(e){o.path(e)},e.logout=function(){window.localStorage.removeItem("CREDENTIAL"),o.path("/login")},n.$on("$routeChangeSuccess",function(){e.credential=JSON.parse(window.localStorage.getItem("CREDENTIAL")),"/empresas"===o.path()?e.currentMenuIndex=0:"/solicitacoes"===o.path()?e.currentMenuIndex=1:"/logs"===o.path()?e.currentMenuIndex=2:e.currentMenuIndex=-1,n.isLogin="/login"===o.path()})}e.$inject=["$scope","$rootScope","$location"],angular.module("afrmApp").controller("MainController",e)}(),function(){"use strict";function e(e,n){e.when("/login",{templateUrl:"app/components/login/login.html",controller:"LoginController"}).when("/empresas",{templateUrl:"app/components/companies/companies.html",controller:"CompaniesController"}).when("/solicitacoes",{templateUrl:"app/components/internships/internships.html",controller:"InternshipsController"}).when("/logs",{templateUrl:"app/components/logs/logs.html",controller:"LogsController"}).when("/registro",{templateUrl:"app/components/login/register.html",controller:"RegisterController"}).otherwise({redirectTo:"/login"}),n.html5Mode(!0)}angular.module("afrmApp").config(["$routeProvider","$locationProvider",e])}(),function(){"use strict";function e(e,n,o){function t(n){e.isLoadingCompanies=!0,o.get(n).success(function(n){e.companies=n,e.isLoadingCompanies=!1}).error(function(n){console.log(n),e.isLoadingCompanies=!1})}e.showDialog=function(e){"Aguardando aprovação"===e.status&&n.show({controller:"ManageCompanyController",templateUrl:"app/shared/templates/modals/company-dialog.html",parent:angular.element(document.body),locals:{company:e},clickOutsideToClose:!0})},e.search=function(e){t(e)},function(){e.companySelected=[],t()}()}angular.module("afrmApp").controller("CompaniesController",e),e.$inject=["$scope","$mdDialog","companiesService"]}(),function(){"use strict";function e(e){e.approveSolicitation=function(){},e.insertSolicitation=function(){}}angular.module("afrmApp").controller("HomeController",e),e.$inject=["$scope"]}(),function(){"use strict";function e(e,n,o){e.approveInternshipDialog=function(o,t,r){"Aguardando aprovação"!==o.status||"coordinator"!==e.credential.role&&"student"!==e.credential.role||n.show({controller:"ApproveInternshipDialogController",templateUrl:"app/shared/templates/modals/approve-internship-dialog.html",locals:{internship:o||{},credential:t},parent:angular.element(document.body),targetEvent:r,clickOutsideToClose:!0})},e.internshipDialog=function(o,t){n.show({controller:"InternshipDialogController",templateUrl:"app/shared/templates/modals/internship-dialog.html",locals:{internship:angular.copy(o)||{}},parent:angular.element(document.body),targetEvent:t,clickOutsideToClose:!0}).then(function(n){var o=0;for(o;o<e.internships.length;o+=1)if(e.internships[o]._id===n._id){e.internships[o]=n;break}})},e.search=function(n){var t={credentialId:e.credential._id};n.name&&(t.name=n.name.trim()),n.status&&"Todos"!==n.status.trim()&&(t.status=n.status.trim()),o.get(t).success(function(n){e.internships=n}).error(function(e){console.log(e)})},function(){var n={};e.query={},e.status=["Todos","Em andamento","Reprovado","Cancelado","Aguardando aprovação","Finalizado"],e.credential=JSON.parse(window.localStorage.getItem("CREDENTIAL"))||{},e.isStudent="student"===e.credential.role,n={credentialId:e.credential._id},e.isLoadingInternships=!0,o.get(n).success(function(n){e.internships=n,e.isLoadingInternships=!1}).error(function(n){console.log(n),e.isLoadingInternships=!1})}()}angular.module("afrmApp").controller("InternshipsController",e),e.$inject=["$scope","$mdDialog","internshipsService"]}(),function(){"use strict";function e(e,n,o,t){e.login=function(r,i){var a={email:r,password:i};e.isLoading=!0,n.login(a).success(function(n){e.isLoading=!1,n?(window.localStorage.setItem("CREDENTIAL",JSON.stringify(n)),t.credential=n,o.path("/solicitacoes")):e.isWrongLogin=!0}).error(function(n){e.isLoading=!1,console.log(n)})}}angular.module("afrmApp").controller("LoginController",e),e.$inject=["$scope","credentialsService","$location","$rootScope"]}(),function(){"use strict";function e(e,n,o,t,r){e.createAccount=function(e){n.create(e).success(function(e){e&&(t.show(t.simple().textContent("Usuário criado com sucesso").position("bottom").hideDelay(3e3)),r(function(){o("/login")},3e3))}).error(function(e){console.log(e)})}}angular.module("afrmApp").controller("RegisterController",e),e.$inject=["$scope","credentialsService","$location","$mdToast","$timeout"]}(),function(){"use strict";function e(e,n){!function(){e.tableParams={limit:5,page:1},e.isLoadingLogs=!0,n.get().success(function(n){e.logs=n,e.isLoadingLogs=!1,e.tableParams.total=n.length}).error(function(n){e.isLoadingLogs=!1,console.log(n)})}()}angular.module("afrmApp").controller("LogsController",e),e.$inject=["$scope","logsService"]}(),function(){"use strict";function e(e){e.approveSolicitation=function(){},e.insertSolicitation=function(){}}angular.module("afrmApp").controller("SolicitationController",e),e.$inject=["$scope"]}(),function(){"use strict";function e(e,n){var o="companies";this.create=function(t){return e.post(n.serverUrl+o,t)},this.update=function(t){return t.changer=JSON.parse(window.localStorage.getItem("CREDENTIAL"))._id,e.put(n.serverUrl+o,t)},this.get=function(t){var r=n.serverUrl+o;return t&&(r=r+"/"+t),e.get(r)}}e.$inject=["$http","$rootScope"],angular.module("afrmApp").service("companiesService",e)}(),function(){"use strict";function e(e,n){var o="credentials";this.login=function(t){var r="?email="+t.email+"&password="+t.password;return e.get(n.serverUrl+o+"/"+r)},this.create=function(t){return e.post(n.serverUrl+o,t)},this.logout=function(t){return e.get(n.serverUrl+o+"/"+t)}}e.$inject=["$http","$rootScope"],angular.module("afrmApp").service("credentialsService",e)}(),function(){"use strict";function e(e,n){var o="internships";this.get=function(t){var r=n.serverUrl+o+"/?";return t.credentialId&&(r+="credentialId="+t.credentialId),t.status&&(r+="&status="+t.status),t.name&&(r+="&name="+t.name),e.get(r)},this.update=function(t){return t.changer=JSON.parse(window.localStorage.getItem("CREDENTIAL"))._id,e.put(n.serverUrl+o,t)}}e.$inject=["$http","$rootScope"],angular.module("afrmApp").service("internshipsService",e)}(),function(){"use strict";function e(e,n){var o="logs";this.get=function(){return e.get(n.serverUrl+o)}}e.$inject=["$http","$rootScope"],angular.module("afrmApp").service("logsService",e)}(),function(){"use strict";function e(e,n,o,t){function r(){e.isSaving=!0,o.update(e.internship).success(function(){e.isSaving=!1,n.hide(e.internship)}).error(function(o){console.log(o),e.isSaving=!1,n.hide()})}e.save=function(n){n&&"coordinator"===e.credential.role?(e.internship.status="Em andamento",e.internship.begin=moment().format("DD/MM/YYYY"),e.internship.end=moment(moment()).add(6,"months").format("DD/MM/YYYY")):n||"coordinator"!==e.credential.role?n||"student"!==e.credential.role||(e.internship.status="Cancelado"):e.internship.status="Reprovado",r()},e.closeDialog=function(){n.cancel()},function(){e.internship=t.internship||{},e.credential=t.credential||{}}()}e.$inject=["$scope","$mdDialog","internshipsService","locals"],angular.module("afrmApp").controller("ApproveInternshipDialogController",e)}(),function(){"use strict";function e(e,n,o,t){e.save=function(t,r){e.isLoadingCompany=!0,r===!0?t.status="Aprovado":t.status="Reprovado",o.update(t).success(function(){e.isLoadingCompany=!1,n.hide(t)}).error(function(n){e.isLoadingCompany=!1,console.log(n)})},e.closeDialog=function(){n.cancel()},function(){e.company=t.company||{}}()}e.$inject=["$scope","$mdDialog","companiesService","locals"],angular.module("afrmApp").controller("ManageCompanyController",e)}(),function(){"use strict";function e(e,n,o,t){e.closeDialog=function(){n.cancel()},e.update=function(e){e.begin=moment(e.begin,"DD/MM/YYYY"),e.begin=moment(e.begin).format("DD/MM/YYYY"),o.update(e).success(function(o){n.hide(e)}).error(function(e){})},function(){var n=JSON.parse(window.localStorage.getItem("CREDENTIAL")).role;e.internship=t.internship||{},e.isEditable="student"===n&&e.internship&&"Aguardando aprovação"===e.internship.status}()}e.$inject=["$scope","$mdDialog","internshipsService","locals"],angular.module("afrmApp").controller("InternshipDialogController",e)}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC1tb2R1bGUuanMiLCJhcHAtY29udHJvbGxlci5qcyIsImFwcC1yb3V0ZXMuanMiLCJjb21wb25lbnRzL2NvbXBhbmllcy9jb21wYW5pZXMuY29udHJvbGxlci5qcyIsImNvbXBvbmVudHMvaG9tZS9ob21lLmNvbnRyb2xsZXIuanMiLCJjb21wb25lbnRzL2ludGVybnNoaXBzL2ludGVybnNoaXBzLmNvbnRyb2xsZXIuanMiLCJjb21wb25lbnRzL2xvZ2luL2xvZ2luLmNvbnRyb2xsZXIuanMiLCJjb21wb25lbnRzL2xvZ2luL3JlZ2lzdGVyLmNvbnRyb2xsZXIuanMiLCJjb21wb25lbnRzL2xvZ3MvbG9ncy5jb250cm9sbGVyLmpzIiwiY29tcG9uZW50cy9zb2xpY2l0YXRpb24vc29saWNpdGF0aW9uLmNvbnRyb2xsZXIuanMiLCJzaGFyZWQvc2VydmljZXMvY29tcGFuaWVzLnNlcnZpY2UuanMiLCJzaGFyZWQvc2VydmljZXMvY3JlZGVudGlhbHMuc2VydmljZS5qcyIsInNoYXJlZC9zZXJ2aWNlcy9pbnRlcm5zaGlwcy5zZXJ2aWNlLmpzIiwic2hhcmVkL3NlcnZpY2VzL2xvZ3Muc2VydmljZS5qcyIsInNoYXJlZC90ZW1wbGF0ZXMvbW9kYWxzL2FwcHJvdmUuaW50ZXJuc2hpcC5kaWFsb2cuY29udHJvbGxlci5qcyIsInNoYXJlZC90ZW1wbGF0ZXMvbW9kYWxzL2NvbXBhbnkuZGlhbG9nLmNvbnRyb2xsZXIuanMiLCJzaGFyZWQvdGVtcGxhdGVzL21vZGFscy9pbnRlcm5zaGlwLmRpYWxvZy5jb250cm9sbGVyLmpzIl0sIm5hbWVzIjpbImFuZ3VsYXIiLCJtb2R1bGUiLCJjb25maWciLCIkbWRUaGVtaW5nUHJvdmlkZXIiLCIkbWREYXRlTG9jYWxlUHJvdmlkZXIiLCJmb3JtYXREYXRlIiwiZGF0ZSIsIm1vbWVudCIsImZvcm1hdCIsInRoZW1lIiwicHJpbWFyeVBhbGV0dGUiLCJhY2NlbnRQYWxldHRlIiwid2FyblBhbGV0dGUiLCJiYWNrZ3JvdW5kUGFsZXR0ZSIsIk1haW5Db250cm9sbGVyIiwiJHNjb3BlIiwiJHJvb3RTY29wZSIsIiRsb2NhdGlvbiIsInNlcnZlclVybCIsIm1lbnUiLCJwYXRoIiwibG9nb3V0Iiwid2luZG93IiwibG9jYWxTdG9yYWdlIiwicmVtb3ZlSXRlbSIsIiRvbiIsImNyZWRlbnRpYWwiLCJKU09OIiwicGFyc2UiLCJnZXRJdGVtIiwiY3VycmVudE1lbnVJbmRleCIsImlzTG9naW4iLCIkaW5qZWN0IiwiY29udHJvbGxlciIsIkFwcGxpY2F0aW9uQ29uZmlnIiwiJHJvdXRlUHJvdmlkZXIiLCIkbG9jYXRpb25Qcm92aWRlciIsIndoZW4iLCJ0ZW1wbGF0ZVVybCIsIm90aGVyd2lzZSIsInJlZGlyZWN0VG8iLCJodG1sNU1vZGUiLCJDb21wYW5pZXNDb250cm9sbGVyIiwiJG1kRGlhbG9nIiwiY29tcGFuaWVzU2VydmljZSIsImdldENvbXBhbmllcyIsIm5hbWUiLCJpc0xvYWRpbmdDb21wYW5pZXMiLCJnZXQiLCJzdWNjZXNzIiwiY29tcGFuaWVzIiwiZXJyb3IiLCJyZWFzb24iLCJjb25zb2xlIiwibG9nIiwic2hvd0RpYWxvZyIsImNvbXBhbnkiLCJzdGF0dXMiLCJzaG93IiwicGFyZW50IiwiZWxlbWVudCIsImRvY3VtZW50IiwiYm9keSIsImxvY2FscyIsImNsaWNrT3V0c2lkZVRvQ2xvc2UiLCJzZWFyY2giLCJjb21wYW55U2VsZWN0ZWQiLCJIb21lQ29udHJvbGxlciIsImFwcHJvdmVTb2xpY2l0YXRpb24iLCJpbnNlcnRTb2xpY2l0YXRpb24iLCJJbnRlcm5zaGlwc0NvbnRyb2xsZXIiLCJpbnRlcm5zaGlwc1NlcnZpY2UiLCJhcHByb3ZlSW50ZXJuc2hpcERpYWxvZyIsImludGVybnNoaXAiLCJldiIsInJvbGUiLCJ0YXJnZXRFdmVudCIsImludGVybnNoaXBEaWFsb2ciLCJjb3B5IiwidGhlbiIsInVwZGF0ZWRJbnRlcm5zaGlwIiwiaSIsImludGVybnNoaXBzIiwibGVuZ3RoIiwiX2lkIiwicXVlcnkiLCJxIiwiY3JlZGVudGlhbElkIiwidHJpbSIsImlzU3R1ZGVudCIsImlzTG9hZGluZ0ludGVybnNoaXBzIiwiTG9naW5Db250cm9sbGVyIiwiY3JlZGVudGlhbHNTZXJ2aWNlIiwibG9naW4iLCJlbWFpbCIsInBhc3MiLCJwYXNzd29yZCIsImlzTG9hZGluZyIsInNldEl0ZW0iLCJzdHJpbmdpZnkiLCJpc1dyb25nTG9naW4iLCJSZWdpc3RlckNvbnRyb2xsZXIiLCIkbWRUb2FzdCIsIiR0aW1lb3V0IiwiY3JlYXRlQWNjb3VudCIsInVzciIsImNyZWF0ZSIsInJlc3VsdCIsInNpbXBsZSIsInRleHRDb250ZW50IiwicG9zaXRpb24iLCJoaWRlRGVsYXkiLCJMb2dzQ29udHJvbGxlciIsImxvZ3NTZXJ2aWNlIiwidGFibGVQYXJhbXMiLCJsaW1pdCIsInBhZ2UiLCJpc0xvYWRpbmdMb2dzIiwibG9ncyIsInRvdGFsIiwiU29saWNpdGF0aW9uQ29udHJvbGxlciIsIkNvbXBhbmllc1NlcnZpY2UiLCIkaHR0cCIsInRoaXMiLCJwb3N0IiwidXBkYXRlIiwiY2hhbmdlciIsInB1dCIsInVybCIsInNlcnZpY2UiLCJDcmVkZW50aWFsc1NlcnZpY2UiLCJxdWVyeXN0cmluZyIsInRva2VuIiwiSW50ZXJuc2hpcHNTZXJ2aWNlIiwiTG9nc1NlcnZpY2UiLCJBcHByb3ZlSW50ZXJuc2hpcERpYWxvZ0NvbnRyb2xsZXIiLCJ1cGRhdGVJbnRlcm5zaGlwIiwiaXNTYXZpbmciLCJoaWRlIiwic2F2ZSIsImlzQXBwcm92ZSIsImJlZ2luIiwiZW5kIiwiYWRkIiwiY2xvc2VEaWFsb2ciLCJjYW5jZWwiLCJNYW5hZ2VDb21wYW55Q29udHJvbGxlciIsImlzTG9hZGluZ0NvbXBhbnkiLCJJbnRlcm5zaGlwRGlhbG9nQ29udHJvbGxlciIsImlzRWRpdGFibGUiXSwibWFwcGluZ3MiOiJDQUFBLFdBQ0EsWUFHQUEsU0FBQUMsT0FBQSxXQUNBLGFBQ0EsWUFDQSxVQUNBLGlCQUNBLGdCQUNBLFlBR0FDLFFBQUEscUJBQUEs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QUErRixLQUFBbEYsS0FFQUwsTUFBQSxTQUFBQyxHQUNBckMsRUFBQW9JLGtCQUFBLEVBQ0E5RixRQUFBQyxJQUFBRixNQUtBckMsRUFBQWlJLFlBQUEsV0FDQXJHLEVBQUFzRyxVQUdBLFdBQ0FsSSxFQUFBeUMsUUFBQU8sRUFBQVAsZUFJQTBGLEVBQUFsSCxTQUFBLFNBQUEsWUFBQSxtQkFBQSxVQUVBaEMsUUFBQUMsT0FBQSxXQUFBZ0MsV0FBQSwwQkFBQWlILE1DdkNBLFdBRUEsWUFFQSxTQUFBRSxHQUFBckksRUFBQTRCLEVBQUE0QixFQUFBUixHQUVBaEQsRUFBQWlJLFlBQUEsV0FDQXJHLEVBQUFzRyxVQUdBbEksRUFBQThHLE9BQUEsU0FBQXBELEdBRUFBLEVBQUFvRSxNQUFBdEksT0FBQWtFLEVBQUFvRSxNQUFBLGNBQ0FwRSxFQUFBb0UsTUFBQXRJLE9BQUFrRSxFQUFBb0UsT0FBQXJJLE9BQUEsY0FFQStELEVBQUFzRCxPQUFBcEQsR0FDQXhCLFFBQUEsU0FBQTBELEdBRUFoRSxFQUFBK0YsS0FBQWpFLEtBRUF0QixNQUFBLFNBQUFDLE9BS0EsV0FFQSxHQUFBdUIsR0FBQWhELEtBQUFDLE1BQUFOLE9BQUFDLGFBQUFNLFFBQUEsZUFBQThDLElBRUE1RCxHQUFBMEQsV0FBQVYsRUFBQVUsZUFFQTFELEVBQUFzSSxXQUFBLFlBQUExRSxHQUFBNUQsRUFBQTBELFlBQUEseUJBQUExRCxFQUFBMEQsV0FBQWhCLFVBS0EyRixFQUFBcEgsU0FBQSxTQUFBLFlBQUEscUJBQUEsVUFFQWhDLFFBQUFDLE9BQUEsV0FBQWdDLFdBQUEsNkJBQUFtSCIsImZpbGUiOiJhZnJtLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgLy8gTW9kdWxlIGRlcGVuZGVuY2llcyBpbmplY3Rpb25cbiAgICBhbmd1bGFyLm1vZHVsZSgnYWZybUFwcCcsIFtcbiAgICAgICAgJ25nTWF0ZXJpYWwnLFxuICAgICAgICAnbmdBbmltYXRlJyxcbiAgICAgICAgJ25nUm91dGUnLFxuICAgICAgICAnYW5ndWxhci5maWx0ZXInLFxuICAgICAgICAnbWQuZGF0YS50YWJsZScsXG4gICAgICAgICd1aS5tYXNrJ1xuICAgIF0pXG5cbiAgICAgICAgLmNvbmZpZyhmdW5jdGlvbiAoJG1kVGhlbWluZ1Byb3ZpZGVyLCAkbWREYXRlTG9jYWxlUHJvdmlkZXIpIHtcblxuICAgICAgICAgICAgLy8gRGF0ZSBmb3JtYXQgY29uZmlndXJhdGlvblxuICAgICAgICAgICAgJG1kRGF0ZUxvY2FsZVByb3ZpZGVyLmZvcm1hdERhdGUgPSBmdW5jdGlvbihkYXRlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG1vbWVudChkYXRlKS5mb3JtYXQoJ1lZWVktTU0tREQnKTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIC8vIFRoZW1lIGNvbmZpZ3VyYXRpb25cbiAgICAgICAgICAgICRtZFRoZW1pbmdQcm92aWRlclxuICAgICAgICAgICAgICAgIC50aGVtZSgnZm9yZXN0JylcbiAgICAgICAgICAgICAgICAucHJpbWFyeVBhbGV0dGUoJ2JsdWUnKVxuICAgICAgICAgICAgICAgIC5hY2NlbnRQYWxldHRlKCd0ZWFsJylcbiAgICAgICAgICAgICAgICAud2FyblBhbGV0dGUoJ3JlZCcpXG4gICAgICAgICAgICAgICAgLmJhY2tncm91bmRQYWxldHRlKCdncmV5Jyk7XG4gICAgICAgIH0pO1xuXG59KCkpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICAvLyBpbmplY3RpbmcgZGVwZW5kZW5jaWVzXG4gICAgTWFpbkNvbnRyb2xsZXIuJGluamVjdCA9IFtcbiAgICAgICAgJyRzY29wZScsICckcm9vdFNjb3BlJywgJyRsb2NhdGlvbidcbiAgICBdO1xuXG4gICAgLy8gcmVnaXN0ZXJpbmcgb24gYW5ndWxhclxuICAgIGFuZ3VsYXIubW9kdWxlKCdhZnJtQXBwJykuY29udHJvbGxlcignTWFpbkNvbnRyb2xsZXInLCBNYWluQ29udHJvbGxlcik7XG5cbiAgICAvLyBNYWluIENvbnRyb2xsZXJcbiAgICBmdW5jdGlvbiBNYWluQ29udHJvbGxlcigkc2NvcGUsICRyb290U2NvcGUsICRsb2NhdGlvbikge1xuXG4gICAgICAgIC8vICRyb290U2NvcGUuc2VydmVyVXJsID0gJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMC8nO1xuICAgICAgICAkcm9vdFNjb3BlLnNlcnZlclVybCA9ICdodHRwczovL2Rldi1zaXN0ZW1hcy1zZXJ2ZXIuaGVyb2t1YXBwLmNvbS8nO1xuXG4gICAgICAgICRzY29wZS5tZW51ID0gZnVuY3Rpb24ocGF0aCkge1xuICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgocGF0aCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgJHNjb3BlLmxvZ291dCA9ICBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ0NSRURFTlRJQUwnKTtcbiAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvbG9naW4nKTtcbiAgICAgICAgfTtcblxuICAgICAgICAkcm9vdFNjb3BlLiRvbignJHJvdXRlQ2hhbmdlU3VjY2VzcycsIGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgJHNjb3BlLmNyZWRlbnRpYWwgPSBKU09OLnBhcnNlKHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnQ1JFREVOVElBTCcpKTtcblxuICAgICAgICAgICAgaWYgKCRsb2NhdGlvbi5wYXRoKCkgPT09ICcvZW1wcmVzYXMnKVxuICAgICAgICAgICAgICAgICRzY29wZS5jdXJyZW50TWVudUluZGV4ID0gMDtcblxuICAgICAgICAgICAgZWxzZSBpZiAoJGxvY2F0aW9uLnBhdGgoKSA9PT0gJy9zb2xpY2l0YWNvZXMnKVxuICAgICAgICAgICAgICAgICRzY29wZS5jdXJyZW50TWVudUluZGV4ID0gMTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgZWxzZSBpZiAoJGxvY2F0aW9uLnBhdGgoKSA9PT0gJy9sb2dzJylcbiAgICAgICAgICAgICAgICAkc2NvcGUuY3VycmVudE1lbnVJbmRleCA9IDI7XG5cbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAkc2NvcGUuY3VycmVudE1lbnVJbmRleCA9IC0xO1xuXG4gICAgICAgICAgICAkcm9vdFNjb3BlLmlzTG9naW4gPSAkbG9jYXRpb24ucGF0aCgpID09PSAnL2xvZ2luJyA/IHRydWUgOiBmYWxzZTtcblxuICAgICAgICB9KTtcblxuICAgIH1cbn0oKSk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdhZnJtQXBwJykuY29uZmlnKFsnJHJvdXRlUHJvdmlkZXInLCAnJGxvY2F0aW9uUHJvdmlkZXInLCBBcHBsaWNhdGlvbkNvbmZpZ10pO1xuXG4gICAgZnVuY3Rpb24gQXBwbGljYXRpb25Db25maWcoJHJvdXRlUHJvdmlkZXIsICRsb2NhdGlvblByb3ZpZGVyKSB7XG4gICAgICAgICRyb3V0ZVByb3ZpZGVyXG5cbiAgICAgICAgICAgIC53aGVuKCcvbG9naW4nLCB7XG4gICAgICAgICAgICAgICAgJ3RlbXBsYXRlVXJsJyA6ICdhcHAvY29tcG9uZW50cy9sb2dpbi9sb2dpbi5odG1sJyxcbiAgICAgICAgICAgICAgICAnY29udHJvbGxlcicgIDogJ0xvZ2luQ29udHJvbGxlcidcbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgIC53aGVuKCcvZW1wcmVzYXMnLCB7XG4gICAgICAgICAgICAgICAgJ3RlbXBsYXRlVXJsJyA6ICdhcHAvY29tcG9uZW50cy9jb21wYW5pZXMvY29tcGFuaWVzLmh0bWwnLFxuICAgICAgICAgICAgICAgICdjb250cm9sbGVyJyAgOiAnQ29tcGFuaWVzQ29udHJvbGxlcidcbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgIC53aGVuKCcvc29saWNpdGFjb2VzJywge1xuICAgICAgICAgICAgICAgICd0ZW1wbGF0ZVVybCcgOiAnYXBwL2NvbXBvbmVudHMvaW50ZXJuc2hpcHMvaW50ZXJuc2hpcHMuaHRtbCcsXG4gICAgICAgICAgICAgICAgJ2NvbnRyb2xsZXInICA6ICdJbnRlcm5zaGlwc0NvbnRyb2xsZXInXG4gICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICAud2hlbignL2xvZ3MnLCB7XG4gICAgICAgICAgICAgICAgJ3RlbXBsYXRlVXJsJyA6ICdhcHAvY29tcG9uZW50cy9sb2dzL2xvZ3MuaHRtbCcsXG4gICAgICAgICAgICAgICAgJ2NvbnRyb2xsZXInICA6ICdMb2dzQ29udHJvbGxlcidcbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgIC53aGVuKCcvcmVnaXN0cm8nLCB7XG4gICAgICAgICAgICAgICAgJ3RlbXBsYXRlVXJsJyA6ICdhcHAvY29tcG9uZW50cy9sb2dpbi9yZWdpc3Rlci5odG1sJyxcbiAgICAgICAgICAgICAgICAnY29udHJvbGxlcicgIDogJ1JlZ2lzdGVyQ29udHJvbGxlcidcbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgIC5vdGhlcndpc2Uoe1xuICAgICAgICAgICAgICAgICdyZWRpcmVjdFRvJzogJy9sb2dpbidcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICRsb2NhdGlvblByb3ZpZGVyLmh0bWw1TW9kZSh0cnVlKTtcbiAgICB9XG59KCkpOyIsIihmdW5jdGlvbigpIHtcblxuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdhZnJtQXBwJykuY29udHJvbGxlcignQ29tcGFuaWVzQ29udHJvbGxlcicsIENvbXBhbmllc0NvbnRyb2xsZXIpO1xuXG4gICAgQ29tcGFuaWVzQ29udHJvbGxlci4kaW5qZWN0ID0gWyAnJHNjb3BlJywgJyRtZERpYWxvZycsICdjb21wYW5pZXNTZXJ2aWNlJyBdO1xuXG4gICAgZnVuY3Rpb24gQ29tcGFuaWVzQ29udHJvbGxlcigkc2NvcGUsICRtZERpYWxvZywgY29tcGFuaWVzU2VydmljZSkge1xuXG4gICAgICAgIGZ1bmN0aW9uIGdldENvbXBhbmllcyhuYW1lKSB7XG5cbiAgICAgICAgICAgICRzY29wZS5pc0xvYWRpbmdDb21wYW5pZXMgPSB0cnVlO1xuXG4gICAgICAgICAgICBjb21wYW5pZXNTZXJ2aWNlLmdldChuYW1lKVxuICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKGNvbXBhbmllcykge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY29tcGFuaWVzID0gY29tcGFuaWVzO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaXNMb2FkaW5nQ29tcGFuaWVzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24ocmVhc29uKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlYXNvbik7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tY29uc29sZVxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaXNMb2FkaW5nQ29tcGFuaWVzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAkc2NvcGUuc2hvd0RpYWxvZyA9IGZ1bmN0aW9uKGNvbXBhbnkpIHtcblxuICAgICAgICAgICAgaWYgKGNvbXBhbnkuc3RhdHVzID09PSAnQWd1YXJkYW5kbyBhcHJvdmHDp8OjbycpXG4gICAgICAgICAgICAgICAgJG1kRGlhbG9nLnNob3coe1xuICAgICAgICAgICAgICAgICAgICAnY29udHJvbGxlcicgICAgICAgICAgOiAnTWFuYWdlQ29tcGFueUNvbnRyb2xsZXInLFxuICAgICAgICAgICAgICAgICAgICAndGVtcGxhdGVVcmwnICAgICAgICAgOiAnYXBwL3NoYXJlZC90ZW1wbGF0ZXMvbW9kYWxzL2NvbXBhbnktZGlhbG9nLmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICAncGFyZW50JyAgICAgICAgICAgICAgOiBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQuYm9keSksXG4gICAgICAgICAgICAgICAgICAgICdsb2NhbHMnICAgICAgICAgICAgICA6IHsgJ2NvbXBhbnknOiBjb21wYW55IH0sXG4gICAgICAgICAgICAgICAgICAgICdjbGlja091dHNpZGVUb0Nsb3NlJyA6IHRydWVcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUuc2VhcmNoID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgICAgIGdldENvbXBhbmllcyhuYW1lKTtcbiAgICAgICAgfTtcblxuICAgICAgICAoZnVuY3Rpb24gaW5pdCgpIHtcblxuICAgICAgICAgICAgJHNjb3BlLmNvbXBhbnlTZWxlY3RlZCA9IFtdO1xuICAgICAgICAgICAgZ2V0Q29tcGFuaWVzKCk7XG4gICAgICAgIH0oKSk7XG4gICAgfVxufSgpKTtcbiIsIihmdW5jdGlvbigpIHtcblxuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdhZnJtQXBwJykuY29udHJvbGxlcignSG9tZUNvbnRyb2xsZXInLCBIb21lQ29udHJvbGxlcik7XG5cbiAgICBIb21lQ29udHJvbGxlci4kaW5qZWN0ID0gWyAnJHNjb3BlJyBdO1xuXG4gICAgZnVuY3Rpb24gSG9tZUNvbnRyb2xsZXIoJHNjb3BlKSB7XG5cbiAgICAgICAgJHNjb3BlLmFwcHJvdmVTb2xpY2l0YXRpb24gPSAgZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUuaW5zZXJ0U29saWNpdGF0aW9uID0gZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgfTtcbiAgICB9XG59KCkpO1xuIiwiKGZ1bmN0aW9uKCkge1xuXG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ2Fmcm1BcHAnKS5jb250cm9sbGVyKCdJbnRlcm5zaGlwc0NvbnRyb2xsZXInLCBJbnRlcm5zaGlwc0NvbnRyb2xsZXIpO1xuXG4gICAgSW50ZXJuc2hpcHNDb250cm9sbGVyLiRpbmplY3QgPSBbICckc2NvcGUnLCAnJG1kRGlhbG9nJywgJ2ludGVybnNoaXBzU2VydmljZScgXTtcblxuICAgIGZ1bmN0aW9uIEludGVybnNoaXBzQ29udHJvbGxlcigkc2NvcGUsICRtZERpYWxvZywgaW50ZXJuc2hpcHNTZXJ2aWNlKSB7XG5cbiAgICAgICAgJHNjb3BlLmFwcHJvdmVJbnRlcm5zaGlwRGlhbG9nID0gZnVuY3Rpb24oaW50ZXJuc2hpcCwgY3JlZGVudGlhbCwgZXYpIHtcbiAgICAgICAgICAgIGlmIChpbnRlcm5zaGlwLnN0YXR1cyA9PT0gJ0FndWFyZGFuZG8gYXByb3Zhw6fDo28nICYmICgkc2NvcGUuY3JlZGVudGlhbC5yb2xlID09PSAnY29vcmRpbmF0b3InIHx8ICRzY29wZS5jcmVkZW50aWFsLnJvbGUgPT09ICdzdHVkZW50JykpXG4gICAgICAgICAgICAgICAgJG1kRGlhbG9nLnNob3coe1xuICAgICAgICAgICAgICAgICAgICAnY29udHJvbGxlcicgICAgICAgICAgOiAnQXBwcm92ZUludGVybnNoaXBEaWFsb2dDb250cm9sbGVyJyxcbiAgICAgICAgICAgICAgICAgICAgJ3RlbXBsYXRlVXJsJyAgICAgICAgIDogJ2FwcC9zaGFyZWQvdGVtcGxhdGVzL21vZGFscy9hcHByb3ZlLWludGVybnNoaXAtZGlhbG9nLmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICAnbG9jYWxzJyAgICAgICAgICAgICAgOiB7ICdpbnRlcm5zaGlwJzogaW50ZXJuc2hpcCB8fCB7fSwgJ2NyZWRlbnRpYWwnOiBjcmVkZW50aWFsIH0sXG4gICAgICAgICAgICAgICAgICAgICdwYXJlbnQnICAgICAgICAgICAgICA6IGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5ib2R5KSxcbiAgICAgICAgICAgICAgICAgICAgJ3RhcmdldEV2ZW50JyAgICAgICAgIDogZXYsXG4gICAgICAgICAgICAgICAgICAgICdjbGlja091dHNpZGVUb0Nsb3NlJyA6IHRydWVcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUuaW50ZXJuc2hpcERpYWxvZyA9IGZ1bmN0aW9uIChpbnRlcm5zaGlwLCBldikge1xuICAgICAgICAgICAgJG1kRGlhbG9nLnNob3coe1xuICAgICAgICAgICAgICAgICdjb250cm9sbGVyJyAgICAgICAgICA6ICdJbnRlcm5zaGlwRGlhbG9nQ29udHJvbGxlcicsXG4gICAgICAgICAgICAgICAgJ3RlbXBsYXRlVXJsJyAgICAgICAgIDogJ2FwcC9zaGFyZWQvdGVtcGxhdGVzL21vZGFscy9pbnRlcm5zaGlwLWRpYWxvZy5odG1sJyxcbiAgICAgICAgICAgICAgICAnbG9jYWxzJyAgICAgICAgICAgICAgOiB7ICdpbnRlcm5zaGlwJzogYW5ndWxhci5jb3B5KGludGVybnNoaXApIHx8IHt9IH0sXG4gICAgICAgICAgICAgICAgJ3BhcmVudCcgICAgICAgICAgICAgIDogYW5ndWxhci5lbGVtZW50KGRvY3VtZW50LmJvZHkpLFxuICAgICAgICAgICAgICAgICd0YXJnZXRFdmVudCcgICAgICAgICA6IGV2LFxuICAgICAgICAgICAgICAgICdjbGlja091dHNpZGVUb0Nsb3NlJyA6IHRydWVcbiAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24odXBkYXRlZEludGVybnNoaXApIHtcbiAgICAgICAgICAgICAgICB2YXIgaSA9IDA7XG5cbiAgICAgICAgICAgICAgICAvLyBhdHVhbGl6YSB0YWJlbGEgY29tIGFsdGVyYWNvZXMgcmVhbGl6YWRhcyBuYSBtb2RhbFxuICAgICAgICAgICAgICAgIGZvciAoaTsgaSA8ICRzY29wZS5pbnRlcm5zaGlwcy5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLmludGVybnNoaXBzW2ldLl9pZCA9PT0gdXBkYXRlZEludGVybnNoaXAuX2lkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaW50ZXJuc2hpcHNbaV0gPSB1cGRhdGVkSW50ZXJuc2hpcDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUuc2VhcmNoID0gZnVuY3Rpb24ocXVlcnkpIHtcbiAgICAgICAgICAgIHZhciBxID0geydjcmVkZW50aWFsSWQnOiAkc2NvcGUuY3JlZGVudGlhbC5faWR9O1xuXG4gICAgICAgICAgICBpZiAocXVlcnkubmFtZSlcbiAgICAgICAgICAgICAgICBxLm5hbWUgPSBxdWVyeS5uYW1lLnRyaW0oKTtcblxuICAgICAgICAgICAgaWYgKHF1ZXJ5LnN0YXR1cyAmJiBxdWVyeS5zdGF0dXMudHJpbSgpICE9PSAnVG9kb3MnKVxuICAgICAgICAgICAgICAgIHEuc3RhdHVzID0gcXVlcnkuc3RhdHVzLnRyaW0oKTtcblxuICAgICAgICAgICAgaW50ZXJuc2hpcHNTZXJ2aWNlLmdldChxKVxuICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKGludGVybnNoaXBzKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5pbnRlcm5zaGlwcyA9IGludGVybnNoaXBzO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uKHJlYXNvbikge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZWFzb24pOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLWNvbnNvbGVcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICAoZnVuY3Rpb24gaW5pdCgpIHtcbiAgICAgICAgICAgIHZhciBxdWVyeSA9IHt9O1xuXG4gICAgICAgICAgICAkc2NvcGUucXVlcnkgPSB7fTtcblxuICAgICAgICAgICAgJHNjb3BlLnN0YXR1cyA9IFsnVG9kb3MnLCAnRW0gYW5kYW1lbnRvJywgJ1JlcHJvdmFkbycsICdDYW5jZWxhZG8nLCAnQWd1YXJkYW5kbyBhcHJvdmHDp8OjbycsICdGaW5hbGl6YWRvJ107XG5cbiAgICAgICAgICAgICRzY29wZS5jcmVkZW50aWFsID0gSlNPTi5wYXJzZSh3aW5kb3cubG9jYWxTdG9yYWdlLmdldEl0ZW0oJ0NSRURFTlRJQUwnKSkgfHwge307XG5cbiAgICAgICAgICAgICRzY29wZS5pc1N0dWRlbnQgPSAkc2NvcGUuY3JlZGVudGlhbC5yb2xlID09PSAnc3R1ZGVudCcgPyB0cnVlIDogZmFsc2U7XG5cbiAgICAgICAgICAgIHF1ZXJ5ID0geydjcmVkZW50aWFsSWQnOiAkc2NvcGUuY3JlZGVudGlhbC5faWR9O1xuXG4gICAgICAgICAgICAkc2NvcGUuaXNMb2FkaW5nSW50ZXJuc2hpcHMgPSB0cnVlO1xuXG4gICAgICAgICAgICBpbnRlcm5zaGlwc1NlcnZpY2UuZ2V0KHF1ZXJ5KVxuICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKGludGVybnNoaXBzKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5pbnRlcm5zaGlwcyA9IGludGVybnNoaXBzO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaXNMb2FkaW5nSW50ZXJuc2hpcHMgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbihyZWFzb24pIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVhc29uKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1jb25zb2xlXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5pc0xvYWRpbmdJbnRlcm5zaGlwcyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH0oKSk7XG4gICAgfVxufSgpKTtcbiIsIihmdW5jdGlvbigpIHtcblxuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdhZnJtQXBwJykuY29udHJvbGxlcignTG9naW5Db250cm9sbGVyJywgTG9naW5Db250cm9sbGVyKTtcblxuICAgIExvZ2luQ29udHJvbGxlci4kaW5qZWN0ID0gWyAnJHNjb3BlJywgJ2NyZWRlbnRpYWxzU2VydmljZScsICckbG9jYXRpb24nLCAnJHJvb3RTY29wZScgXTtcblxuICAgIGZ1bmN0aW9uIExvZ2luQ29udHJvbGxlcigkc2NvcGUsIGNyZWRlbnRpYWxzU2VydmljZSwgJGxvY2F0aW9uLCAkcm9vdFNjb3BlKSB7XG5cbiAgICAgICAgJHNjb3BlLmxvZ2luID0gZnVuY3Rpb24oZW1haWwsIHBhc3MpIHtcbiAgICAgICAgICAgIHZhciBjcmVkZW50aWFsID0ge1xuICAgICAgICAgICAgICAgICdlbWFpbCc6IGVtYWlsLFxuICAgICAgICAgICAgICAgICdwYXNzd29yZCc6IHBhc3NcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICRzY29wZS5pc0xvYWRpbmcgPSB0cnVlO1xuXG4gICAgICAgICAgICBjcmVkZW50aWFsc1NlcnZpY2UubG9naW4oY3JlZGVudGlhbClcbiAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoY3JlZGVudGlhbCkge1xuXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5pc0xvYWRpbmcgPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoY3JlZGVudGlhbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5zZXRJdGVtKCdDUkVERU5USUFMJywgSlNPTi5zdHJpbmdpZnkoY3JlZGVudGlhbCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5jcmVkZW50aWFsID0gY3JlZGVudGlhbDtcbiAgICAgICAgICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvc29saWNpdGFjb2VzJyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmlzV3JvbmdMb2dpbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24ocmVhc29uKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5pc0xvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVhc29uKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1jb25zb2xlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgKGZ1bmN0aW9uIGluaXQoKSB7XG5cbiAgICAgICAgfSgpKTtcbiAgICB9XG59KCkpO1xuIiwiKGZ1bmN0aW9uKCkge1xuXG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ2Fmcm1BcHAnKS5jb250cm9sbGVyKCdSZWdpc3RlckNvbnRyb2xsZXInLCBSZWdpc3RlckNvbnRyb2xsZXIpO1xuXG4gICAgUmVnaXN0ZXJDb250cm9sbGVyLiRpbmplY3QgPSBbICckc2NvcGUnLCAnY3JlZGVudGlhbHNTZXJ2aWNlJywgJyRsb2NhdGlvbicsICckbWRUb2FzdCcsICckdGltZW91dCcgXTtcblxuICAgIGZ1bmN0aW9uIFJlZ2lzdGVyQ29udHJvbGxlcigkc2NvcGUsIGNyZWRlbnRpYWxzU2VydmljZSwgJGxvY2F0aW9uLCAkbWRUb2FzdCwgJHRpbWVvdXQpIHtcblxuICAgICAgICAkc2NvcGUuY3JlYXRlQWNjb3VudCA9IGZ1bmN0aW9uKHVzcikge1xuICAgICAgICAgICAgY3JlZGVudGlhbHNTZXJ2aWNlLmNyZWF0ZSh1c3IpXG4gICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRtZFRvYXN0LnNob3coXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJG1kVG9hc3Quc2ltcGxlKClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRleHRDb250ZW50KCdVc3XDoXJpbyBjcmlhZG8gY29tIHN1Y2Vzc28nKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAucG9zaXRpb24oJ2JvdHRvbScpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5oaWRlRGVsYXkoMzAwMClcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkbG9jYXRpb24oJy9sb2dpbicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSwgMzAwMCk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uKHJlYXNvbikge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZWFzb24pOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLWNvbnNvbGVcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgIH1cbn0oKSk7XG4iLCIoZnVuY3Rpb24oKSB7XG5cbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnYWZybUFwcCcpLmNvbnRyb2xsZXIoJ0xvZ3NDb250cm9sbGVyJywgTG9nc0NvbnRyb2xsZXIpO1xuXG4gICAgTG9nc0NvbnRyb2xsZXIuJGluamVjdCA9IFsgJyRzY29wZScsICdsb2dzU2VydmljZScgXTtcblxuICAgIGZ1bmN0aW9uIExvZ3NDb250cm9sbGVyKCRzY29wZSwgbG9nc1NlcnZpY2UpIHtcblxuICAgICAgICAoZnVuY3Rpb24gaW5pdCgpIHtcblxuICAgICAgICAgICAgJHNjb3BlLnRhYmxlUGFyYW1zID0ge1xuICAgICAgICAgICAgICAgICdsaW1pdCc6IDUsXG4gICAgICAgICAgICAgICAgJ3BhZ2UnOiAxXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAkc2NvcGUuaXNMb2FkaW5nTG9ncyA9IHRydWU7XG4gICAgICAgICAgXG4gICAgICAgICAgICBsb2dzU2VydmljZS5nZXQoKVxuICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKGxvZ3MpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmxvZ3MgPSBsb2dzO1xuXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5pc0xvYWRpbmdMb2dzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS50YWJsZVBhcmFtcy50b3RhbCA9IGxvZ3MubGVuZ3RoO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uKHJlYXNvbikge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaXNMb2FkaW5nTG9ncyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZWFzb24pOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLWNvbnNvbGVcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICB9KCkpO1xuICAgIH1cbn0oKSk7XG4iLCIoZnVuY3Rpb24oKSB7XG5cbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnYWZybUFwcCcpLmNvbnRyb2xsZXIoJ1NvbGljaXRhdGlvbkNvbnRyb2xsZXInLCBTb2xpY2l0YXRpb25Db250cm9sbGVyKTtcblxuICAgIFNvbGljaXRhdGlvbkNvbnRyb2xsZXIuJGluamVjdCA9IFsgJyRzY29wZScgXTtcblxuICAgIGZ1bmN0aW9uIFNvbGljaXRhdGlvbkNvbnRyb2xsZXIoJHNjb3BlKSB7XG5cbiAgICAgICAgJHNjb3BlLmFwcHJvdmVTb2xpY2l0YXRpb24gPSAgZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUuaW5zZXJ0U29saWNpdGF0aW9uID0gZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgfTtcblxuICAgICAgICAoZnVuY3Rpb24gaW5pdCgpIHtcbiAgICAgICAgfSgpKTtcblxuICAgIH1cbn0oKSk7XG4iLCIoZnVuY3Rpb24gKCkge1xuXG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgZnVuY3Rpb24gQ29tcGFuaWVzU2VydmljZSgkaHR0cCwgJHJvb3RTY29wZSkge1xuXG4gICAgICAgIHZhciBtb2R1bGUgPSAnY29tcGFuaWVzJztcblxuICAgICAgICB0aGlzLmNyZWF0ZSA9IGZ1bmN0aW9uIChjb21wYW55KSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdCgkcm9vdFNjb3BlLnNlcnZlclVybCArIG1vZHVsZSwgY29tcGFueSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpcy51cGRhdGUgPSBmdW5jdGlvbiAoY29tcGFueSkge1xuICAgICAgICAgICAgY29tcGFueS5jaGFuZ2VyID0gSlNPTi5wYXJzZSh3aW5kb3cubG9jYWxTdG9yYWdlLmdldEl0ZW0oJ0NSRURFTlRJQUwnKSkuX2lkO1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLnB1dCgkcm9vdFNjb3BlLnNlcnZlclVybCArIG1vZHVsZSwgY29tcGFueSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpcy5nZXQgPSBmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICAgICAgdmFyIHVybCA9ICRyb290U2NvcGUuc2VydmVyVXJsICsgbW9kdWxlO1xuXG4gICAgICAgICAgICBpZiAobmFtZSlcbiAgICAgICAgICAgICAgICB1cmwgPSB1cmwgKyAnLycgKyBuYW1lO1xuXG4gICAgICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KHVybCk7XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgQ29tcGFuaWVzU2VydmljZS4kaW5qZWN0ID0gWyAnJGh0dHAnLCAnJHJvb3RTY29wZScgXTtcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdhZnJtQXBwJykuc2VydmljZSgnY29tcGFuaWVzU2VydmljZScsIENvbXBhbmllc1NlcnZpY2UpO1xuXG59KCkpOyIsIihmdW5jdGlvbiAoKSB7XG5cbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBmdW5jdGlvbiBDcmVkZW50aWFsc1NlcnZpY2UoJGh0dHAsICRyb290U2NvcGUpIHtcblxuICAgICAgICB2YXIgbW9kdWxlID0gJ2NyZWRlbnRpYWxzJztcblxuICAgICAgICB0aGlzLmxvZ2luID0gZnVuY3Rpb24gKGNyZWRlbnRpYWwpIHtcbiAgICAgICAgICAgIHZhciBxdWVyeXN0cmluZyA9ICc/ZW1haWw9JyArIGNyZWRlbnRpYWwuZW1haWwgKyAnJnBhc3N3b3JkPScgKyBjcmVkZW50aWFsLnBhc3N3b3JkO1xuXG4gICAgICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KCRyb290U2NvcGUuc2VydmVyVXJsICsgbW9kdWxlICsgJy8nICsgcXVlcnlzdHJpbmcpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHRoaXMuY3JlYXRlID0gIGZ1bmN0aW9uKHVzcikge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLnBvc3QoJHJvb3RTY29wZS5zZXJ2ZXJVcmwgKyBtb2R1bGUsIHVzcik7XG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpcy5sb2dvdXQgPSBmdW5jdGlvbiAodG9rZW4pIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQoJHJvb3RTY29wZS5zZXJ2ZXJVcmwgKyBtb2R1bGUgKyAnLycgKyB0b2tlbik7XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgQ3JlZGVudGlhbHNTZXJ2aWNlLiRpbmplY3QgPSBbICckaHR0cCcsICckcm9vdFNjb3BlJyBdO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ2Fmcm1BcHAnKS5zZXJ2aWNlKCdjcmVkZW50aWFsc1NlcnZpY2UnLCBDcmVkZW50aWFsc1NlcnZpY2UpO1xuXG59KCkpOyIsIihmdW5jdGlvbiAoKSB7XG5cbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBmdW5jdGlvbiBJbnRlcm5zaGlwc1NlcnZpY2UoJGh0dHAsICRyb290U2NvcGUpIHtcblxuICAgICAgICB2YXIgbW9kdWxlID0gJ2ludGVybnNoaXBzJztcblxuICAgICAgICB0aGlzLmdldCA9IGZ1bmN0aW9uIChxdWVyeSkge1xuICAgICAgICAgICAgdmFyIHVybCA9ICRyb290U2NvcGUuc2VydmVyVXJsICsgbW9kdWxlICsgJy8/JztcblxuICAgICAgICAgICAgaWYgKHF1ZXJ5LmNyZWRlbnRpYWxJZClcbiAgICAgICAgICAgICAgICB1cmwgKz0gJ2NyZWRlbnRpYWxJZD0nICsgcXVlcnkuY3JlZGVudGlhbElkO1xuXG4gICAgICAgICAgICBpZiAocXVlcnkuc3RhdHVzKVxuICAgICAgICAgICAgICAgIHVybCArPSAnJnN0YXR1cz0nICsgcXVlcnkuc3RhdHVzO1xuXG4gICAgICAgICAgICBpZiAocXVlcnkubmFtZSlcbiAgICAgICAgICAgICAgICB1cmwgKz0gJyZuYW1lPScgKyBxdWVyeS5uYW1lO1xuXG4gICAgICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KHVybCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpcy51cGRhdGUgPSBmdW5jdGlvbiAoaW50ZXJuc2hpcCkge1xuICAgICAgICAgICAgaW50ZXJuc2hpcC5jaGFuZ2VyID0gSlNPTi5wYXJzZSh3aW5kb3cubG9jYWxTdG9yYWdlLmdldEl0ZW0oJ0NSRURFTlRJQUwnKSkuX2lkO1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLnB1dCgkcm9vdFNjb3BlLnNlcnZlclVybCArIG1vZHVsZSwgaW50ZXJuc2hpcCk7XG4gICAgICAgIH07XG5cbiAgICB9XG5cbiAgICBJbnRlcm5zaGlwc1NlcnZpY2UuJGluamVjdCA9IFsgJyRodHRwJywgJyRyb290U2NvcGUnIF07XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnYWZybUFwcCcpLnNlcnZpY2UoJ2ludGVybnNoaXBzU2VydmljZScsIEludGVybnNoaXBzU2VydmljZSk7XG5cbn0oKSk7IiwiKGZ1bmN0aW9uICgpIHtcblxuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGZ1bmN0aW9uIExvZ3NTZXJ2aWNlKCRodHRwLCAkcm9vdFNjb3BlKSB7XG5cbiAgICAgICAgdmFyIG1vZHVsZSA9ICdsb2dzJztcblxuICAgICAgICB0aGlzLmdldCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQoJHJvb3RTY29wZS5zZXJ2ZXJVcmwgKyBtb2R1bGUpO1xuICAgICAgICB9O1xuXG4gICAgfVxuXG4gICAgTG9nc1NlcnZpY2UuJGluamVjdCA9IFsgJyRodHRwJywgJyRyb290U2NvcGUnIF07XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnYWZybUFwcCcpLnNlcnZpY2UoJ2xvZ3NTZXJ2aWNlJywgTG9nc1NlcnZpY2UpO1xuXG59KCkpOyIsIihmdW5jdGlvbiAoKSB7XG5cbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBmdW5jdGlvbiBBcHByb3ZlSW50ZXJuc2hpcERpYWxvZ0NvbnRyb2xsZXIoJHNjb3BlLCAkbWREaWFsb2csIGludGVybnNoaXBzU2VydmljZSwgbG9jYWxzKSB7XG5cbiAgICAgICAgZnVuY3Rpb24gdXBkYXRlSW50ZXJuc2hpcCgpIHtcbiAgICAgICAgICAgICRzY29wZS5pc1NhdmluZyA9IHRydWU7XG5cbiAgICAgICAgICAgIGludGVybnNoaXBzU2VydmljZS51cGRhdGUoJHNjb3BlLmludGVybnNoaXApXG4gICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5pc1NhdmluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAkbWREaWFsb2cuaGlkZSgkc2NvcGUuaW50ZXJuc2hpcCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24ocmVhc29uKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlYXNvbik7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tY29uc29sZVxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaXNTYXZpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgJG1kRGlhbG9nLmhpZGUoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgICRzY29wZS5zYXZlID0gZnVuY3Rpb24oaXNBcHByb3ZlKSB7XG5cbiAgICAgICAgICAgIGlmIChpc0FwcHJvdmUgJiYgJHNjb3BlLmNyZWRlbnRpYWwucm9sZSA9PT0gJ2Nvb3JkaW5hdG9yJykge1xuICAgICAgICAgICAgICAgICRzY29wZS5pbnRlcm5zaGlwLnN0YXR1cyA9ICdFbSBhbmRhbWVudG8nO1xuICAgICAgICAgICAgICAgICRzY29wZS5pbnRlcm5zaGlwLmJlZ2luICA9IG1vbWVudCgpLmZvcm1hdCgnREQvTU0vWVlZWScpO1xuICAgICAgICAgICAgICAgICRzY29wZS5pbnRlcm5zaGlwLmVuZCAgICA9IG1vbWVudChtb21lbnQoKSkuYWRkKDYsICdtb250aHMnKS5mb3JtYXQoJ0REL01NL1lZWVknKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKCFpc0FwcHJvdmUgJiYgJHNjb3BlLmNyZWRlbnRpYWwucm9sZSA9PT0gJ2Nvb3JkaW5hdG9yJylcbiAgICAgICAgICAgICAgICAkc2NvcGUuaW50ZXJuc2hpcC5zdGF0dXMgPSAnUmVwcm92YWRvJztcblxuICAgICAgICAgICAgZWxzZSBpZiAoIWlzQXBwcm92ZSAmJiAkc2NvcGUuY3JlZGVudGlhbC5yb2xlID09PSAnc3R1ZGVudCcpXG4gICAgICAgICAgICAgICAgJHNjb3BlLmludGVybnNoaXAuc3RhdHVzID0gJ0NhbmNlbGFkbyc7XG5cbiAgICAgICAgICAgIHVwZGF0ZUludGVybnNoaXAoKTtcbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUuY2xvc2VEaWFsb2cgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICRtZERpYWxvZy5jYW5jZWwoKTtcbiAgICAgICAgfTtcblxuICAgICAgICAoZnVuY3Rpb24gaW5pdCgpIHtcbiAgICAgICAgICAgICRzY29wZS5pbnRlcm5zaGlwID0gbG9jYWxzLmludGVybnNoaXAgfHwge307XG4gICAgICAgICAgICAkc2NvcGUuY3JlZGVudGlhbCA9IGxvY2Fscy5jcmVkZW50aWFsIHx8IHt9O1xuICAgICAgICB9KSgpO1xuICAgIH1cblxuICAgIEFwcHJvdmVJbnRlcm5zaGlwRGlhbG9nQ29udHJvbGxlci4kaW5qZWN0ID0gWyAnJHNjb3BlJywgJyRtZERpYWxvZycsICdpbnRlcm5zaGlwc1NlcnZpY2UnLCAnbG9jYWxzJyBdO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ2Fmcm1BcHAnKS5jb250cm9sbGVyKCdBcHByb3ZlSW50ZXJuc2hpcERpYWxvZ0NvbnRyb2xsZXInLCBBcHByb3ZlSW50ZXJuc2hpcERpYWxvZ0NvbnRyb2xsZXIpO1xuXG59KCkpOyIsIihmdW5jdGlvbiAoKSB7XG5cbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBmdW5jdGlvbiBNYW5hZ2VDb21wYW55Q29udHJvbGxlcigkc2NvcGUsICRtZERpYWxvZywgY29tcGFuaWVzU2VydmljZSwgbG9jYWxzKSB7XG5cbiAgICAgICAgJHNjb3BlLnNhdmUgPSBmdW5jdGlvbihjb21wYW55LCBzdGF0dXMpIHtcblxuICAgICAgICAgICAgJHNjb3BlLmlzTG9hZGluZ0NvbXBhbnkgPSB0cnVlO1xuXG4gICAgICAgICAgICBpZiAoc3RhdHVzID09PSB0cnVlKVxuICAgICAgICAgICAgICAgIGNvbXBhbnkuc3RhdHVzID0gJ0Fwcm92YWRvJztcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICBjb21wYW55LnN0YXR1cyA9ICdSZXByb3ZhZG8nO1xuXG5cbiAgICAgICAgICAgIGNvbXBhbmllc1NlcnZpY2UudXBkYXRlKGNvbXBhbnkpXG4gICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaXNMb2FkaW5nQ29tcGFueSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAkbWREaWFsb2cuaGlkZShjb21wYW55KTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAocmVhc29uKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5pc0xvYWRpbmdDb21wYW55ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlYXNvbik7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tY29uc29sZVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH07XG5cbiAgICAgICAgJHNjb3BlLmNsb3NlRGlhbG9nID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkbWREaWFsb2cuY2FuY2VsKCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgKGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICAgICAgICAkc2NvcGUuY29tcGFueSA9IGxvY2Fscy5jb21wYW55IHx8IHt9O1xuICAgICAgICB9KSgpO1xuICAgIH1cblxuICAgIE1hbmFnZUNvbXBhbnlDb250cm9sbGVyLiRpbmplY3QgPSBbICckc2NvcGUnLCAnJG1kRGlhbG9nJywgJ2NvbXBhbmllc1NlcnZpY2UnLCAnbG9jYWxzJyBdO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ2Fmcm1BcHAnKS5jb250cm9sbGVyKCdNYW5hZ2VDb21wYW55Q29udHJvbGxlcicsIE1hbmFnZUNvbXBhbnlDb250cm9sbGVyKTtcblxufSgpKTsiLCIoZnVuY3Rpb24gKCkge1xuXG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgZnVuY3Rpb24gSW50ZXJuc2hpcERpYWxvZ0NvbnRyb2xsZXIoJHNjb3BlLCAkbWREaWFsb2csIGludGVybnNoaXBzU2VydmljZSwgbG9jYWxzKSB7XG5cbiAgICAgICAgJHNjb3BlLmNsb3NlRGlhbG9nID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkbWREaWFsb2cuY2FuY2VsKCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgJHNjb3BlLnVwZGF0ZSA9IGZ1bmN0aW9uIChpbnRlcm5zaGlwKSB7XG5cbiAgICAgICAgICAgIGludGVybnNoaXAuYmVnaW4gPSBtb21lbnQoaW50ZXJuc2hpcC5iZWdpbiwgJ0REL01NL1lZWVknKTtcbiAgICAgICAgICAgIGludGVybnNoaXAuYmVnaW4gPSBtb21lbnQoaW50ZXJuc2hpcC5iZWdpbikuZm9ybWF0KCdERC9NTS9ZWVlZJyk7XG5cbiAgICAgICAgICAgIGludGVybnNoaXBzU2VydmljZS51cGRhdGUoaW50ZXJuc2hpcClcbiAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbihyZXN1bHQpIHtcblxuICAgICAgICAgICAgICAgICAgICAkbWREaWFsb2cuaGlkZShpbnRlcm5zaGlwKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbihyZWFzb24pIHtcblxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9OyAgXG5cbiAgICAgICAgKGZ1bmN0aW9uIGluaXQoKSB7XG5cbiAgICAgICAgICAgIHZhciByb2xlID0gSlNPTi5wYXJzZSh3aW5kb3cubG9jYWxTdG9yYWdlLmdldEl0ZW0oJ0NSRURFTlRJQUwnKSkucm9sZTsgXG5cbiAgICAgICAgICAgICRzY29wZS5pbnRlcm5zaGlwID0gbG9jYWxzLmludGVybnNoaXAgfHwge307XG5cbiAgICAgICAgICAgICRzY29wZS5pc0VkaXRhYmxlID0gcm9sZSA9PT0gJ3N0dWRlbnQnICYmICRzY29wZS5pbnRlcm5zaGlwICYmICRzY29wZS5pbnRlcm5zaGlwLnN0YXR1cyA9PT0gJ0FndWFyZGFuZG8gYXByb3Zhw6fDo28nO1xuXG4gICAgICAgIH0pKCk7XG4gICAgfVxuXG4gICAgSW50ZXJuc2hpcERpYWxvZ0NvbnRyb2xsZXIuJGluamVjdCA9IFsgJyRzY29wZScsICckbWREaWFsb2cnLCAnaW50ZXJuc2hpcHNTZXJ2aWNlJywgJ2xvY2FscycgXTtcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdhZnJtQXBwJykuY29udHJvbGxlcignSW50ZXJuc2hpcERpYWxvZ0NvbnRyb2xsZXInLCBJbnRlcm5zaGlwRGlhbG9nQ29udHJvbGxlcik7XG5cbn0oKSk7Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
