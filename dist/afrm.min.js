!function(){"use strict";angular.module("afrmApp",["ngMaterial","ngAnimate","ngRoute","angular.filter","md.data.table"]).config(["$mdThemingProvider","$mdDateLocaleProvider",function(n,e){e.formatDate=function(n){return moment(n).format("YYYY-MM-DD")},n.theme("forest").primaryPalette("blue").accentPalette("teal").warnPalette("red").backgroundPalette("grey")}])}(),function(){"use strict";function n(n,e,t){e.serverUrl="https://dev-sistemas-server.herokuapp.com/",n.menu=function(n){t.path(n)},e.$on("$routeChangeSuccess",function(){"/empresas"===t.path()?n.currentMenuIndex=1:"/solicitacao"===t.path()?n.currentMenuIndex=0:"/estagios"===t.path()?n.currentMenuIndex=2:n.currentMenuIndex=-1,e.isLogin="/login"===t.path()})}n.$inject=["$scope","$rootScope","$location"],angular.module("afrmApp").controller("MainController",n)}(),function(){"use strict";function n(n,e){n.when("/login",{templateUrl:"app/components/login/login.html",controller:"LoginController"}).when("/solicitacao",{templateUrl:"app/components/solicitation/solicitation.html",controller:"SolicitationController"}).when("/empresas",{templateUrl:"app/components/companies/companies.html",controller:"CompaniesController"}).when("/estagios",{templateUrl:"app/components/internships/internships.html",controller:"InternshipsController"}).when("/registro",{templateUrl:"app/components/login/register.html",controller:"RegisterController"}).otherwise({redirectTo:"/login"}),e.html5Mode(!0)}angular.module("afrmApp").config(["$routeProvider","$locationProvider",n])}(),function(){"use strict";angular.module("afrmApp").factory("Users",function(){var n={};return n.all=function(){},n})}(),function(){"use strict";function n(n,e,t){n.showDialog=function(t){e.show({controller:"ManageCompanyController",templateUrl:"app/shared/templates/modals/manage-company.html",parent:angular.element(document.body),locals:{company:t||null},clickOutsideToClose:!0}).then(function(e,t){e&&(t?n.companies.push(e):n.companies.forEach(function(n){n._id===e._id&&(n=e)}))},function(){})},function(){t.get().success(function(e){n.companies=e}).error(function(n){console.log(n)})}()}angular.module("afrmApp").controller("CompaniesController",n),n.$inject=["$scope","$mdDialog","companiesService"]}(),function(){"use strict";function n(n){n.approveSolicitation=function(){},n.insertSolicitation=function(){}}angular.module("afrmApp").controller("HomeController",n),n.$inject=["$scope"]}(),function(){"use strict";function n(n,e,t){n.showDialog=function(t,o){"Aguardando aprovação"!==t.status||"coordinator"!==n.credential.role&&"student"!==n.credential.role||e.show({controller:"InternshipDialogController",templateUrl:"app/shared/templates/modals/internship-dialog.html",parent:angular.element(document.body),locals:{internship:t||{},credential:o},clickOutsideToClose:!0})},n.search=function(e){var o={credentialId:n.credential._id};e.name&&(o.name=e.name.trim()),e.status&&"Todos"!==e.status.trim()&&(o.status=e.status.trim()),t.get(o).success(function(e){n.internships=e}).error(function(n){console.log(n)})},function(){var e={};n.query={},n.status=["Todos","Em andamento","Reprovado","Cancelado","Aguardando aprovação","Finalizado"],n.credential=JSON.parse(window.localStorage.getItem("CREDENTIAL")),n.isStudent="student"===n.credential.role,e={credentialId:n.credential._id},t.get(e).success(function(e){n.internships=e}).error(function(n){console.log(n)})}()}angular.module("afrmApp").controller("InternshipsController",n),n.$inject=["$scope","$mdDialog","internshipsService"]}(),function(){"use strict";function n(n,e,t){n.login=function(n,o){var r={email:n,password:o};e.login(r).success(function(n){n&&(window.localStorage.setItem("CREDENTIAL",JSON.stringify(n)),t.path("/estagios"))}).error(function(n){console.log(n)})},function(){console.log("logincontroller")}()}angular.module("afrmApp").controller("LoginController",n),n.$inject=["$scope","credentialsService","$location"]}(),describe("Users factory",function(){var n;beforeEach(angular.mock.module("afrmApp")),beforeEach(inject(function(e){n=e})),it("should exist",function(){expect(n).toBeDefined()})}),function(){"use strict";function n(n,e,t,o,r){n.createAccount=function(n){e.create(n).success(function(n){n&&(o.show(o.simple().textContent("Usuário criado com sucesso").position("bottom").hideDelay(3e3)),r(function(){t("/login")},3e3))}).error(function(n){console.log(n)})}}angular.module("afrmApp").controller("RegisterController",n),n.$inject=["$scope","credentialsService","$location","$mdToast","$timeout"]}(),function(){"use strict";function n(n){n.approveSolicitation=function(){},n.insertSolicitation=function(){}}angular.module("afrmApp").controller("SolicitationController",n),n.$inject=["$scope"]}(),function(){"use strict";function n(n,e){var t="companies";this.create=function(o){return n.post(e.serverUrl+t,o)},this.update=function(o){return n.put(e.serverUrl+t,o)},this.get=function(){return n.get(e.serverUrl+t)}}n.$inject=["$http","$rootScope"],angular.module("afrmApp").service("companiesService",n)}(),function(){"use strict";function n(n,e){var t="credentials";this.login=function(o){var r="?email="+o.email+"&password="+o.password;return n.get(e.serverUrl+t+"/"+r)},this.create=function(o){return n.post(e.serverUrl+t,o)},this.logout=function(o){return n.get(e.serverUrl+t+"/"+o)}}n.$inject=["$http","$rootScope"],angular.module("afrmApp").service("credentialsService",n)}(),function(){"use strict";function n(n,e){var t="internships";this.get=function(o){var r=e.serverUrl+t+"/?";return o.credentialId&&(r+="credentialId="+o.credentialId),o.status&&(r+="&status="+o.status),o.name&&(r+="&name="+o.name),n.get(r)},this.update=function(o){return n.put(e.serverUrl+t,o)}}n.$inject=["$http","$rootScope"],angular.module("afrmApp").service("internshipsService",n)}(),function(){"use strict";function n(n,e,t,o){function r(){n.isSaving=!0,t.update(n.internship).success(function(){n.isSaving=!1,e.hide(n.internship)}).error(function(t){console.log(t),n.isSaving=!1,e.hide()})}n.save=function(e){e&&"coordinator"===n.credential.role?(n.internship.status="Em andamento",n.internship.begin=moment().format("DD/MM/YYYY"),n.internship.end=moment(moment()).add(6,"months").format("DD/MM/YYYY")):e||"coordinator"!==n.credential.role?e||"student"!==n.credential.role||(n.internship.status="Cancelado"):n.internship.status="Reprovado",r()},n.closeDialog=function(){e.cancel()},function(){n.internship=o.internship||{},n.credential=o.credential||{}}()}n.$inject=["$scope","$mdDialog","internshipsService","locals"],angular.module("afrmApp").controller("InternshipDialogController",n)}(),function(){"use strict";function n(n,e,t,o){n.save=function(o){var r;n.isLoadingCompany=!0,n.isEditing?(r=!1,t.update(o).success(function(t){n.isLoadingCompany=!1,e.hide(t,r)}).error(function(e){n.isLoadingCompany=!1,console.log(e)})):(r=!0,t.create(o).success(function(t){n.isLoadingCompany=!1,e.hide(t,r)}).error(function(e){n.isLoadingCompany=!1,console.log(e)}))},function(){o.company&&(n.isEditing=!0),n.company=o.company||{}}()}n.$inject=["$scope","$mdDialog","companiesService","locals"],angular.module("afrmApp").controller("ManageCompanyController",n)}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC1tb2R1bGUuanMiLCJhcHAtY29udHJvbGxlci5qcyIsImFwcC1yb3V0ZXMuanMiLCJzaGFyZWQvdXNlcnMuanMiLCJjb21wb25lbnRzL2NvbXBhbmllcy9jb21wYW5pZXMuY29udHJvbGxlci5qcyIsImNvbXBvbmVudHMvaG9tZS9ob21lLmNvbnRyb2xsZXIuanMiLCJjb21wb25lbnRzL2ludGVybnNoaXBzL2ludGVybnNoaXBzLmNvbnRyb2xsZXIuanMiLCJjb21wb25lbnRzL2xvZ2luL2xvZ2luLmNvbnRyb2xsZXIuanMiLCJjb21wb25lbnRzL2xvZ2luL2xvZ2luLnNwZWMuanMiLCJjb21wb25lbnRzL2xvZ2luL3JlZ2lzdGVyLmNvbnRyb2xsZXIuanMiLCJjb21wb25lbnRzL3NvbGljaXRhdGlvbi9zb2xpY2l0YXRpb24uY29udHJvbGxlci5qcyIsInNoYXJlZC9zZXJ2aWNlcy9jb21wYW5pZXMuc2VydmljZS5qcyIsInNoYXJlZC9zZXJ2aWNlcy9jcmVkZW50aWFscy5zZXJ2aWNlLmpzIiwic2hhcmVkL3NlcnZpY2VzL2ludGVybnNoaXBzLnNlcnZpY2UuanMiLCJzaGFyZWQvdGVtcGxhdGVzL21vZGFscy9pbnRlcm5zaGlwLmRpYWxvZy5jb250cm9sbGVyLmpzIiwic2hhcmVkL3RlbXBsYXRlcy9tb2RhbHMvbWFuYWdlLWNvbXBhbnkuY29udHJvbGxlci5qcyJdLCJuYW1lcyI6WyJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlnIiwiJG1kVGhlbWluZ1Byb3ZpZGVyIiwiJG1kRGF0ZUxvY2FsZVByb3ZpZGVyIiwiZm9ybWF0RGF0ZSIsImRhdGUiLCJtb21lbnQiLCJmb3JtYXQiLCJ0aGVtZSIsInByaW1hcnlQYWxldHRlIiwiYWNjZW50UGFsZXR0ZSIsIndhcm5QYWxldHRlIiwiYmFja2dyb3VuZFBhbGV0dGUiLCJNYWluQ29udHJvbGxlciIsIiRzY29wZSIsIiRyb290U2NvcGUiLCIkbG9jYXRpb24iLCJzZXJ2ZXJVcmwiLCJtZW51IiwicGF0aCIsIiRvbiIsImN1cnJlbnRNZW51SW5kZXgiLCJpc0xvZ2luIiwiJGluamVjdCIsImNvbnRyb2xsZXIiLCJBcHBsaWNhdGlvbkNvbmZpZyIsIiRyb3V0ZVByb3ZpZGVyIiwiJGxvY2F0aW9uUHJvdmlkZXIiLCJ3aGVuIiwidGVtcGxhdGVVcmwiLCJvdGhlcndpc2UiLCJyZWRpcmVjdFRvIiwiaHRtbDVNb2RlIiwiZmFjdG9yeSIsIlVzZXJzIiwiYWxsIiwiQ29tcGFuaWVzQ29udHJvbGxlciIsIiRtZERpYWxvZyIsImNvbXBhbmllc1NlcnZpY2UiLCJzaG93RGlhbG9nIiwiY29tcGFueSIsInNob3ciLCJwYXJlbnQiLCJlbGVtZW50IiwiZG9jdW1lbnQiLCJib2R5IiwibG9jYWxzIiwiY2xpY2tPdXRzaWRlVG9DbG9zZSIsInRoZW4iLCJpc05ld0NvbXBhbnkiLCJjb21wYW5pZXMiLCJwdXNoIiwiZm9yRWFjaCIsImNvbXAiLCJfaWQiLCJnZXQiLCJzdWNjZXNzIiwiZXJyb3IiLCJyZWFzb24iLCJjb25zb2xlIiwibG9nIiwiSG9tZUNvbnRyb2xsZXIiLCJhcHByb3ZlU29saWNpdGF0aW9uIiwiaW5zZXJ0U29saWNpdGF0aW9uIiwiSW50ZXJuc2hpcHNDb250cm9sbGVyIiwiaW50ZXJuc2hpcHNTZXJ2aWNlIiwiaW50ZXJuc2hpcCIsImNyZWRlbnRpYWwiLCJzdGF0dXMiLCJyb2xlIiwic2VhcmNoIiwicXVlcnkiLCJxIiwiY3JlZGVudGlhbElkIiwibmFtZSIsInRyaW0iLCJpbnRlcm5zaGlwcyIsIkpTT04iLCJwYXJzZSIsIndpbmRvdyIsImxvY2FsU3RvcmFnZSIsImdldEl0ZW0iLCJpc1N0dWRlbnQiLCJMb2dpbkNvbnRyb2xsZXIiLCJjcmVkZW50aWFsc1NlcnZpY2UiLCJsb2dpbiIsImVtYWlsIiwicGFzcyIsInBhc3N3b3JkIiwic2V0SXRlbSIsInN0cmluZ2lmeSIsImRlc2NyaWJlIiwiYmVmb3JlRWFjaCIsIm1vY2siLCJpbmplY3QiLCJfVXNlcnNfIiwiaXQiLCJleHBlY3QiLCJ0b0JlRGVmaW5lZCIsIlJlZ2lzdGVyQ29udHJvbGxlciIsIiRtZFRvYXN0IiwiJHRpbWVvdXQiLCJjcmVhdGVBY2NvdW50IiwidXNyIiwiY3JlYXRlIiwicmVzdWx0Iiwic2ltcGxlIiwidGV4dENvbnRlbnQiLCJwb3NpdGlvbiIsImhpZGVEZWxheSIsIlNvbGljaXRhdGlvbkNvbnRyb2xsZXIiLCJDb21wYW5pZXNTZXJ2aWNlIiwiJGh0dHAiLCJ0aGlzIiwicG9zdCIsInVwZGF0ZSIsInB1dCIsInNlcnZpY2UiLCJDcmVkZW50aWFsc1NlcnZpY2UiLCJxdWVyeXN0cmluZyIsImxvZ291dCIsInRva2VuIiwiSW50ZXJuc2hpcHNTZXJ2aWNlIiwidXJsIiwiSW50ZXJuc2hpcERpYWxvZ0NvbnRyb2xsZXIiLCJ1cGRhdGVJbnRlcm5zaGlwIiwiaXNTYXZpbmciLCJoaWRlIiwic2F2ZSIsImlzQXBwcm92ZSIsImJlZ2luIiwiZW5kIiwiYWRkIiwiY2xvc2VEaWFsb2ciLCJjYW5jZWwiLCJNYW5hZ2VDb21wYW55Q29udHJvbGxlciIsImlzTG9hZGluZ0NvbXBhbnkiLCJpc0VkaXRpbmciLCJjb21wYW55RWRpdGVkIiwibmV3Q29tcGFueSJdLCJtYXBwaW5ncyI6IkNBQUEsV0FDQSxZQUdBQSxTQUFBQyxPQUFBLFdBQ0EsYUFDQSxZQUNBLFVBQ0EsaUJBQ0Esa0JBR0FDLFFBQUEscUJBQUEsd0JBQUEsU0FBQUMsRUFBQUMsR0FHQUEsRUFBQUMsV0FBQSxTQUFBQyxHQUNBLE1BQUFDLFFBQUFELEdBQUFFLE9BQUEsZUFJQUwsRUFDQU0sTUFBQSxVQUNBQyxlQUFBLFFBQ0FDLGNBQUEsUUFDQUMsWUFBQSxPQUNBQyxrQkFBQSxjQ3pCQSxXQUNBLFlBV0EsU0FBQUMsR0FBQUMsRUFBQUMsRUFBQUMsR0FHQUQsRUFBQUUsVUFBQSw2Q0FFQUgsRUFBQUksS0FBQSxTQUFBQyxHQUNBSCxFQUFBRyxLQUFBQSxJQUdBSixFQUFBSyxJQUFBLHNCQUFBLFdBRUEsY0FBQUosRUFBQUcsT0FDQUwsRUFBQU8saUJBQUEsRUFFQSxp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RCxFQUFBb0QsV0FBQUUsT0FBQSxhQUhBdEQsRUFBQW9ELFdBQUFFLE9BQUEsWUFLQXlELEtBR0EvRyxFQUFBdUgsWUFBQSxXQUNBaEcsRUFBQWlHLFVBR0EsV0FDQXhILEVBQUFvRCxXQUFBcEIsRUFBQW9CLGVBQ0FwRCxFQUFBcUQsV0FBQXJCLEVBQUFxQixrQkFJQXlELEVBQUFyRyxTQUFBLFNBQUEsWUFBQSxxQkFBQSxVQUVBeEIsUUFBQUMsT0FBQSxXQUFBd0IsV0FBQSw2QkFBQW9HLE1DakRBLFdBRUEsWUFFQSxTQUFBVyxHQUFBekgsRUFBQXVCLEVBQUFDLEVBQUFRLEdBRUFoQyxFQUFBa0gsS0FBQSxTQUFBeEYsR0FDQSxHQUFBUyxFQUVBbkMsR0FBQTBILGtCQUFBLEVBR0ExSCxFQUFBMkgsV0FDQXhGLEdBQUEsRUFDQVgsRUFBQTZFLE9BQUEzRSxHQUNBZ0IsUUFBQSxTQUFBa0YsR0FDQTVILEVBQUEwSCxrQkFBQSxFQUNBbkcsRUFBQTBGLEtBQUFXLEVBQUF6RixLQUVBUSxNQUFBLFNBQUFDLEdBQ0E1QyxFQUFBMEgsa0JBQUEsRUFDQTdFLFFBQUFDLElBQUFGLE9BTUFULEdBQUEsRUFDQVgsRUFBQWtFLE9BQUFoRSxHQUNBZ0IsUUFBQSxTQUFBbUYsR0FDQTdILEVBQUEwSCxrQkFBQSxFQUNBbkcsRUFBQTBGLEtBQUFZLEVBQUExRixLQUVBUSxNQUFBLFNBQUFDLEdBQ0E1QyxFQUFBMEgsa0JBQUEsRUFDQTdFLFFBQUFDLElBQUFGLE9BS0EsV0FHQVosRUFBQU4sVUFDQTFCLEVBQUEySCxXQUFBLEdBRUEzSCxFQUFBMEIsUUFBQU0sRUFBQU4sZUFLQStGLEVBQUFoSCxTQUFBLFNBQUEsWUFBQSxtQkFBQSxVQUVBeEIsUUFBQUMsT0FBQSxXQUFBd0IsV0FBQSwwQkFBQStHIiwiZmlsZSI6ImFmcm0ubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICAvLyBNb2R1bGUgZGVwZW5kZW5jaWVzIGluamVjdGlvblxuICAgIGFuZ3VsYXIubW9kdWxlKCdhZnJtQXBwJywgW1xuICAgICAgICAnbmdNYXRlcmlhbCcsXG4gICAgICAgICduZ0FuaW1hdGUnLFxuICAgICAgICAnbmdSb3V0ZScsXG4gICAgICAgICdhbmd1bGFyLmZpbHRlcicsXG4gICAgICAgICdtZC5kYXRhLnRhYmxlJ1xuICAgIF0pXG5cbiAgICAgICAgLmNvbmZpZyhmdW5jdGlvbiAoJG1kVGhlbWluZ1Byb3ZpZGVyLCAkbWREYXRlTG9jYWxlUHJvdmlkZXIpIHtcblxuICAgICAgICAgICAgLy8gRGF0ZSBmb3JtYXQgY29uZmlndXJhdGlvblxuICAgICAgICAgICAgJG1kRGF0ZUxvY2FsZVByb3ZpZGVyLmZvcm1hdERhdGUgPSBmdW5jdGlvbihkYXRlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG1vbWVudChkYXRlKS5mb3JtYXQoJ1lZWVktTU0tREQnKTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIC8vIFRoZW1lIGNvbmZpZ3VyYXRpb25cbiAgICAgICAgICAgICRtZFRoZW1pbmdQcm92aWRlclxuICAgICAgICAgICAgICAgIC50aGVtZSgnZm9yZXN0JylcbiAgICAgICAgICAgICAgICAucHJpbWFyeVBhbGV0dGUoJ2JsdWUnKVxuICAgICAgICAgICAgICAgIC5hY2NlbnRQYWxldHRlKCd0ZWFsJylcbiAgICAgICAgICAgICAgICAud2FyblBhbGV0dGUoJ3JlZCcpXG4gICAgICAgICAgICAgICAgLmJhY2tncm91bmRQYWxldHRlKCdncmV5Jyk7XG4gICAgICAgIH0pO1xuXG59KCkpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICAvLyBpbmplY3RpbmcgZGVwZW5kZW5jaWVzXG4gICAgTWFpbkNvbnRyb2xsZXIuJGluamVjdCA9IFtcbiAgICAgICAgJyRzY29wZScsICckcm9vdFNjb3BlJywgJyRsb2NhdGlvbidcbiAgICBdO1xuXG4gICAgLy8gcmVnaXN0ZXJpbmcgb24gYW5ndWxhclxuICAgIGFuZ3VsYXIubW9kdWxlKCdhZnJtQXBwJykuY29udHJvbGxlcignTWFpbkNvbnRyb2xsZXInLCBNYWluQ29udHJvbGxlcik7XG5cbiAgICAvLyBNYWluIENvbnRyb2xsZXJcbiAgICBmdW5jdGlvbiBNYWluQ29udHJvbGxlcigkc2NvcGUsICRyb290U2NvcGUsICRsb2NhdGlvbikge1xuXG4gICAgICAgIC8vICRyb290U2NvcGUuc2VydmVyVXJsID0gJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMC8nO1xuICAgICAgICAkcm9vdFNjb3BlLnNlcnZlclVybCA9ICdodHRwczovL2Rldi1zaXN0ZW1hcy1zZXJ2ZXIuaGVyb2t1YXBwLmNvbS8nO1xuXG4gICAgICAgICRzY29wZS5tZW51ID0gZnVuY3Rpb24ocGF0aCkge1xuICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgocGF0aCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgJHJvb3RTY29wZS4kb24oJyRyb3V0ZUNoYW5nZVN1Y2Nlc3MnLCBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgIGlmICgkbG9jYXRpb24ucGF0aCgpID09PSAnL2VtcHJlc2FzJylcbiAgICAgICAgICAgICAgICAkc2NvcGUuY3VycmVudE1lbnVJbmRleCA9MTtcblxuICAgICAgICAgICAgZWxzZSBpZiAoJGxvY2F0aW9uLnBhdGgoKSA9PT0gJy9zb2xpY2l0YWNhbycpXG4gICAgICAgICAgICAgICAgJHNjb3BlLmN1cnJlbnRNZW51SW5kZXggPSAwO1xuXG4gICAgICAgICAgICBlbHNlIGlmICgkbG9jYXRpb24ucGF0aCgpID09PSAnL2VzdGFnaW9zJylcbiAgICAgICAgICAgICAgICAkc2NvcGUuY3VycmVudE1lbnVJbmRleCA9IDI7XG5cbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAkc2NvcGUuY3VycmVudE1lbnVJbmRleCA9IC0xO1xuXG4gICAgICAgICAgICAkcm9vdFNjb3BlLmlzTG9naW4gPSAkbG9jYXRpb24ucGF0aCgpID09PSAnL2xvZ2luJyA/IHRydWUgOiBmYWxzZTtcblxuICAgICAgICB9KTtcblxuICAgIH1cbn0oKSk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdhZnJtQXBwJykuY29uZmlnKFsnJHJvdXRlUHJvdmlkZXInLCAnJGxvY2F0aW9uUHJvdmlkZXInLCBBcHBsaWNhdGlvbkNvbmZpZ10pO1xuXG4gICAgZnVuY3Rpb24gQXBwbGljYXRpb25Db25maWcoJHJvdXRlUHJvdmlkZXIsICRsb2NhdGlvblByb3ZpZGVyKSB7XG4gICAgICAgICRyb3V0ZVByb3ZpZGVyXG5cbiAgICAgICAgICAgIC53aGVuKCcvbG9naW4nLCB7XG4gICAgICAgICAgICAgICAgJ3RlbXBsYXRlVXJsJyA6ICdhcHAvY29tcG9uZW50cy9sb2dpbi9sb2dpbi5odG1sJyxcbiAgICAgICAgICAgICAgICAnY29udHJvbGxlcicgIDogJ0xvZ2luQ29udHJvbGxlcidcbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgIC53aGVuKCcvc29saWNpdGFjYW8nLCB7XG4gICAgICAgICAgICAgICAgJ3RlbXBsYXRlVXJsJyA6ICdhcHAvY29tcG9uZW50cy9zb2xpY2l0YXRpb24vc29saWNpdGF0aW9uLmh0bWwnLFxuICAgICAgICAgICAgICAgICdjb250cm9sbGVyJyAgOiAnU29saWNpdGF0aW9uQ29udHJvbGxlcidcbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgIC53aGVuKCcvZW1wcmVzYXMnLCB7XG4gICAgICAgICAgICAgICAgJ3RlbXBsYXRlVXJsJyA6ICdhcHAvY29tcG9uZW50cy9jb21wYW5pZXMvY29tcGFuaWVzLmh0bWwnLFxuICAgICAgICAgICAgICAgICdjb250cm9sbGVyJyAgOiAnQ29tcGFuaWVzQ29udHJvbGxlcidcbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgIC53aGVuKCcvZXN0YWdpb3MnLCB7XG4gICAgICAgICAgICAgICAgJ3RlbXBsYXRlVXJsJyA6ICdhcHAvY29tcG9uZW50cy9pbnRlcm5zaGlwcy9pbnRlcm5zaGlwcy5odG1sJyxcbiAgICAgICAgICAgICAgICAnY29udHJvbGxlcicgIDogJ0ludGVybnNoaXBzQ29udHJvbGxlcidcbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgIC53aGVuKCcvcmVnaXN0cm8nLCB7XG4gICAgICAgICAgICAgICAgJ3RlbXBsYXRlVXJsJyA6ICdhcHAvY29tcG9uZW50cy9sb2dpbi9yZWdpc3Rlci5odG1sJyxcbiAgICAgICAgICAgICAgICAnY29udHJvbGxlcicgIDogJ1JlZ2lzdGVyQ29udHJvbGxlcidcbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgIC5vdGhlcndpc2Uoe1xuICAgICAgICAgICAgICAgICdyZWRpcmVjdFRvJzogJy9sb2dpbidcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICRsb2NhdGlvblByb3ZpZGVyLmh0bWw1TW9kZSh0cnVlKTtcbiAgICB9XG59KCkpOyIsIihmdW5jdGlvbigpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIC8vIENyZWF0aW5nIHRoZSBtb2R1bGUgYW5kIGZhY3Rvcnkgd2UgcmVmZXJlbmNlZCBpbiB0aGUgYmVmb3JlRWFjaCBibG9ja3MgaW4gb3VyIHRlc3QgZmlsZVxuICBhbmd1bGFyLm1vZHVsZSgnYWZybUFwcCcpXG4gIC5mYWN0b3J5KCdVc2VycycsIGZ1bmN0aW9uKCkge1xuICAgIHZhciBVc2VycyA9IHt9O1xuXG4gICAgLy8gRGVmaW5pbmcgYWxsIHRvIG1ha2Ugb3VyIHRlc3QgcGFzcy4gSXQgZG9lc24ndCBuZWVkIHRvIGRvIGFueXRoaW5nIHlldC5cbiAgICBVc2Vycy5hbGwgPSBmdW5jdGlvbigpIHtcblxuICAgIH07XG5cbiAgICByZXR1cm4gVXNlcnM7XG4gIH0pO1xufSkoKTsiLCIoZnVuY3Rpb24oKSB7XG5cbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnYWZybUFwcCcpLmNvbnRyb2xsZXIoJ0NvbXBhbmllc0NvbnRyb2xsZXInLCBDb21wYW5pZXNDb250cm9sbGVyKTtcblxuICAgIENvbXBhbmllc0NvbnRyb2xsZXIuJGluamVjdCA9IFsgJyRzY29wZScsICckbWREaWFsb2cnLCAnY29tcGFuaWVzU2VydmljZScgXTtcblxuICAgIGZ1bmN0aW9uIENvbXBhbmllc0NvbnRyb2xsZXIoJHNjb3BlLCAkbWREaWFsb2csIGNvbXBhbmllc1NlcnZpY2UpIHtcblxuICAgICAgICAvLyBjcmlhIG91IGVkaXRhIGNvbXBhbnlcbiAgICAgICAgJHNjb3BlLnNob3dEaWFsb2cgPSBmdW5jdGlvbihjb21wYW55KSB7XG5cbiAgICAgICAgICAgICRtZERpYWxvZy5zaG93KHtcbiAgICAgICAgICAgICAgICAnY29udHJvbGxlcic6ICdNYW5hZ2VDb21wYW55Q29udHJvbGxlcicsXG4gICAgICAgICAgICAgICAgJ3RlbXBsYXRlVXJsJzogJ2FwcC9zaGFyZWQvdGVtcGxhdGVzL21vZGFscy9tYW5hZ2UtY29tcGFueS5odG1sJyxcbiAgICAgICAgICAgICAgICAncGFyZW50JzogYW5ndWxhci5lbGVtZW50KGRvY3VtZW50LmJvZHkpLFxuICAgICAgICAgICAgICAgICdsb2NhbHMnOiB7ICdjb21wYW55JzogY29tcGFueSB8fCBudWxsIH0sXG4gICAgICAgICAgICAgICAgJ2NsaWNrT3V0c2lkZVRvQ2xvc2UnOnRydWVcbiAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24oY29tcGFueSwgaXNOZXdDb21wYW55KSB7XG4gICAgICAgICAgICAgICAgaWYgKGNvbXBhbnkpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzTmV3Q29tcGFueSlcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5jb21wYW5pZXMucHVzaChjb21wYW55KTtcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuY29tcGFuaWVzLmZvckVhY2goZnVuY3Rpb24oY29tcCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb21wLl9pZCA9PT0gY29tcGFueS5faWQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXAgPSAgY29tcGFueTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uKCkge30pO1xuICAgICAgICB9O1xuXG4gICAgICAgIChmdW5jdGlvbiBpbml0KCkge1xuXG4gICAgICAgICAgICBjb21wYW5pZXNTZXJ2aWNlLmdldCgpXG4gICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24oY29tcGFuaWVzKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5jb21wYW5pZXMgPSBjb21wYW5pZXM7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24ocmVhc29uKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlYXNvbik7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tY29uc29sZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9KCkpO1xuICAgIH1cbn0oKSk7XG4iLCIoZnVuY3Rpb24oKSB7XG5cbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnYWZybUFwcCcpLmNvbnRyb2xsZXIoJ0hvbWVDb250cm9sbGVyJywgSG9tZUNvbnRyb2xsZXIpO1xuXG4gICAgSG9tZUNvbnRyb2xsZXIuJGluamVjdCA9IFsgJyRzY29wZScgXTtcblxuICAgIGZ1bmN0aW9uIEhvbWVDb250cm9sbGVyKCRzY29wZSkge1xuXG4gICAgICAgICRzY29wZS5hcHByb3ZlU29saWNpdGF0aW9uID0gIGZ1bmN0aW9uKCkge1xuXG4gICAgICAgIH07XG5cbiAgICAgICAgJHNjb3BlLmluc2VydFNvbGljaXRhdGlvbiA9IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgIH07XG4gICAgfVxufSgpKTtcbiIsIihmdW5jdGlvbigpIHtcblxuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdhZnJtQXBwJykuY29udHJvbGxlcignSW50ZXJuc2hpcHNDb250cm9sbGVyJywgSW50ZXJuc2hpcHNDb250cm9sbGVyKTtcblxuICAgIEludGVybnNoaXBzQ29udHJvbGxlci4kaW5qZWN0ID0gWyAnJHNjb3BlJywgJyRtZERpYWxvZycsICdpbnRlcm5zaGlwc1NlcnZpY2UnIF07XG5cbiAgICBmdW5jdGlvbiBJbnRlcm5zaGlwc0NvbnRyb2xsZXIoJHNjb3BlLCAkbWREaWFsb2csIGludGVybnNoaXBzU2VydmljZSkge1xuXG4gICAgICAgICRzY29wZS5zaG93RGlhbG9nID0gZnVuY3Rpb24oaW50ZXJuc2hpcCwgY3JlZGVudGlhbCkge1xuICAgICAgICAgICAgaWYgKGludGVybnNoaXAuc3RhdHVzID09PSAnQWd1YXJkYW5kbyBhcHJvdmHDp8OjbycgJiYgKCRzY29wZS5jcmVkZW50aWFsLnJvbGUgPT09ICdjb29yZGluYXRvcicgfHwgJHNjb3BlLmNyZWRlbnRpYWwucm9sZSA9PT0gJ3N0dWRlbnQnKSlcbiAgICAgICAgICAgICAgICAkbWREaWFsb2cuc2hvdyh7XG4gICAgICAgICAgICAgICAgICAgICdjb250cm9sbGVyJyAgICAgICAgICA6ICdJbnRlcm5zaGlwRGlhbG9nQ29udHJvbGxlcicsXG4gICAgICAgICAgICAgICAgICAgICd0ZW1wbGF0ZVVybCcgICAgICAgICA6ICdhcHAvc2hhcmVkL3RlbXBsYXRlcy9tb2RhbHMvaW50ZXJuc2hpcC1kaWFsb2cuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgICdwYXJlbnQnICAgICAgICAgICAgICA6IGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5ib2R5KSxcbiAgICAgICAgICAgICAgICAgICAgJ2xvY2FscycgICAgICAgICAgICAgIDogeyAnaW50ZXJuc2hpcCc6IGludGVybnNoaXAgfHwge30sICdjcmVkZW50aWFsJzogY3JlZGVudGlhbCB9LFxuICAgICAgICAgICAgICAgICAgICAnY2xpY2tPdXRzaWRlVG9DbG9zZScgOiB0cnVlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgJHNjb3BlLnNlYXJjaCA9IGZ1bmN0aW9uKHF1ZXJ5KSB7XG4gICAgICAgICAgICB2YXIgcSA9IHsnY3JlZGVudGlhbElkJzogJHNjb3BlLmNyZWRlbnRpYWwuX2lkfTtcblxuICAgICAgICAgICAgaWYgKHF1ZXJ5Lm5hbWUpXG4gICAgICAgICAgICAgICAgcS5uYW1lID0gcXVlcnkubmFtZS50cmltKCk7XG5cbiAgICAgICAgICAgIGlmIChxdWVyeS5zdGF0dXMgJiYgcXVlcnkuc3RhdHVzLnRyaW0oKSAhPT0gJ1RvZG9zJylcbiAgICAgICAgICAgICAgICBxLnN0YXR1cyA9IHF1ZXJ5LnN0YXR1cy50cmltKCk7XG5cbiAgICAgICAgICAgIGludGVybnNoaXBzU2VydmljZS5nZXQocSlcbiAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbihpbnRlcm5zaGlwcykge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaW50ZXJuc2hpcHMgPSBpbnRlcm5zaGlwcztcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbihyZWFzb24pIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVhc29uKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1jb25zb2xlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgKGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICAgICAgICB2YXIgcXVlcnkgPSB7fTtcblxuICAgICAgICAgICAgJHNjb3BlLnF1ZXJ5ID0ge307XG5cbiAgICAgICAgICAgICRzY29wZS5zdGF0dXMgPSBbJ1RvZG9zJywgJ0VtIGFuZGFtZW50bycsICdSZXByb3ZhZG8nLCAnQ2FuY2VsYWRvJywgJ0FndWFyZGFuZG8gYXByb3Zhw6fDo28nLCAnRmluYWxpemFkbyddO1xuXG4gICAgICAgICAgICAkc2NvcGUuY3JlZGVudGlhbCA9IEpTT04ucGFyc2Uod2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKCdDUkVERU5USUFMJykpO1xuXG4gICAgICAgICAgICAkc2NvcGUuaXNTdHVkZW50ID0gJHNjb3BlLmNyZWRlbnRpYWwucm9sZSA9PT0gJ3N0dWRlbnQnID8gdHJ1ZSA6IGZhbHNlO1xuXG4gICAgICAgICAgICBxdWVyeSA9IHsnY3JlZGVudGlhbElkJzogJHNjb3BlLmNyZWRlbnRpYWwuX2lkfTtcblxuICAgICAgICAgICAgaW50ZXJuc2hpcHNTZXJ2aWNlLmdldChxdWVyeSlcbiAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbihpbnRlcm5zaGlwcykge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaW50ZXJuc2hpcHMgPSBpbnRlcm5zaGlwcztcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbihyZWFzb24pIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVhc29uKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1jb25zb2xlXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSgpKTtcbiAgICB9XG59KCkpO1xuIiwiKGZ1bmN0aW9uKCkge1xuXG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ2Fmcm1BcHAnKS5jb250cm9sbGVyKCdMb2dpbkNvbnRyb2xsZXInLCBMb2dpbkNvbnRyb2xsZXIpO1xuXG4gICAgTG9naW5Db250cm9sbGVyLiRpbmplY3QgPSBbICckc2NvcGUnLCAnY3JlZGVudGlhbHNTZXJ2aWNlJywgJyRsb2NhdGlvbicgXTtcblxuICAgIGZ1bmN0aW9uIExvZ2luQ29udHJvbGxlcigkc2NvcGUsIGNyZWRlbnRpYWxzU2VydmljZSwgJGxvY2F0aW9uKSB7XG5cbiAgICAgICAgJHNjb3BlLmxvZ2luID0gZnVuY3Rpb24oZW1haWwsIHBhc3MpIHtcbiAgICAgICAgICAgIHZhciBjcmVkZW50aWFsID0ge1xuICAgICAgICAgICAgICAgICdlbWFpbCc6IGVtYWlsLFxuICAgICAgICAgICAgICAgICdwYXNzd29yZCc6IHBhc3NcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGNyZWRlbnRpYWxzU2VydmljZS5sb2dpbihjcmVkZW50aWFsKVxuICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChjcmVkZW50aWFsKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjcmVkZW50aWFsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0oJ0NSRURFTlRJQUwnLCBKU09OLnN0cmluZ2lmeShjcmVkZW50aWFsKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnL2VzdGFnaW9zJyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbihyZWFzb24pIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVhc29uKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1jb25zb2xlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgKGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnbG9naW5jb250cm9sbGVyJyk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tY29uc29sZVxuICAgICAgICB9KCkpO1xuICAgIH1cbn0oKSk7XG4iLCIvLyBkZXNjcmliZSgnQ29udHJvbGxlcjogTG9naW5Db250cm9sbGVyJywgZnVuY3Rpb24gKCkge1xuLy8gICAgIHZhciBNeUNvbnRyb2xsZXIsIHNjb3BlO1xuLy8gICAgIC8vIGxvYWQgdGhlIGNvbnRyb2xsZXIncyBtb2R1bGVcbi8vICAgICBiZWZvcmVFYWNoKGZ1bmN0aW9uKCl7XG4vLyAgICAgICAgIG1vZHVsZSgnYWZybUFwcCcpO1xuLy8gICAgICAgICBpbmplY3QoZnVuY3Rpb24gKCRjb250cm9sbGVyLCAkcm9vdFNjb3BlKSB7XG4vLyAgICAgICAgICAgICBzY29wZSA9ICRyb290U2NvcGUuJG5ldygpO1xuLy8gICAgICAgICAgICAgTXlDb250cm9sbGVyID0gJGNvbnRyb2xsZXIoJ0xvZ2luQ29udHJvbGxlcicsIHtcbi8vICAgICAgICAgICAgICAgICAkc2NvcGU6c2NvcGVcbi8vICAgICAgICAgICAgIH0pO1xuLy8gICAgICAgICB9KTtcbi8vICAgICB9KTtcblxuLy8gICAgIGl0KCdzaG91bGQgZG8gc29tZXRoaW5nJywgZnVuY3Rpb24gKCkge1xuLy8gICAgICAgICBleHBlY3QoNSkudG9CZSg1KTtcbi8vICAgICB9KTtcbi8vIH0pOyBcblxuZGVzY3JpYmUoJ1VzZXJzIGZhY3RvcnknLCBmdW5jdGlvbigpIHtcbiAgdmFyIFVzZXJzO1xuXG4gIC8vIEJlZm9yZSBlYWNoIHRlc3QgbG9hZCBvdXIgYXBpLnVzZXJzIG1vZHVsZVxuICBiZWZvcmVFYWNoKGFuZ3VsYXIubW9jay5tb2R1bGUoJ2Fmcm1BcHAnKSk7XG5cbiAgLy8gQmVmb3JlIGVhY2ggdGVzdCBzZXQgb3VyIGluamVjdGVkIFVzZXJzIGZhY3RvcnkgKF9Vc2Vyc18pIHRvIG91ciBsb2NhbCBVc2VycyB2YXJpYWJsZVxuICBiZWZvcmVFYWNoKGluamVjdChmdW5jdGlvbihfVXNlcnNfKSB7XG4gICAgVXNlcnMgPSBfVXNlcnNfO1xuICB9KSk7XG5cbiAgLy8gQSBzaW1wbGUgdGVzdCB0byB2ZXJpZnkgdGhlIFVzZXJzIGZhY3RvcnkgZXhpc3RzXG4gIGl0KCdzaG91bGQgZXhpc3QnLCBmdW5jdGlvbigpIHtcbiAgICBleHBlY3QoVXNlcnMpLnRvQmVEZWZpbmVkKCk7XG4gIH0pO1xufSk7IiwiKGZ1bmN0aW9uKCkge1xuXG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ2Fmcm1BcHAnKS5jb250cm9sbGVyKCdSZWdpc3RlckNvbnRyb2xsZXInLCBSZWdpc3RlckNvbnRyb2xsZXIpO1xuXG4gICAgUmVnaXN0ZXJDb250cm9sbGVyLiRpbmplY3QgPSBbICckc2NvcGUnLCAnY3JlZGVudGlhbHNTZXJ2aWNlJywgJyRsb2NhdGlvbicsICckbWRUb2FzdCcsICckdGltZW91dCcgXTtcblxuICAgIGZ1bmN0aW9uIFJlZ2lzdGVyQ29udHJvbGxlcigkc2NvcGUsIGNyZWRlbnRpYWxzU2VydmljZSwgJGxvY2F0aW9uLCAkbWRUb2FzdCwgJHRpbWVvdXQpIHtcblxuICAgICAgICAkc2NvcGUuY3JlYXRlQWNjb3VudCA9IGZ1bmN0aW9uKHVzcikge1xuICAgICAgICAgICAgY3JlZGVudGlhbHNTZXJ2aWNlLmNyZWF0ZSh1c3IpXG4gICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRtZFRvYXN0LnNob3coXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJG1kVG9hc3Quc2ltcGxlKClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRleHRDb250ZW50KCdVc3XDoXJpbyBjcmlhZG8gY29tIHN1Y2Vzc28nKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAucG9zaXRpb24oJ2JvdHRvbScpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5oaWRlRGVsYXkoMzAwMClcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkbG9jYXRpb24oJy9sb2dpbicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSwgMzAwMCk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uKHJlYXNvbikge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZWFzb24pOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLWNvbnNvbGVcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgIH1cbn0oKSk7XG4iLCIoZnVuY3Rpb24oKSB7XG5cbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnYWZybUFwcCcpLmNvbnRyb2xsZXIoJ1NvbGljaXRhdGlvbkNvbnRyb2xsZXInLCBTb2xpY2l0YXRpb25Db250cm9sbGVyKTtcblxuICAgIFNvbGljaXRhdGlvbkNvbnRyb2xsZXIuJGluamVjdCA9IFsgJyRzY29wZScgXTtcblxuICAgIGZ1bmN0aW9uIFNvbGljaXRhdGlvbkNvbnRyb2xsZXIoJHNjb3BlKSB7XG5cbiAgICAgICAgJHNjb3BlLmFwcHJvdmVTb2xpY2l0YXRpb24gPSAgZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUuaW5zZXJ0U29saWNpdGF0aW9uID0gZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgfTtcblxuICAgICAgICAoZnVuY3Rpb24gaW5pdCgpIHtcbiAgICAgICAgfSgpKTtcblxuICAgIH1cbn0oKSk7XG4iLCIoZnVuY3Rpb24gKCkge1xuXG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgZnVuY3Rpb24gQ29tcGFuaWVzU2VydmljZSgkaHR0cCwgJHJvb3RTY29wZSkge1xuXG4gICAgICAgIHZhciBtb2R1bGUgPSAnY29tcGFuaWVzJztcblxuICAgICAgICB0aGlzLmNyZWF0ZSA9IGZ1bmN0aW9uIChjb21wYW55KSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdCgkcm9vdFNjb3BlLnNlcnZlclVybCArIG1vZHVsZSwgY29tcGFueSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpcy51cGRhdGUgPSBmdW5jdGlvbiAoY29tcGFueSkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLnB1dCgkcm9vdFNjb3BlLnNlcnZlclVybCArIG1vZHVsZSwgY29tcGFueSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpcy5nZXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KCRyb290U2NvcGUuc2VydmVyVXJsICsgbW9kdWxlKTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBDb21wYW5pZXNTZXJ2aWNlLiRpbmplY3QgPSBbICckaHR0cCcsICckcm9vdFNjb3BlJyBdO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ2Fmcm1BcHAnKS5zZXJ2aWNlKCdjb21wYW5pZXNTZXJ2aWNlJywgQ29tcGFuaWVzU2VydmljZSk7XG5cbn0oKSk7IiwiKGZ1bmN0aW9uICgpIHtcblxuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGZ1bmN0aW9uIENyZWRlbnRpYWxzU2VydmljZSgkaHR0cCwgJHJvb3RTY29wZSkge1xuXG4gICAgICAgIHZhciBtb2R1bGUgPSAnY3JlZGVudGlhbHMnO1xuXG4gICAgICAgIHRoaXMubG9naW4gPSBmdW5jdGlvbiAoY3JlZGVudGlhbCkge1xuICAgICAgICAgICAgdmFyIHF1ZXJ5c3RyaW5nID0gJz9lbWFpbD0nICsgY3JlZGVudGlhbC5lbWFpbCArICcmcGFzc3dvcmQ9JyArIGNyZWRlbnRpYWwucGFzc3dvcmQ7XG5cbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQoJHJvb3RTY29wZS5zZXJ2ZXJVcmwgKyBtb2R1bGUgKyAnLycgKyBxdWVyeXN0cmluZyk7XG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpcy5jcmVhdGUgPSAgZnVuY3Rpb24odXNyKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdCgkcm9vdFNjb3BlLnNlcnZlclVybCArIG1vZHVsZSwgdXNyKTtcbiAgICAgICAgfTtcblxuICAgICAgICB0aGlzLmxvZ291dCA9IGZ1bmN0aW9uICh0b2tlbikge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLmdldCgkcm9vdFNjb3BlLnNlcnZlclVybCArIG1vZHVsZSArICcvJyArIHRva2VuKTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBDcmVkZW50aWFsc1NlcnZpY2UuJGluamVjdCA9IFsgJyRodHRwJywgJyRyb290U2NvcGUnIF07XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnYWZybUFwcCcpLnNlcnZpY2UoJ2NyZWRlbnRpYWxzU2VydmljZScsIENyZWRlbnRpYWxzU2VydmljZSk7XG5cbn0oKSk7IiwiKGZ1bmN0aW9uICgpIHtcblxuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGZ1bmN0aW9uIEludGVybnNoaXBzU2VydmljZSgkaHR0cCwgJHJvb3RTY29wZSkge1xuXG4gICAgICAgIHZhciBtb2R1bGUgPSAnaW50ZXJuc2hpcHMnO1xuXG4gICAgICAgIHRoaXMuZ2V0ID0gZnVuY3Rpb24gKHF1ZXJ5KSB7XG4gICAgICAgICAgICB2YXIgdXJsID0gJHJvb3RTY29wZS5zZXJ2ZXJVcmwgKyBtb2R1bGUgKyAnLz8nO1xuXG4gICAgICAgICAgICBpZiAocXVlcnkuY3JlZGVudGlhbElkKVxuICAgICAgICAgICAgICAgIHVybCArPSAnY3JlZGVudGlhbElkPScgKyBxdWVyeS5jcmVkZW50aWFsSWQ7XG5cbiAgICAgICAgICAgIGlmIChxdWVyeS5zdGF0dXMpXG4gICAgICAgICAgICAgICAgdXJsICs9ICcmc3RhdHVzPScgKyBxdWVyeS5zdGF0dXM7XG5cbiAgICAgICAgICAgIGlmIChxdWVyeS5uYW1lKVxuICAgICAgICAgICAgICAgIHVybCArPSAnJm5hbWU9JyArIHF1ZXJ5Lm5hbWU7XG5cbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQodXJsKTtcbiAgICAgICAgfTtcblxuICAgICAgICB0aGlzLnVwZGF0ZSA9IGZ1bmN0aW9uIChpbnRlcm5zaGlwKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucHV0KCRyb290U2NvcGUuc2VydmVyVXJsICsgbW9kdWxlLCBpbnRlcm5zaGlwKTtcbiAgICAgICAgfTtcblxuICAgIH1cblxuICAgIEludGVybnNoaXBzU2VydmljZS4kaW5qZWN0ID0gWyAnJGh0dHAnLCAnJHJvb3RTY29wZScgXTtcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdhZnJtQXBwJykuc2VydmljZSgnaW50ZXJuc2hpcHNTZXJ2aWNlJywgSW50ZXJuc2hpcHNTZXJ2aWNlKTtcblxufSgpKTsiLCIoZnVuY3Rpb24gKCkge1xuXG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgZnVuY3Rpb24gSW50ZXJuc2hpcERpYWxvZ0NvbnRyb2xsZXIoJHNjb3BlLCAkbWREaWFsb2csIGludGVybnNoaXBzU2VydmljZSwgbG9jYWxzKSB7XG5cbiAgICAgICAgZnVuY3Rpb24gdXBkYXRlSW50ZXJuc2hpcCgpIHtcbiAgICAgICAgICAgICRzY29wZS5pc1NhdmluZyA9IHRydWU7XG5cbiAgICAgICAgICAgIGludGVybnNoaXBzU2VydmljZS51cGRhdGUoJHNjb3BlLmludGVybnNoaXApXG4gICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5pc1NhdmluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAkbWREaWFsb2cuaGlkZSgkc2NvcGUuaW50ZXJuc2hpcCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24ocmVhc29uKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlYXNvbik7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tY29uc29sZVxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaXNTYXZpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgJG1kRGlhbG9nLmhpZGUoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgICRzY29wZS5zYXZlID0gZnVuY3Rpb24oaXNBcHByb3ZlKSB7XG5cbiAgICAgICAgICAgIGlmIChpc0FwcHJvdmUgJiYgJHNjb3BlLmNyZWRlbnRpYWwucm9sZSA9PT0gJ2Nvb3JkaW5hdG9yJykge1xuICAgICAgICAgICAgICAgICRzY29wZS5pbnRlcm5zaGlwLnN0YXR1cyA9ICdFbSBhbmRhbWVudG8nO1xuICAgICAgICAgICAgICAgICRzY29wZS5pbnRlcm5zaGlwLmJlZ2luICA9IG1vbWVudCgpLmZvcm1hdCgnREQvTU0vWVlZWScpO1xuICAgICAgICAgICAgICAgICRzY29wZS5pbnRlcm5zaGlwLmVuZCAgICA9IG1vbWVudChtb21lbnQoKSkuYWRkKDYsICdtb250aHMnKS5mb3JtYXQoJ0REL01NL1lZWVknKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKCFpc0FwcHJvdmUgJiYgJHNjb3BlLmNyZWRlbnRpYWwucm9sZSA9PT0gJ2Nvb3JkaW5hdG9yJylcbiAgICAgICAgICAgICAgICAkc2NvcGUuaW50ZXJuc2hpcC5zdGF0dXMgPSAnUmVwcm92YWRvJztcblxuICAgICAgICAgICAgZWxzZSBpZiAoIWlzQXBwcm92ZSAmJiAkc2NvcGUuY3JlZGVudGlhbC5yb2xlID09PSAnc3R1ZGVudCcpXG4gICAgICAgICAgICAgICAgJHNjb3BlLmludGVybnNoaXAuc3RhdHVzID0gJ0NhbmNlbGFkbyc7XG5cbiAgICAgICAgICAgIHVwZGF0ZUludGVybnNoaXAoKTtcbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUuY2xvc2VEaWFsb2cgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICRtZERpYWxvZy5jYW5jZWwoKTtcbiAgICAgICAgfTtcblxuICAgICAgICAoZnVuY3Rpb24gaW5pdCgpIHtcbiAgICAgICAgICAgICRzY29wZS5pbnRlcm5zaGlwID0gbG9jYWxzLmludGVybnNoaXAgfHwge307XG4gICAgICAgICAgICAkc2NvcGUuY3JlZGVudGlhbCA9IGxvY2Fscy5jcmVkZW50aWFsIHx8IHt9O1xuICAgICAgICB9KSgpO1xuICAgIH1cblxuICAgIEludGVybnNoaXBEaWFsb2dDb250cm9sbGVyLiRpbmplY3QgPSBbICckc2NvcGUnLCAnJG1kRGlhbG9nJywgJ2ludGVybnNoaXBzU2VydmljZScsICdsb2NhbHMnIF07XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnYWZybUFwcCcpLmNvbnRyb2xsZXIoJ0ludGVybnNoaXBEaWFsb2dDb250cm9sbGVyJywgSW50ZXJuc2hpcERpYWxvZ0NvbnRyb2xsZXIpO1xuXG59KCkpOyIsIihmdW5jdGlvbiAoKSB7XG5cbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBmdW5jdGlvbiBNYW5hZ2VDb21wYW55Q29udHJvbGxlcigkc2NvcGUsICRtZERpYWxvZywgY29tcGFuaWVzU2VydmljZSwgbG9jYWxzKSB7XG5cbiAgICAgICAgJHNjb3BlLnNhdmUgPSBmdW5jdGlvbihjb21wYW55KSB7XG4gICAgICAgICAgICB2YXIgaXNOZXdDb21wYW55O1xuXG4gICAgICAgICAgICAkc2NvcGUuaXNMb2FkaW5nQ29tcGFueSA9IHRydWU7XG5cbiAgICAgICAgICAgIC8vIHB1dFxuICAgICAgICAgICAgaWYgKCRzY29wZS5pc0VkaXRpbmcpIHtcbiAgICAgICAgICAgICAgICBpc05ld0NvbXBhbnkgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBjb21wYW5pZXNTZXJ2aWNlLnVwZGF0ZShjb21wYW55KVxuICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoY29tcGFueUVkaXRlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmlzTG9hZGluZ0NvbXBhbnkgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRtZERpYWxvZy5oaWRlKGNvbXBhbnlFZGl0ZWQsIGlzTmV3Q29tcGFueSk7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbiAocmVhc29uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaXNMb2FkaW5nQ29tcGFueSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVhc29uKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1jb25zb2xlXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBwb3N0XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpc05ld0NvbXBhbnkgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGNvbXBhbmllc1NlcnZpY2UuY3JlYXRlKGNvbXBhbnkpXG4gICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChuZXdDb21wYW55KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaXNMb2FkaW5nQ29tcGFueSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgJG1kRGlhbG9nLmhpZGUobmV3Q29tcGFueSwgaXNOZXdDb21wYW55KTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uIChyZWFzb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5pc0xvYWRpbmdDb21wYW55ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZWFzb24pOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLWNvbnNvbGVcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgKGZ1bmN0aW9uIGluaXQoKSB7XG5cbiAgICAgICAgICAgIC8vIGVkaXRhIG91IGNyaWEgZW1wcmVzYVxuICAgICAgICAgICAgaWYgKGxvY2Fscy5jb21wYW55KVxuICAgICAgICAgICAgICAgICRzY29wZS5pc0VkaXRpbmcgPSB0cnVlO1xuXG4gICAgICAgICAgICAkc2NvcGUuY29tcGFueSA9IGxvY2Fscy5jb21wYW55IHx8IHt9O1xuXG4gICAgICAgIH0pKCk7XG4gICAgfVxuXG4gICAgTWFuYWdlQ29tcGFueUNvbnRyb2xsZXIuJGluamVjdCA9IFsgJyRzY29wZScsICckbWREaWFsb2cnLCAnY29tcGFuaWVzU2VydmljZScsICdsb2NhbHMnIF07XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnYWZybUFwcCcpLmNvbnRyb2xsZXIoJ01hbmFnZUNvbXBhbnlDb250cm9sbGVyJywgTWFuYWdlQ29tcGFueUNvbnRyb2xsZXIpO1xuXG59KCkpOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
