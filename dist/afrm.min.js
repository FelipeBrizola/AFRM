!function(){"use strict";angular.module("afrmApp",["ngMaterial","ngAnimate","ngRoute","angular.filter","md.data.table"]).config(["$mdThemingProvider","$mdDateLocaleProvider",function(e,n){n.formatDate=function(e){return moment(e).format("YYYY-MM-DD")},e.theme("forest").primaryPalette("blue").accentPalette("teal").warnPalette("red").backgroundPalette("grey")}])}(),function(){"use strict";function e(e,n,o){n.serverUrl="https://dev-sistemas-server.herokuapp.com/",e.menu=function(e){o.path(e)},e.logout=function(){window.localStorage.removeItem("CREDENTIAL"),o.path("/login")},n.$on("$routeChangeSuccess",function(){e.credential=JSON.parse(window.localStorage.getItem("CREDENTIAL")),"/empresas"===o.path()?e.currentMenuIndex=0:"/solicitacoes"===o.path()?e.currentMenuIndex=1:"/logs"===o.path()?e.currentMenuIndex=2:e.currentMenuIndex=-1,n.isLogin="/login"===o.path()})}e.$inject=["$scope","$rootScope","$location"],angular.module("afrmApp").controller("MainController",e)}(),function(){"use strict";function e(e,n){e.when("/login",{templateUrl:"app/components/login/login.html",controller:"LoginController"}).when("/empresas",{templateUrl:"app/components/companies/companies.html",controller:"CompaniesController"}).when("/solicitacoes",{templateUrl:"app/components/internships/internships.html",controller:"InternshipsController"}).when("/logs",{templateUrl:"app/components/logs/logs.html",controller:"LogsController"}).when("/registro",{templateUrl:"app/components/login/register.html",controller:"RegisterController"}).otherwise({redirectTo:"/login"}),n.html5Mode(!0)}angular.module("afrmApp").config(["$routeProvider","$locationProvider",e])}(),function(){"use strict";function e(e,n,o){function t(n){e.isLoadingCompanies=!0,o.get(n).success(function(n){e.companies=n,e.isLoadingCompanies=!1}).error(function(n){console.log(n),e.isLoadingCompanies=!1})}e.showDialog=function(e){"Aguardando aprovação"===e.status&&n.show({controller:"ManageCompanyController",templateUrl:"app/shared/templates/modals/company-dialog.html",parent:angular.element(document.body),locals:{company:e},clickOutsideToClose:!0})},e.search=function(e){t(e)},function(){e.companySelected=[],t()}()}angular.module("afrmApp").controller("CompaniesController",e),e.$inject=["$scope","$mdDialog","companiesService"]}(),function(){"use strict";function e(e){e.approveSolicitation=function(){},e.insertSolicitation=function(){}}angular.module("afrmApp").controller("HomeController",e),e.$inject=["$scope"]}(),function(){"use strict";function e(e,n,o){e.approveInternshipDialog=function(o,t,r){"Aguardando aprovação"!==o.status||"coordinator"!==e.credential.role&&"student"!==e.credential.role||n.show({controller:"ApproveInternshipDialogController",templateUrl:"app/shared/templates/modals/approve-internship-dialog.html",locals:{internship:o||{},credential:t},parent:angular.element(document.body),targetEvent:r,clickOutsideToClose:!0})},e.internshipDialog=function(o,t){n.show({controller:"InternshipDialogController",templateUrl:"app/shared/templates/modals/internship-dialog.html",locals:{internship:angular.copy(o)||{}},parent:angular.element(document.body),targetEvent:t,clickOutsideToClose:!0}).then(function(n){var o=0;for(o;o<e.internships.length;o+=1)if(e.internships[o]._id===n._id){e.internships[o]=n;break}})},e.search=function(n){var t={credentialId:e.credential._id};n.name&&(t.name=n.name.trim()),n.status&&"Todos"!==n.status.trim()&&(t.status=n.status.trim()),o.get(t).success(function(n){e.internships=n}).error(function(e){console.log(e)})},function(){var n={};e.query={},e.status=["Todos","Em andamento","Reprovado","Cancelado","Aguardando aprovação","Finalizado"],e.credential=JSON.parse(window.localStorage.getItem("CREDENTIAL"))||{},e.isStudent="student"===e.credential.role,n={credentialId:e.credential._id},e.isLoadingInternships=!0,o.get(n).success(function(n){e.internships=n,e.isLoadingInternships=!1}).error(function(n){console.log(n),e.isLoadingInternships=!1})}()}angular.module("afrmApp").controller("InternshipsController",e),e.$inject=["$scope","$mdDialog","internshipsService"]}(),function(){"use strict";function e(e,n,o,t){e.login=function(r,i){var a={email:r,password:i};e.isLoading=!0,n.login(a).success(function(n){e.isLoading=!1,n?(window.localStorage.setItem("CREDENTIAL",JSON.stringify(n)),t.credential=n,o.path("/solicitacoes")):e.isWrongLogin=!0}).error(function(n){e.isLoading=!1,console.log(n)})}}angular.module("afrmApp").controller("LoginController",e),e.$inject=["$scope","credentialsService","$location","$rootScope"]}(),function(){"use strict";function e(e,n,o,t,r){e.createAccount=function(e){n.create(e).success(function(e){e&&(t.show(t.simple().textContent("Usuário criado com sucesso").position("bottom").hideDelay(3e3)),r(function(){o("/login")},3e3))}).error(function(e){console.log(e)})}}angular.module("afrmApp").controller("RegisterController",e),e.$inject=["$scope","credentialsService","$location","$mdToast","$timeout"]}(),function(){"use strict";function e(e){e.approveSolicitation=function(){},e.insertSolicitation=function(){}}angular.module("afrmApp").controller("SolicitationController",e),e.$inject=["$scope"]}(),function(){"use strict";function e(e,n){!function(){e.tableParams={limit:5,page:1},e.isLoadingLogs=!0,n.get().success(function(n){e.logs=n,e.isLoadingLogs=!1,e.tableParams.total=n.length}).error(function(n){e.isLoadingLogs=!1,console.log(n)})}()}angular.module("afrmApp").controller("LogsController",e),e.$inject=["$scope","logsService"]}(),function(){"use strict";function e(e,n){var o="companies";this.create=function(t){return e.post(n.serverUrl+o,t)},this.update=function(t){return t.changer=JSON.parse(window.localStorage.getItem("CREDENTIAL"))._id,e.put(n.serverUrl+o,t)},this.get=function(t){var r=n.serverUrl+o;return t&&(r=r+"/"+t),e.get(r)}}e.$inject=["$http","$rootScope"],angular.module("afrmApp").service("companiesService",e)}(),function(){"use strict";function e(e,n){var o="credentials";this.login=function(t){var r="?email="+t.email+"&password="+t.password;return e.get(n.serverUrl+o+"/"+r)},this.create=function(t){return e.post(n.serverUrl+o,t)},this.logout=function(t){return e.get(n.serverUrl+o+"/"+t)}}e.$inject=["$http","$rootScope"],angular.module("afrmApp").service("credentialsService",e)}(),function(){"use strict";function e(e,n){var o="internships";this.get=function(t){var r=n.serverUrl+o+"/?";return t.credentialId&&(r+="credentialId="+t.credentialId),t.status&&(r+="&status="+t.status),t.name&&(r+="&name="+t.name),e.get(r)},this.update=function(t){return t.changer=JSON.parse(window.localStorage.getItem("CREDENTIAL"))._id,e.put(n.serverUrl+o,t)}}e.$inject=["$http","$rootScope"],angular.module("afrmApp").service("internshipsService",e)}(),function(){"use strict";function e(e,n){var o="logs";this.get=function(){return e.get(n.serverUrl+o)}}e.$inject=["$http","$rootScope"],angular.module("afrmApp").service("logsService",e)}(),function(){"use strict";function e(e,n,o,t){function r(){e.isSaving=!0,o.update(e.internship).success(function(){e.isSaving=!1,n.hide(e.internship)}).error(function(o){console.log(o),e.isSaving=!1,n.hide()})}e.save=function(n){n&&"coordinator"===e.credential.role?(e.internship.status="Em andamento",e.internship.begin=moment().format("DD/MM/YYYY"),e.internship.end=moment(moment()).add(6,"months").format("DD/MM/YYYY")):n||"coordinator"!==e.credential.role?n||"student"!==e.credential.role||(e.internship.status="Cancelado"):e.internship.status="Reprovado",r()},e.closeDialog=function(){n.cancel()},function(){e.internship=t.internship||{},e.credential=t.credential||{}}()}e.$inject=["$scope","$mdDialog","internshipsService","locals"],angular.module("afrmApp").controller("ApproveInternshipDialogController",e)}(),function(){"use strict";function e(e,n,o,t){e.save=function(t,r){e.isLoadingCompany=!0,r===!0?t.status="Aprovado":t.status="Reprovado",o.update(t).success(function(){e.isLoadingCompany=!1,n.hide(t)}).error(function(n){e.isLoadingCompany=!1,console.log(n)})},e.closeDialog=function(){n.cancel()},function(){e.company=t.company||{}}()}e.$inject=["$scope","$mdDialog","companiesService","locals"],angular.module("afrmApp").controller("ManageCompanyController",e)}(),function(){"use strict";function e(e,n,o,t){e.closeDialog=function(){n.cancel()},e.update=function(e){o.update(e).success(function(o){n.hide(e)}).error(function(e){})},function(){var n=JSON.parse(window.localStorage.getItem("CREDENTIAL")).role;e.internship=t.internship||{},e.isEditable="student"===n&&e.internship&&"Aguardando aprovação"===e.internship.status}()}e.$inject=["$scope","$mdDialog","internshipsService","locals"],angular.module("afrmApp").controller("InternshipDialogController",e)}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC1tb2R1bGUuanMiLCJhcHAtY29udHJvbGxlci5qcyIsImFwcC1yb3V0ZXMuanMiLCJjb21wb25lbnRzL2NvbXBhbmllcy9jb21wYW5pZXMuY29udHJvbGxlci5qcyIsImNvbXBvbmVudHMvaG9tZS9ob21lLmNvbnRyb2xsZXIuanMiLCJjb21wb25lbnRzL2ludGVybnNoaXBzL2ludGVybnNoaXBzLmNvbnRyb2xsZXIuanMiLCJjb21wb25lbnRzL2xvZ2luL2xvZ2luLmNvbnRyb2xsZXIuanMiLCJjb21wb25lbnRzL2xvZ2luL3JlZ2lzdGVyLmNvbnRyb2xsZXIuanMiLCJjb21wb25lbnRzL3NvbGljaXRhdGlvbi9zb2xpY2l0YXRpb24uY29udHJvbGxlci5qcyIsImNvbXBvbmVudHMvbG9ncy9sb2dzLmNvbnRyb2xsZXIuanMiLCJzaGFyZWQvc2VydmljZXMvY29tcGFuaWVzLnNlcnZpY2UuanMiLCJzaGFyZWQvc2VydmljZXMvY3JlZGVudGlhbHMuc2VydmljZS5qcyIsInNoYXJlZC9zZXJ2aWNlcy9pbnRlcm5zaGlwcy5zZXJ2aWNlLmpzIiwic2hhcmVkL3NlcnZpY2VzL2xvZ3Muc2VydmljZS5qcyIsInNoYXJlZC90ZW1wbGF0ZXMvbW9kYWxzL2FwcHJvdmUuaW50ZXJuc2hpcC5kaWFsb2cuY29udHJvbGxlci5qcyIsInNoYXJlZC90ZW1wbGF0ZXMvbW9kYWxzL2NvbXBhbnkuZGlhbG9nLmNvbnRyb2xsZXIuanMiLCJzaGFyZWQvdGVtcGxhdGVzL21vZGFscy9pbnRlcm5zaGlwLmRpYWxvZy5jb250cm9sbGVyLmpzIl0sIm5hbWVzIjpbImFuZ3VsYXIiLCJtb2R1bGUiLCJjb25maWciLCIkbWRUaGVtaW5nUHJvdmlkZXIiLCIkbWREYXRlTG9jYWxlUHJvdmlkZXIiLCJmb3JtYXREYXRlIiwiZGF0ZSIsIm1vbWVudCIsImZvcm1hdCIsInRoZW1lIiwicHJpbWFyeVBhbGV0dGUiLCJhY2NlbnRQYWxldHRlIiwid2FyblBhbGV0dGUiLCJiYWNrZ3JvdW5kUGFsZXR0ZSIsIk1haW5Db250cm9sbGVyIiwiJHNjb3BlIiwiJHJvb3RTY29wZSIsIiRsb2NhdGlvbiIsInNlcnZlclVybCIsIm1lbnUiLCJwYXRoIiwibG9nb3V0Iiwid2luZG93IiwibG9jYWxTdG9yYWdlIiwicmVtb3ZlSXRlbSIsIiRvbiIsImNyZWRlbnRpYWwiLCJKU09OIiwicGFyc2UiLCJnZXRJdGVtIiwiY3VycmVudE1lbnVJbmRleCIsImlzTG9naW4iLCIkaW5qZWN0IiwiY29udHJvbGxlciIsIkFwcGxpY2F0aW9uQ29uZmlnIiwiJHJvdXRlUHJvdmlkZXIiLCIkbG9jYXRpb25Qcm92aWRlciIsIndoZW4iLCJ0ZW1wbGF0ZVVybCIsIm90aGVyd2lzZSIsInJlZGlyZWN0VG8iLCJodG1sNU1vZGUiLCJDb21wYW5pZXNDb250cm9sbGVyIiwiJG1kRGlhbG9nIiwiY29tcGFuaWVzU2VydmljZSIsImdldENvbXBhbmllcyIsIm5hbWUiLCJpc0xvYWRpbmdDb21wYW5pZXMiLCJnZXQiLCJzdWNjZXNzIiwiY29tcGFuaWVzIiwiZXJyb3IiLCJyZWFzb24iLCJjb25zb2xlIiwibG9nIiwic2hvd0RpYWxvZyIsImNvbXBhbnkiLCJzdGF0dXMiLCJzaG93IiwicGFyZW50IiwiZWxlbWVudCIsImRvY3VtZW50IiwiYm9keSIsImxvY2FscyIsImNsaWNrT3V0c2lkZVRvQ2xvc2UiLCJzZWFyY2giLCJjb21wYW55U2VsZWN0ZWQiLCJIb21lQ29udHJvbGxlciIsImFwcHJvdmVTb2xpY2l0YXRpb24iLCJpbnNlcnRTb2xpY2l0YXRpb24iLCJJbnRlcm5zaGlwc0NvbnRyb2xsZXIiLCJpbnRlcm5zaGlwc1NlcnZpY2UiLCJhcHByb3ZlSW50ZXJuc2hpcERpYWxvZyIsImludGVybnNoaXAiLCJldiIsInJvbGUiLCJ0YXJnZXRFdmVudCIsImludGVybnNoaXBEaWFsb2ciLCJjb3B5IiwidGhlbiIsInVwZGF0ZWRJbnRlcm5zaGlwIiwiaSIsImludGVybnNoaXBzIiwibGVuZ3RoIiwiX2lkIiwicXVlcnkiLCJxIiwiY3JlZGVudGlhbElkIiwidHJpbSIsImlzU3R1ZGVudCIsImlzTG9hZGluZ0ludGVybnNoaXBzIiwiTG9naW5Db250cm9sbGVyIiwiY3JlZGVudGlhbHNTZXJ2aWNlIiwibG9naW4iLCJlbWFpbCIsInBhc3MiLCJwYXNzd29yZCIsImlzTG9hZGluZyIsInNldEl0ZW0iLCJzdHJpbmdpZnkiLCJpc1dyb25nTG9naW4iLCJSZWdpc3RlckNvbnRyb2xsZXIiLCIkbWRUb2FzdCIsIiR0aW1lb3V0IiwiY3JlYXRlQWNjb3VudCIsInVzciIsImNyZWF0ZSIsInJlc3VsdCIsInNpbXBsZSIsInRleHRDb250ZW50IiwicG9zaXRpb24iLCJoaWRlRGVsYXkiLCJTb2xpY2l0YXRpb25Db250cm9sbGVyIiwiTG9nc0NvbnRyb2xsZXIiLCJsb2dzU2VydmljZSIsInRhYmxlUGFyYW1zIiwibGltaXQiLCJwYWdlIiwiaXNMb2FkaW5nTG9ncyIsImxvZ3MiLCJ0b3RhbCIsIkNvbXBhbmllc1NlcnZpY2UiLCIkaHR0cCIsInRoaXMiLCJwb3N0IiwidXBkYXRlIiwiY2hhbmdlciIsInB1dCIsInVybCIsInNlcnZpY2UiLCJDcmVkZW50aWFsc1NlcnZpY2UiLCJxdWVyeXN0cmluZyIsInRva2VuIiwiSW50ZXJuc2hpcHNTZXJ2aWNlIiwiTG9nc1NlcnZpY2UiLCJBcHByb3ZlSW50ZXJuc2hpcERpYWxvZ0NvbnRyb2xsZXIiLCJ1cGRhdGVJbnRlcm5zaGlwIiwiaXNTYXZpbmciLCJoaWRlIiwic2F2ZSIsImlzQXBwcm92ZSIsImJlZ2luIiwiZW5kIiwiYWRkIiwiY2xvc2VEaWFsb2ciLCJjYW5jZWwiLCJNYW5hZ2VDb21wYW55Q29udHJvbGxlciIsImlzTG9hZGluZ0NvbXBhbnkiLCJJbnRlcm5zaGlwRGlhbG9nQ29udHJvbGxlciIsImlzRWRpdGFibGUiXSwibWFwcGluZ3MiOiJDQUFBLFdBQ0EsWUFHQUEsU0FBQUMsT0FBQSxXQUNBLGFBQ0EsWUFDQSxVQUNBLGlCQUNBLGtCQUdBQyxRQUFBLHFCQUFBLHdCQUFB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S0FBQWxGLEtBRUFMLE1BQUEsU0FBQUMsR0FDQXJDLEVBQUFvSSxrQkFBQSxFQUNBOUYsUUFBQUMsSUFBQUYsTUFLQXJDLEVBQUFpSSxZQUFBLFdBQ0FyRyxFQUFBc0csVUFHQSxXQUNBbEksRUFBQXlDLFFBQUFPLEVBQUFQLGVBSUEwRixFQUFBbEgsU0FBQSxTQUFBLFlBQUEsbUJBQUEsVUFFQWhDLFFBQUFDLE9BQUEsV0FBQWdDLFdBQUEsMEJBQUFpSCxNQ3ZDQSxXQUVBLFlBRUEsU0FBQUUsR0FBQXJJLEVBQUE0QixFQUFBNEIsRUFBQVIsR0FFQWhELEVBQUFpSSxZQUFBLFdBQ0FyRyxFQUFBc0csVUFHQWxJLEVBQUE4RyxPQUFBLFNBQUFwRCxHQUNBRixFQUFBc0QsT0FBQXBELEdBQ0F4QixRQUFBLFNBQUEwRCxHQUVBaEUsRUFBQStGLEtBQUFqRSxLQUVBdEIsTUFBQSxTQUFBQyxPQUtBLFdBRUEsR0FBQXVCLEdBQUFoRCxLQUFBQyxNQUFBTixPQUFBQyxhQUFBTSxRQUFBLGVBQUE4QyxJQUVBNUQsR0FBQTBELFdBQUFWLEVBQUFVLGVBRUExRCxFQUFBc0ksV0FBQSxZQUFBMUUsR0FBQTVELEVBQUEwRCxZQUFBLHlCQUFBMUQsRUFBQTBELFdBQUFoQixVQUtBMkYsRUFBQXBILFNBQUEsU0FBQSxZQUFBLHFCQUFBLFVBRUFoQyxRQUFBQyxPQUFBLFdBQUFnQyxXQUFBLDZCQUFBbUgiLCJmaWxlIjoiYWZybS5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIC8vIE1vZHVsZSBkZXBlbmRlbmNpZXMgaW5qZWN0aW9uXG4gICAgYW5ndWxhci5tb2R1bGUoJ2Fmcm1BcHAnLCBbXG4gICAgICAgICduZ01hdGVyaWFsJyxcbiAgICAgICAgJ25nQW5pbWF0ZScsXG4gICAgICAgICduZ1JvdXRlJyxcbiAgICAgICAgJ2FuZ3VsYXIuZmlsdGVyJyxcbiAgICAgICAgJ21kLmRhdGEudGFibGUnXG4gICAgXSlcblxuICAgICAgICAuY29uZmlnKGZ1bmN0aW9uICgkbWRUaGVtaW5nUHJvdmlkZXIsICRtZERhdGVMb2NhbGVQcm92aWRlcikge1xuXG4gICAgICAgICAgICAvLyBEYXRlIGZvcm1hdCBjb25maWd1cmF0aW9uXG4gICAgICAgICAgICAkbWREYXRlTG9jYWxlUHJvdmlkZXIuZm9ybWF0RGF0ZSA9IGZ1bmN0aW9uKGRhdGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbW9tZW50KGRhdGUpLmZvcm1hdCgnWVlZWS1NTS1ERCcpO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgLy8gVGhlbWUgY29uZmlndXJhdGlvblxuICAgICAgICAgICAgJG1kVGhlbWluZ1Byb3ZpZGVyXG4gICAgICAgICAgICAgICAgLnRoZW1lKCdmb3Jlc3QnKVxuICAgICAgICAgICAgICAgIC5wcmltYXJ5UGFsZXR0ZSgnYmx1ZScpXG4gICAgICAgICAgICAgICAgLmFjY2VudFBhbGV0dGUoJ3RlYWwnKVxuICAgICAgICAgICAgICAgIC53YXJuUGFsZXR0ZSgncmVkJylcbiAgICAgICAgICAgICAgICAuYmFja2dyb3VuZFBhbGV0dGUoJ2dyZXknKTtcbiAgICAgICAgfSk7XG5cbn0oKSk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIC8vIGluamVjdGluZyBkZXBlbmRlbmNpZXNcbiAgICBNYWluQ29udHJvbGxlci4kaW5qZWN0ID0gW1xuICAgICAgICAnJHNjb3BlJywgJyRyb290U2NvcGUnLCAnJGxvY2F0aW9uJ1xuICAgIF07XG5cbiAgICAvLyByZWdpc3RlcmluZyBvbiBhbmd1bGFyXG4gICAgYW5ndWxhci5tb2R1bGUoJ2Fmcm1BcHAnKS5jb250cm9sbGVyKCdNYWluQ29udHJvbGxlcicsIE1haW5Db250cm9sbGVyKTtcblxuICAgIC8vIE1haW4gQ29udHJvbGxlclxuICAgIGZ1bmN0aW9uIE1haW5Db250cm9sbGVyKCRzY29wZSwgJHJvb3RTY29wZSwgJGxvY2F0aW9uKSB7XG5cbiAgICAgICAgLy8gJHJvb3RTY29wZS5zZXJ2ZXJVcmwgPSAnaHR0cDovL2xvY2FsaG9zdDozMDAwLyc7XG4gICAgICAgICRyb290U2NvcGUuc2VydmVyVXJsID0gJ2h0dHBzOi8vZGV2LXNpc3RlbWFzLXNlcnZlci5oZXJva3VhcHAuY29tLyc7XG5cbiAgICAgICAgJHNjb3BlLm1lbnUgPSBmdW5jdGlvbihwYXRoKSB7XG4gICAgICAgICAgICAkbG9jYXRpb24ucGF0aChwYXRoKTtcbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUubG9nb3V0ID0gIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgnQ1JFREVOVElBTCcpO1xuICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy9sb2dpbicpO1xuICAgICAgICB9O1xuXG4gICAgICAgICRyb290U2NvcGUuJG9uKCckcm91dGVDaGFuZ2VTdWNjZXNzJywgZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAkc2NvcGUuY3JlZGVudGlhbCA9IEpTT04ucGFyc2Uod2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKCdDUkVERU5USUFMJykpO1xuXG4gICAgICAgICAgICBpZiAoJGxvY2F0aW9uLnBhdGgoKSA9PT0gJy9lbXByZXNhcycpXG4gICAgICAgICAgICAgICAgJHNjb3BlLmN1cnJlbnRNZW51SW5kZXggPSAwO1xuXG4gICAgICAgICAgICBlbHNlIGlmICgkbG9jYXRpb24ucGF0aCgpID09PSAnL3NvbGljaXRhY29lcycpXG4gICAgICAgICAgICAgICAgJHNjb3BlLmN1cnJlbnRNZW51SW5kZXggPSAxO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBlbHNlIGlmICgkbG9jYXRpb24ucGF0aCgpID09PSAnL2xvZ3MnKVxuICAgICAgICAgICAgICAgICRzY29wZS5jdXJyZW50TWVudUluZGV4ID0gMjtcblxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICRzY29wZS5jdXJyZW50TWVudUluZGV4ID0gLTE7XG5cbiAgICAgICAgICAgICRyb290U2NvcGUuaXNMb2dpbiA9ICRsb2NhdGlvbi5wYXRoKCkgPT09ICcvbG9naW4nID8gdHJ1ZSA6IGZhbHNlO1xuXG4gICAgICAgIH0pO1xuXG4gICAgfVxufSgpKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ2Fmcm1BcHAnKS5jb25maWcoWyckcm91dGVQcm92aWRlcicsICckbG9jYXRpb25Qcm92aWRlcicsIEFwcGxpY2F0aW9uQ29uZmlnXSk7XG5cbiAgICBmdW5jdGlvbiBBcHBsaWNhdGlvbkNvbmZpZygkcm91dGVQcm92aWRlciwgJGxvY2F0aW9uUHJvdmlkZXIpIHtcbiAgICAgICAgJHJvdXRlUHJvdmlkZXJcblxuICAgICAgICAgICAgLndoZW4oJy9sb2dpbicsIHtcbiAgICAgICAgICAgICAgICAndGVtcGxhdGVVcmwnIDogJ2FwcC9jb21wb25lbnRzL2xvZ2luL2xvZ2luLmh0bWwnLFxuICAgICAgICAgICAgICAgICdjb250cm9sbGVyJyAgOiAnTG9naW5Db250cm9sbGVyJ1xuICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgLndoZW4oJy9lbXByZXNhcycsIHtcbiAgICAgICAgICAgICAgICAndGVtcGxhdGVVcmwnIDogJ2FwcC9jb21wb25lbnRzL2NvbXBhbmllcy9jb21wYW5pZXMuaHRtbCcsXG4gICAgICAgICAgICAgICAgJ2NvbnRyb2xsZXInICA6ICdDb21wYW5pZXNDb250cm9sbGVyJ1xuICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgLndoZW4oJy9zb2xpY2l0YWNvZXMnLCB7XG4gICAgICAgICAgICAgICAgJ3RlbXBsYXRlVXJsJyA6ICdhcHAvY29tcG9uZW50cy9pbnRlcm5zaGlwcy9pbnRlcm5zaGlwcy5odG1sJyxcbiAgICAgICAgICAgICAgICAnY29udHJvbGxlcicgIDogJ0ludGVybnNoaXBzQ29udHJvbGxlcidcbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgIC53aGVuKCcvbG9ncycsIHtcbiAgICAgICAgICAgICAgICAndGVtcGxhdGVVcmwnIDogJ2FwcC9jb21wb25lbnRzL2xvZ3MvbG9ncy5odG1sJyxcbiAgICAgICAgICAgICAgICAnY29udHJvbGxlcicgIDogJ0xvZ3NDb250cm9sbGVyJ1xuICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgLndoZW4oJy9yZWdpc3RybycsIHtcbiAgICAgICAgICAgICAgICAndGVtcGxhdGVVcmwnIDogJ2FwcC9jb21wb25lbnRzL2xvZ2luL3JlZ2lzdGVyLmh0bWwnLFxuICAgICAgICAgICAgICAgICdjb250cm9sbGVyJyAgOiAnUmVnaXN0ZXJDb250cm9sbGVyJ1xuICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgLm90aGVyd2lzZSh7XG4gICAgICAgICAgICAgICAgJ3JlZGlyZWN0VG8nOiAnL2xvZ2luJ1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgJGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKHRydWUpO1xuICAgIH1cbn0oKSk7IiwiKGZ1bmN0aW9uKCkge1xuXG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ2Fmcm1BcHAnKS5jb250cm9sbGVyKCdDb21wYW5pZXNDb250cm9sbGVyJywgQ29tcGFuaWVzQ29udHJvbGxlcik7XG5cbiAgICBDb21wYW5pZXNDb250cm9sbGVyLiRpbmplY3QgPSBbICckc2NvcGUnLCAnJG1kRGlhbG9nJywgJ2NvbXBhbmllc1NlcnZpY2UnIF07XG5cbiAgICBmdW5jdGlvbiBDb21wYW5pZXNDb250cm9sbGVyKCRzY29wZSwgJG1kRGlhbG9nLCBjb21wYW5pZXNTZXJ2aWNlKSB7XG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0Q29tcGFuaWVzKG5hbWUpIHtcblxuICAgICAgICAgICAgJHNjb3BlLmlzTG9hZGluZ0NvbXBhbmllcyA9IHRydWU7XG5cbiAgICAgICAgICAgIGNvbXBhbmllc1NlcnZpY2UuZ2V0KG5hbWUpXG4gICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24oY29tcGFuaWVzKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5jb21wYW5pZXMgPSBjb21wYW5pZXM7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5pc0xvYWRpbmdDb21wYW5pZXMgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbihyZWFzb24pIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVhc29uKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1jb25zb2xlXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5pc0xvYWRpbmdDb21wYW5pZXMgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgICRzY29wZS5zaG93RGlhbG9nID0gZnVuY3Rpb24oY29tcGFueSkge1xuXG4gICAgICAgICAgICBpZiAoY29tcGFueS5zdGF0dXMgPT09ICdBZ3VhcmRhbmRvIGFwcm92YcOnw6NvJylcbiAgICAgICAgICAgICAgICAkbWREaWFsb2cuc2hvdyh7XG4gICAgICAgICAgICAgICAgICAgICdjb250cm9sbGVyJyAgICAgICAgICA6ICdNYW5hZ2VDb21wYW55Q29udHJvbGxlcicsXG4gICAgICAgICAgICAgICAgICAgICd0ZW1wbGF0ZVVybCcgICAgICAgICA6ICdhcHAvc2hhcmVkL3RlbXBsYXRlcy9tb2RhbHMvY29tcGFueS1kaWFsb2cuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgICdwYXJlbnQnICAgICAgICAgICAgICA6IGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5ib2R5KSxcbiAgICAgICAgICAgICAgICAgICAgJ2xvY2FscycgICAgICAgICAgICAgIDogeyAnY29tcGFueSc6IGNvbXBhbnkgfSxcbiAgICAgICAgICAgICAgICAgICAgJ2NsaWNrT3V0c2lkZVRvQ2xvc2UnIDogdHJ1ZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS5zZWFyY2ggPSBmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICAgICAgZ2V0Q29tcGFuaWVzKG5hbWUpO1xuICAgICAgICB9O1xuXG4gICAgICAgIChmdW5jdGlvbiBpbml0KCkge1xuXG4gICAgICAgICAgICAkc2NvcGUuY29tcGFueVNlbGVjdGVkID0gW107XG4gICAgICAgICAgICBnZXRDb21wYW5pZXMoKTtcbiAgICAgICAgfSgpKTtcbiAgICB9XG59KCkpO1xuIiwiKGZ1bmN0aW9uKCkge1xuXG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ2Fmcm1BcHAnKS5jb250cm9sbGVyKCdIb21lQ29udHJvbGxlcicsIEhvbWVDb250cm9sbGVyKTtcblxuICAgIEhvbWVDb250cm9sbGVyLiRpbmplY3QgPSBbICckc2NvcGUnIF07XG5cbiAgICBmdW5jdGlvbiBIb21lQ29udHJvbGxlcigkc2NvcGUpIHtcblxuICAgICAgICAkc2NvcGUuYXBwcm92ZVNvbGljaXRhdGlvbiA9ICBmdW5jdGlvbigpIHtcblxuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS5pbnNlcnRTb2xpY2l0YXRpb24gPSBmdW5jdGlvbigpIHtcblxuICAgICAgICB9O1xuICAgIH1cbn0oKSk7XG4iLCIoZnVuY3Rpb24oKSB7XG5cbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnYWZybUFwcCcpLmNvbnRyb2xsZXIoJ0ludGVybnNoaXBzQ29udHJvbGxlcicsIEludGVybnNoaXBzQ29udHJvbGxlcik7XG5cbiAgICBJbnRlcm5zaGlwc0NvbnRyb2xsZXIuJGluamVjdCA9IFsgJyRzY29wZScsICckbWREaWFsb2cnLCAnaW50ZXJuc2hpcHNTZXJ2aWNlJyBdO1xuXG4gICAgZnVuY3Rpb24gSW50ZXJuc2hpcHNDb250cm9sbGVyKCRzY29wZSwgJG1kRGlhbG9nLCBpbnRlcm5zaGlwc1NlcnZpY2UpIHtcblxuICAgICAgICAkc2NvcGUuYXBwcm92ZUludGVybnNoaXBEaWFsb2cgPSBmdW5jdGlvbihpbnRlcm5zaGlwLCBjcmVkZW50aWFsLCBldikge1xuICAgICAgICAgICAgaWYgKGludGVybnNoaXAuc3RhdHVzID09PSAnQWd1YXJkYW5kbyBhcHJvdmHDp8OjbycgJiYgKCRzY29wZS5jcmVkZW50aWFsLnJvbGUgPT09ICdjb29yZGluYXRvcicgfHwgJHNjb3BlLmNyZWRlbnRpYWwucm9sZSA9PT0gJ3N0dWRlbnQnKSlcbiAgICAgICAgICAgICAgICAkbWREaWFsb2cuc2hvdyh7XG4gICAgICAgICAgICAgICAgICAgICdjb250cm9sbGVyJyAgICAgICAgICA6ICdBcHByb3ZlSW50ZXJuc2hpcERpYWxvZ0NvbnRyb2xsZXInLFxuICAgICAgICAgICAgICAgICAgICAndGVtcGxhdGVVcmwnICAgICAgICAgOiAnYXBwL3NoYXJlZC90ZW1wbGF0ZXMvbW9kYWxzL2FwcHJvdmUtaW50ZXJuc2hpcC1kaWFsb2cuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgICdsb2NhbHMnICAgICAgICAgICAgICA6IHsgJ2ludGVybnNoaXAnOiBpbnRlcm5zaGlwIHx8IHt9LCAnY3JlZGVudGlhbCc6IGNyZWRlbnRpYWwgfSxcbiAgICAgICAgICAgICAgICAgICAgJ3BhcmVudCcgICAgICAgICAgICAgIDogYW5ndWxhci5lbGVtZW50KGRvY3VtZW50LmJvZHkpLFxuICAgICAgICAgICAgICAgICAgICAndGFyZ2V0RXZlbnQnICAgICAgICAgOiBldixcbiAgICAgICAgICAgICAgICAgICAgJ2NsaWNrT3V0c2lkZVRvQ2xvc2UnIDogdHJ1ZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS5pbnRlcm5zaGlwRGlhbG9nID0gZnVuY3Rpb24gKGludGVybnNoaXAsIGV2KSB7XG4gICAgICAgICAgICAkbWREaWFsb2cuc2hvdyh7XG4gICAgICAgICAgICAgICAgJ2NvbnRyb2xsZXInICAgICAgICAgIDogJ0ludGVybnNoaXBEaWFsb2dDb250cm9sbGVyJyxcbiAgICAgICAgICAgICAgICAndGVtcGxhdGVVcmwnICAgICAgICAgOiAnYXBwL3NoYXJlZC90ZW1wbGF0ZXMvbW9kYWxzL2ludGVybnNoaXAtZGlhbG9nLmh0bWwnLFxuICAgICAgICAgICAgICAgICdsb2NhbHMnICAgICAgICAgICAgICA6IHsgJ2ludGVybnNoaXAnOiBhbmd1bGFyLmNvcHkoaW50ZXJuc2hpcCkgfHwge30gfSxcbiAgICAgICAgICAgICAgICAncGFyZW50JyAgICAgICAgICAgICAgOiBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQuYm9keSksXG4gICAgICAgICAgICAgICAgJ3RhcmdldEV2ZW50JyAgICAgICAgIDogZXYsXG4gICAgICAgICAgICAgICAgJ2NsaWNrT3V0c2lkZVRvQ2xvc2UnIDogdHJ1ZVxuICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbih1cGRhdGVkSW50ZXJuc2hpcCkge1xuICAgICAgICAgICAgICAgIHZhciBpID0gMDtcblxuICAgICAgICAgICAgICAgIC8vIGF0dWFsaXphIHRhYmVsYSBjb20gYWx0ZXJhY29lcyByZWFsaXphZGFzIG5hIG1vZGFsXG4gICAgICAgICAgICAgICAgZm9yIChpOyBpIDwgJHNjb3BlLmludGVybnNoaXBzLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuaW50ZXJuc2hpcHNbaV0uX2lkID09PSB1cGRhdGVkSW50ZXJuc2hpcC5faWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5pbnRlcm5zaGlwc1tpXSA9IHVwZGF0ZWRJbnRlcm5zaGlwO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS5zZWFyY2ggPSBmdW5jdGlvbihxdWVyeSkge1xuICAgICAgICAgICAgdmFyIHEgPSB7J2NyZWRlbnRpYWxJZCc6ICRzY29wZS5jcmVkZW50aWFsLl9pZH07XG5cbiAgICAgICAgICAgIGlmIChxdWVyeS5uYW1lKVxuICAgICAgICAgICAgICAgIHEubmFtZSA9IHF1ZXJ5Lm5hbWUudHJpbSgpO1xuXG4gICAgICAgICAgICBpZiAocXVlcnkuc3RhdHVzICYmIHF1ZXJ5LnN0YXR1cy50cmltKCkgIT09ICdUb2RvcycpXG4gICAgICAgICAgICAgICAgcS5zdGF0dXMgPSBxdWVyeS5zdGF0dXMudHJpbSgpO1xuXG4gICAgICAgICAgICBpbnRlcm5zaGlwc1NlcnZpY2UuZ2V0KHEpXG4gICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24oaW50ZXJuc2hpcHMpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmludGVybnNoaXBzID0gaW50ZXJuc2hpcHM7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24ocmVhc29uKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlYXNvbik7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tY29uc29sZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIChmdW5jdGlvbiBpbml0KCkge1xuICAgICAgICAgICAgdmFyIHF1ZXJ5ID0ge307XG5cbiAgICAgICAgICAgICRzY29wZS5xdWVyeSA9IHt9O1xuXG4gICAgICAgICAgICAkc2NvcGUuc3RhdHVzID0gWydUb2RvcycsICdFbSBhbmRhbWVudG8nLCAnUmVwcm92YWRvJywgJ0NhbmNlbGFkbycsICdBZ3VhcmRhbmRvIGFwcm92YcOnw6NvJywgJ0ZpbmFsaXphZG8nXTtcblxuICAgICAgICAgICAgJHNjb3BlLmNyZWRlbnRpYWwgPSBKU09OLnBhcnNlKHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnQ1JFREVOVElBTCcpKSB8fCB7fTtcblxuICAgICAgICAgICAgJHNjb3BlLmlzU3R1ZGVudCA9ICRzY29wZS5jcmVkZW50aWFsLnJvbGUgPT09ICdzdHVkZW50JyA/IHRydWUgOiBmYWxzZTtcblxuICAgICAgICAgICAgcXVlcnkgPSB7J2NyZWRlbnRpYWxJZCc6ICRzY29wZS5jcmVkZW50aWFsLl9pZH07XG5cbiAgICAgICAgICAgICRzY29wZS5pc0xvYWRpbmdJbnRlcm5zaGlwcyA9IHRydWU7XG5cbiAgICAgICAgICAgIGludGVybnNoaXBzU2VydmljZS5nZXQocXVlcnkpXG4gICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24oaW50ZXJuc2hpcHMpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmludGVybnNoaXBzID0gaW50ZXJuc2hpcHM7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5pc0xvYWRpbmdJbnRlcm5zaGlwcyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uKHJlYXNvbikge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZWFzb24pOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLWNvbnNvbGVcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmlzTG9hZGluZ0ludGVybnNoaXBzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSgpKTtcbiAgICB9XG59KCkpO1xuIiwiKGZ1bmN0aW9uKCkge1xuXG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ2Fmcm1BcHAnKS5jb250cm9sbGVyKCdMb2dpbkNvbnRyb2xsZXInLCBMb2dpbkNvbnRyb2xsZXIpO1xuXG4gICAgTG9naW5Db250cm9sbGVyLiRpbmplY3QgPSBbICckc2NvcGUnLCAnY3JlZGVudGlhbHNTZXJ2aWNlJywgJyRsb2NhdGlvbicsICckcm9vdFNjb3BlJyBdO1xuXG4gICAgZnVuY3Rpb24gTG9naW5Db250cm9sbGVyKCRzY29wZSwgY3JlZGVudGlhbHNTZXJ2aWNlLCAkbG9jYXRpb24sICRyb290U2NvcGUpIHtcblxuICAgICAgICAkc2NvcGUubG9naW4gPSBmdW5jdGlvbihlbWFpbCwgcGFzcykge1xuICAgICAgICAgICAgdmFyIGNyZWRlbnRpYWwgPSB7XG4gICAgICAgICAgICAgICAgJ2VtYWlsJzogZW1haWwsXG4gICAgICAgICAgICAgICAgJ3Bhc3N3b3JkJzogcGFzc1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgJHNjb3BlLmlzTG9hZGluZyA9IHRydWU7XG5cbiAgICAgICAgICAgIGNyZWRlbnRpYWxzU2VydmljZS5sb2dpbihjcmVkZW50aWFsKVxuICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChjcmVkZW50aWFsKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmlzTG9hZGluZyA9IGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChjcmVkZW50aWFsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0oJ0NSRURFTlRJQUwnLCBKU09OLnN0cmluZ2lmeShjcmVkZW50aWFsKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmNyZWRlbnRpYWwgPSBjcmVkZW50aWFsO1xuICAgICAgICAgICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy9zb2xpY2l0YWNvZXMnKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaXNXcm9uZ0xvZ2luID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbihyZWFzb24pIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmlzTG9hZGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZWFzb24pOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLWNvbnNvbGVcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICAoZnVuY3Rpb24gaW5pdCgpIHtcblxuICAgICAgICB9KCkpO1xuICAgIH1cbn0oKSk7XG4iLCIoZnVuY3Rpb24oKSB7XG5cbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnYWZybUFwcCcpLmNvbnRyb2xsZXIoJ1JlZ2lzdGVyQ29udHJvbGxlcicsIFJlZ2lzdGVyQ29udHJvbGxlcik7XG5cbiAgICBSZWdpc3RlckNvbnRyb2xsZXIuJGluamVjdCA9IFsgJyRzY29wZScsICdjcmVkZW50aWFsc1NlcnZpY2UnLCAnJGxvY2F0aW9uJywgJyRtZFRvYXN0JywgJyR0aW1lb3V0JyBdO1xuXG4gICAgZnVuY3Rpb24gUmVnaXN0ZXJDb250cm9sbGVyKCRzY29wZSwgY3JlZGVudGlhbHNTZXJ2aWNlLCAkbG9jYXRpb24sICRtZFRvYXN0LCAkdGltZW91dCkge1xuXG4gICAgICAgICRzY29wZS5jcmVhdGVBY2NvdW50ID0gZnVuY3Rpb24odXNyKSB7XG4gICAgICAgICAgICBjcmVkZW50aWFsc1NlcnZpY2UuY3JlYXRlKHVzcilcbiAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgJG1kVG9hc3Quc2hvdyhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkbWRUb2FzdC5zaW1wbGUoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGV4dENvbnRlbnQoJ1VzdcOhcmlvIGNyaWFkbyBjb20gc3VjZXNzbycpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5wb3NpdGlvbignYm90dG9tJylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmhpZGVEZWxheSgzMDAwKVxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRsb2NhdGlvbignL2xvZ2luJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCAzMDAwKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24ocmVhc29uKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlYXNvbik7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tY29uc29sZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgfVxufSgpKTtcbiIsIihmdW5jdGlvbigpIHtcblxuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdhZnJtQXBwJykuY29udHJvbGxlcignU29saWNpdGF0aW9uQ29udHJvbGxlcicsIFNvbGljaXRhdGlvbkNvbnRyb2xsZXIpO1xuXG4gICAgU29saWNpdGF0aW9uQ29udHJvbGxlci4kaW5qZWN0ID0gWyAnJHNjb3BlJyBdO1xuXG4gICAgZnVuY3Rpb24gU29saWNpdGF0aW9uQ29udHJvbGxlcigkc2NvcGUpIHtcblxuICAgICAgICAkc2NvcGUuYXBwcm92ZVNvbGljaXRhdGlvbiA9ICBmdW5jdGlvbigpIHtcblxuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS5pbnNlcnRTb2xpY2l0YXRpb24gPSBmdW5jdGlvbigpIHtcblxuICAgICAgICB9O1xuXG4gICAgICAgIChmdW5jdGlvbiBpbml0KCkge1xuICAgICAgICB9KCkpO1xuXG4gICAgfVxufSgpKTtcbiIsIihmdW5jdGlvbigpIHtcblxuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdhZnJtQXBwJykuY29udHJvbGxlcignTG9nc0NvbnRyb2xsZXInLCBMb2dzQ29udHJvbGxlcik7XG5cbiAgICBMb2dzQ29udHJvbGxlci4kaW5qZWN0ID0gWyAnJHNjb3BlJywgJ2xvZ3NTZXJ2aWNlJyBdO1xuXG4gICAgZnVuY3Rpb24gTG9nc0NvbnRyb2xsZXIoJHNjb3BlLCBsb2dzU2VydmljZSkge1xuXG4gICAgICAgIChmdW5jdGlvbiBpbml0KCkge1xuXG4gICAgICAgICAgICAkc2NvcGUudGFibGVQYXJhbXMgPSB7XG4gICAgICAgICAgICAgICAgJ2xpbWl0JzogNSxcbiAgICAgICAgICAgICAgICAncGFnZSc6IDFcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICRzY29wZS5pc0xvYWRpbmdMb2dzID0gdHJ1ZTtcbiAgICAgICAgICBcbiAgICAgICAgICAgIGxvZ3NTZXJ2aWNlLmdldCgpXG4gICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24obG9ncykge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubG9ncyA9IGxvZ3M7XG5cbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmlzTG9hZGluZ0xvZ3MgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnRhYmxlUGFyYW1zLnRvdGFsID0gbG9ncy5sZW5ndGg7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24ocmVhc29uKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5pc0xvYWRpbmdMb2dzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlYXNvbik7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tY29uc29sZVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH0oKSk7XG4gICAgfVxufSgpKTtcbiIsIihmdW5jdGlvbiAoKSB7XG5cbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBmdW5jdGlvbiBDb21wYW5pZXNTZXJ2aWNlKCRodHRwLCAkcm9vdFNjb3BlKSB7XG5cbiAgICAgICAgdmFyIG1vZHVsZSA9ICdjb21wYW5pZXMnO1xuXG4gICAgICAgIHRoaXMuY3JlYXRlID0gZnVuY3Rpb24gKGNvbXBhbnkpIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5wb3N0KCRyb290U2NvcGUuc2VydmVyVXJsICsgbW9kdWxlLCBjb21wYW55KTtcbiAgICAgICAgfTtcblxuICAgICAgICB0aGlzLnVwZGF0ZSA9IGZ1bmN0aW9uIChjb21wYW55KSB7XG4gICAgICAgICAgICBjb21wYW55LmNoYW5nZXIgPSBKU09OLnBhcnNlKHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnQ1JFREVOVElBTCcpKS5faWQ7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucHV0KCRyb290U2NvcGUuc2VydmVyVXJsICsgbW9kdWxlLCBjb21wYW55KTtcbiAgICAgICAgfTtcblxuICAgICAgICB0aGlzLmdldCA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgICAgICB2YXIgdXJsID0gJHJvb3RTY29wZS5zZXJ2ZXJVcmwgKyBtb2R1bGU7XG5cbiAgICAgICAgICAgIGlmIChuYW1lKVxuICAgICAgICAgICAgICAgIHVybCA9IHVybCArICcvJyArIG5hbWU7XG5cbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQodXJsKTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBDb21wYW5pZXNTZXJ2aWNlLiRpbmplY3QgPSBbICckaHR0cCcsICckcm9vdFNjb3BlJyBdO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ2Fmcm1BcHAnKS5zZXJ2aWNlKCdjb21wYW5pZXNTZXJ2aWNlJywgQ29tcGFuaWVzU2VydmljZSk7XG5cbn0oKSk7IiwiKGZ1bmN0aW9uICgpIHtcblxuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGZ1bmN0aW9uIENyZWRlbnRpYWxzU2VydmljZSgkaHR0cCwgJHJvb3RTY29wZSkge1xuXG4gICAgICAgIHZhciBtb2R1bGUgPSAnY3JlZGVudGlhbHMnO1xuXG4gICAgICAgIHRoaXMubG9naW4gPSBmdW5jdGlvbiAoY3JlZGVudGlhbCkge1xuICAgICAgICAgICAgdmFyIHF1ZXJ5c3RyaW5nID0gJz9lbWFpbD0nICsgY3JlZGVudGlhbC5lbWFpbCArICcmcGFzc3dvcmQ9JyArIGNyZWRlbnRpYWwucGFzc3dvcmQ7XG5cbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQoJHJvb3RTY29wZS5zZXJ2ZXJVcmwgKyBtb2R1bGUgKyAnLycgKyBxdWVyeXN0cmluZyk7XG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpcy5jcmVhdGUgPSAgZnVuY3Rpb24odXNyKSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdCgkcm9vdFNjb3BlLnNlcnZlclVybCArIG1vZHVsZSwgdXNyKTtcbiAgICAgICAgfTtcblxuICAgICAgICB0aGlzLmxvZ291dCA9IGZ1bmN0aW9uICh0b2tlbikge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLmdldCgkcm9vdFNjb3BlLnNlcnZlclVybCArIG1vZHVsZSArICcvJyArIHRva2VuKTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBDcmVkZW50aWFsc1NlcnZpY2UuJGluamVjdCA9IFsgJyRodHRwJywgJyRyb290U2NvcGUnIF07XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnYWZybUFwcCcpLnNlcnZpY2UoJ2NyZWRlbnRpYWxzU2VydmljZScsIENyZWRlbnRpYWxzU2VydmljZSk7XG5cbn0oKSk7IiwiKGZ1bmN0aW9uICgpIHtcblxuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGZ1bmN0aW9uIEludGVybnNoaXBzU2VydmljZSgkaHR0cCwgJHJvb3RTY29wZSkge1xuXG4gICAgICAgIHZhciBtb2R1bGUgPSAnaW50ZXJuc2hpcHMnO1xuXG4gICAgICAgIHRoaXMuZ2V0ID0gZnVuY3Rpb24gKHF1ZXJ5KSB7XG4gICAgICAgICAgICB2YXIgdXJsID0gJHJvb3RTY29wZS5zZXJ2ZXJVcmwgKyBtb2R1bGUgKyAnLz8nO1xuXG4gICAgICAgICAgICBpZiAocXVlcnkuY3JlZGVudGlhbElkKVxuICAgICAgICAgICAgICAgIHVybCArPSAnY3JlZGVudGlhbElkPScgKyBxdWVyeS5jcmVkZW50aWFsSWQ7XG5cbiAgICAgICAgICAgIGlmIChxdWVyeS5zdGF0dXMpXG4gICAgICAgICAgICAgICAgdXJsICs9ICcmc3RhdHVzPScgKyBxdWVyeS5zdGF0dXM7XG5cbiAgICAgICAgICAgIGlmIChxdWVyeS5uYW1lKVxuICAgICAgICAgICAgICAgIHVybCArPSAnJm5hbWU9JyArIHF1ZXJ5Lm5hbWU7XG5cbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQodXJsKTtcbiAgICAgICAgfTtcblxuICAgICAgICB0aGlzLnVwZGF0ZSA9IGZ1bmN0aW9uIChpbnRlcm5zaGlwKSB7XG4gICAgICAgICAgICBpbnRlcm5zaGlwLmNoYW5nZXIgPSBKU09OLnBhcnNlKHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnQ1JFREVOVElBTCcpKS5faWQ7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucHV0KCRyb290U2NvcGUuc2VydmVyVXJsICsgbW9kdWxlLCBpbnRlcm5zaGlwKTtcbiAgICAgICAgfTtcblxuICAgIH1cblxuICAgIEludGVybnNoaXBzU2VydmljZS4kaW5qZWN0ID0gWyAnJGh0dHAnLCAnJHJvb3RTY29wZScgXTtcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdhZnJtQXBwJykuc2VydmljZSgnaW50ZXJuc2hpcHNTZXJ2aWNlJywgSW50ZXJuc2hpcHNTZXJ2aWNlKTtcblxufSgpKTsiLCIoZnVuY3Rpb24gKCkge1xuXG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgZnVuY3Rpb24gTG9nc1NlcnZpY2UoJGh0dHAsICRyb290U2NvcGUpIHtcblxuICAgICAgICB2YXIgbW9kdWxlID0gJ2xvZ3MnO1xuXG4gICAgICAgIHRoaXMuZ2V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLmdldCgkcm9vdFNjb3BlLnNlcnZlclVybCArIG1vZHVsZSk7XG4gICAgICAgIH07XG5cbiAgICB9XG5cbiAgICBMb2dzU2VydmljZS4kaW5qZWN0ID0gWyAnJGh0dHAnLCAnJHJvb3RTY29wZScgXTtcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdhZnJtQXBwJykuc2VydmljZSgnbG9nc1NlcnZpY2UnLCBMb2dzU2VydmljZSk7XG5cbn0oKSk7IiwiKGZ1bmN0aW9uICgpIHtcblxuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGZ1bmN0aW9uIEFwcHJvdmVJbnRlcm5zaGlwRGlhbG9nQ29udHJvbGxlcigkc2NvcGUsICRtZERpYWxvZywgaW50ZXJuc2hpcHNTZXJ2aWNlLCBsb2NhbHMpIHtcblxuICAgICAgICBmdW5jdGlvbiB1cGRhdGVJbnRlcm5zaGlwKCkge1xuICAgICAgICAgICAgJHNjb3BlLmlzU2F2aW5nID0gdHJ1ZTtcblxuICAgICAgICAgICAgaW50ZXJuc2hpcHNTZXJ2aWNlLnVwZGF0ZSgkc2NvcGUuaW50ZXJuc2hpcClcbiAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmlzU2F2aW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICRtZERpYWxvZy5oaWRlKCRzY29wZS5pbnRlcm5zaGlwKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbihyZWFzb24pIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVhc29uKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1jb25zb2xlXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5pc1NhdmluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAkbWREaWFsb2cuaGlkZSgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgJHNjb3BlLnNhdmUgPSBmdW5jdGlvbihpc0FwcHJvdmUpIHtcblxuICAgICAgICAgICAgaWYgKGlzQXBwcm92ZSAmJiAkc2NvcGUuY3JlZGVudGlhbC5yb2xlID09PSAnY29vcmRpbmF0b3InKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmludGVybnNoaXAuc3RhdHVzID0gJ0VtIGFuZGFtZW50byc7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmludGVybnNoaXAuYmVnaW4gID0gbW9tZW50KCkuZm9ybWF0KCdERC9NTS9ZWVlZJyk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmludGVybnNoaXAuZW5kICAgID0gbW9tZW50KG1vbWVudCgpKS5hZGQoNiwgJ21vbnRocycpLmZvcm1hdCgnREQvTU0vWVlZWScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoIWlzQXBwcm92ZSAmJiAkc2NvcGUuY3JlZGVudGlhbC5yb2xlID09PSAnY29vcmRpbmF0b3InKVxuICAgICAgICAgICAgICAgICRzY29wZS5pbnRlcm5zaGlwLnN0YXR1cyA9ICdSZXByb3ZhZG8nO1xuXG4gICAgICAgICAgICBlbHNlIGlmICghaXNBcHByb3ZlICYmICRzY29wZS5jcmVkZW50aWFsLnJvbGUgPT09ICdzdHVkZW50JylcbiAgICAgICAgICAgICAgICAkc2NvcGUuaW50ZXJuc2hpcC5zdGF0dXMgPSAnQ2FuY2VsYWRvJztcblxuICAgICAgICAgICAgdXBkYXRlSW50ZXJuc2hpcCgpO1xuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS5jbG9zZURpYWxvZyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgJG1kRGlhbG9nLmNhbmNlbCgpO1xuICAgICAgICB9O1xuXG4gICAgICAgIChmdW5jdGlvbiBpbml0KCkge1xuICAgICAgICAgICAgJHNjb3BlLmludGVybnNoaXAgPSBsb2NhbHMuaW50ZXJuc2hpcCB8fCB7fTtcbiAgICAgICAgICAgICRzY29wZS5jcmVkZW50aWFsID0gbG9jYWxzLmNyZWRlbnRpYWwgfHwge307XG4gICAgICAgIH0pKCk7XG4gICAgfVxuXG4gICAgQXBwcm92ZUludGVybnNoaXBEaWFsb2dDb250cm9sbGVyLiRpbmplY3QgPSBbICckc2NvcGUnLCAnJG1kRGlhbG9nJywgJ2ludGVybnNoaXBzU2VydmljZScsICdsb2NhbHMnIF07XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnYWZybUFwcCcpLmNvbnRyb2xsZXIoJ0FwcHJvdmVJbnRlcm5zaGlwRGlhbG9nQ29udHJvbGxlcicsIEFwcHJvdmVJbnRlcm5zaGlwRGlhbG9nQ29udHJvbGxlcik7XG5cbn0oKSk7IiwiKGZ1bmN0aW9uICgpIHtcblxuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGZ1bmN0aW9uIE1hbmFnZUNvbXBhbnlDb250cm9sbGVyKCRzY29wZSwgJG1kRGlhbG9nLCBjb21wYW5pZXNTZXJ2aWNlLCBsb2NhbHMpIHtcblxuICAgICAgICAkc2NvcGUuc2F2ZSA9IGZ1bmN0aW9uKGNvbXBhbnksIHN0YXR1cykge1xuXG4gICAgICAgICAgICAkc2NvcGUuaXNMb2FkaW5nQ29tcGFueSA9IHRydWU7XG5cbiAgICAgICAgICAgIGlmIChzdGF0dXMgPT09IHRydWUpXG4gICAgICAgICAgICAgICAgY29tcGFueS5zdGF0dXMgPSAnQXByb3ZhZG8nO1xuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIGNvbXBhbnkuc3RhdHVzID0gJ1JlcHJvdmFkbyc7XG5cblxuICAgICAgICAgICAgY29tcGFuaWVzU2VydmljZS51cGRhdGUoY29tcGFueSlcbiAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5pc0xvYWRpbmdDb21wYW55ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICRtZERpYWxvZy5oaWRlKGNvbXBhbnkpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uIChyZWFzb24pIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmlzTG9hZGluZ0NvbXBhbnkgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVhc29uKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1jb25zb2xlXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUuY2xvc2VEaWFsb2cgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICRtZERpYWxvZy5jYW5jZWwoKTtcbiAgICAgICAgfTtcblxuICAgICAgICAoZnVuY3Rpb24gaW5pdCgpIHtcbiAgICAgICAgICAgICRzY29wZS5jb21wYW55ID0gbG9jYWxzLmNvbXBhbnkgfHwge307XG4gICAgICAgIH0pKCk7XG4gICAgfVxuXG4gICAgTWFuYWdlQ29tcGFueUNvbnRyb2xsZXIuJGluamVjdCA9IFsgJyRzY29wZScsICckbWREaWFsb2cnLCAnY29tcGFuaWVzU2VydmljZScsICdsb2NhbHMnIF07XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnYWZybUFwcCcpLmNvbnRyb2xsZXIoJ01hbmFnZUNvbXBhbnlDb250cm9sbGVyJywgTWFuYWdlQ29tcGFueUNvbnRyb2xsZXIpO1xuXG59KCkpOyIsIihmdW5jdGlvbiAoKSB7XG5cbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBmdW5jdGlvbiBJbnRlcm5zaGlwRGlhbG9nQ29udHJvbGxlcigkc2NvcGUsICRtZERpYWxvZywgaW50ZXJuc2hpcHNTZXJ2aWNlLCBsb2NhbHMpIHtcblxuICAgICAgICAkc2NvcGUuY2xvc2VEaWFsb2cgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICRtZERpYWxvZy5jYW5jZWwoKTtcbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUudXBkYXRlID0gZnVuY3Rpb24gKGludGVybnNoaXApIHtcbiAgICAgICAgICAgIGludGVybnNoaXBzU2VydmljZS51cGRhdGUoaW50ZXJuc2hpcClcbiAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbihyZXN1bHQpIHtcblxuICAgICAgICAgICAgICAgICAgICAkbWREaWFsb2cuaGlkZShpbnRlcm5zaGlwKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbihyZWFzb24pIHtcblxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9OyAgXG5cbiAgICAgICAgKGZ1bmN0aW9uIGluaXQoKSB7XG5cbiAgICAgICAgICAgIHZhciByb2xlID0gSlNPTi5wYXJzZSh3aW5kb3cubG9jYWxTdG9yYWdlLmdldEl0ZW0oJ0NSRURFTlRJQUwnKSkucm9sZTsgXG5cbiAgICAgICAgICAgICRzY29wZS5pbnRlcm5zaGlwID0gbG9jYWxzLmludGVybnNoaXAgfHwge307XG5cbiAgICAgICAgICAgICRzY29wZS5pc0VkaXRhYmxlID0gcm9sZSA9PT0gJ3N0dWRlbnQnICYmICRzY29wZS5pbnRlcm5zaGlwICYmICRzY29wZS5pbnRlcm5zaGlwLnN0YXR1cyA9PT0gJ0FndWFyZGFuZG8gYXByb3Zhw6fDo28nO1xuXG4gICAgICAgIH0pKCk7XG4gICAgfVxuXG4gICAgSW50ZXJuc2hpcERpYWxvZ0NvbnRyb2xsZXIuJGluamVjdCA9IFsgJyRzY29wZScsICckbWREaWFsb2cnLCAnaW50ZXJuc2hpcHNTZXJ2aWNlJywgJ2xvY2FscycgXTtcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdhZnJtQXBwJykuY29udHJvbGxlcignSW50ZXJuc2hpcERpYWxvZ0NvbnRyb2xsZXInLCBJbnRlcm5zaGlwRGlhbG9nQ29udHJvbGxlcik7XG5cbn0oKSk7Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
